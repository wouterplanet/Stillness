(function(){const T=document.createElement("link").relList;if(T&&T.supports&&T.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))A(C);new MutationObserver(C=>{for(const I of C)if(I.type==="childList")for(const O of I.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&A(O)}).observe(document,{childList:!0,subtree:!0});function M(C){const I={};return C.integrity&&(I.integrity=C.integrity),C.referrerPolicy&&(I.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?I.credentials="include":C.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function A(C){if(C.ep)return;C.ep=!0;const I=M(C);fetch(C.href,I)}})();function Di(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}function Br(b){if(Object.prototype.hasOwnProperty.call(b,"__esModule"))return b;var T=b.default;if(typeof T=="function"){var M=function A(){var C=!1;try{C=this instanceof A}catch{}return C?Reflect.construct(T,arguments,this.constructor):T.apply(this,arguments)};M.prototype=T.prototype}else M={};return Object.defineProperty(M,"__esModule",{value:!0}),Object.keys(b).forEach(function(A){var C=Object.getOwnPropertyDescriptor(b,A);Object.defineProperty(M,A,C.get?C:{enumerable:!0,get:function(){return b[A]}})}),M}function Nr(b){throw new Error('Could not dynamically require "'+b+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var En={exports:{}};const Fr={},Dr=Object.freeze(Object.defineProperty({__proto__:null,default:Fr},Symbol.toStringTag,{value:"Module"})),ki=Br(Dr);var qr=En.exports,Ai;function Vr(){return Ai||(Ai=1,(function(b){(function(T,M){T=T||ki;var A=T.window,C=T.document,I=new function(){var e=/^(statics|enumerable|beans|preserve)$/,t=[],n=t.slice,i=Object.create,r=Object.getOwnPropertyDescriptor,s=Object.defineProperty,o=t.forEach||function(f,c){for(var S=0,v=this.length;S<v;S++)f.call(c,this[S],S,this)},a=function(f,c){for(var S in this)this.hasOwnProperty(S)&&f.call(c,this[S],S,this)},u=Object.assign||function(f){for(var c=1,S=arguments.length;c<S;c++){var v=arguments[c];for(var P in v)v.hasOwnProperty(P)&&(f[P]=v[P])}return f},l=function(f,c,S){if(f){var v=r(f,"length");(v&&typeof v.value=="number"?o:a).call(f,c,S=S||f)}return S};function d(f,c,S,v,P){var g={};function w(y,z){z=z||(z=r(c,y))&&(z.get?z:z.value),typeof z=="string"&&z[0]==="#"&&(z=f[z.substring(1)]||z);var F=typeof z=="function",q=z,X=P||F&&!z.base?z&&z.get?y in f:f[y]:null,N;(!P||!X)&&(F&&X&&(z.base=X),F&&v!==!1&&(N=y.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(g[N[3].toLowerCase()+N[4]]=N[2]),(!q||F||!q.get||typeof q.get!="function"||!_.isPlainObject(q))&&(q={value:q,writable:!0}),(r(f,y)||{configurable:!0}).configurable&&(q.configurable=!0,q.enumerable=S??!N),s(f,y,q))}if(c){for(var h in c)c.hasOwnProperty(h)&&!e.test(h)&&w(h);for(var h in g){var p=g[h],x=f["set"+p],E=f["get"+p]||x&&f["is"+p];E&&(v===!0||E.length===0)&&w(h,{get:E,set:x})}}return f}function _(){for(var f=0,c=arguments.length;f<c;f++){var S=arguments[f];S&&u(this,S)}return this}return d(_,{inject:function(f){if(f){var c=f.statics===!0?f:f.statics,S=f.beans,v=f.preserve;c!==f&&d(this.prototype,f,f.enumerable,S,v),d(this,c,null,S,v)}for(var P=1,g=arguments.length;P<g;P++)this.inject(arguments[P]);return this},extend:function(){for(var f=this,c,S,v=0,P,g=arguments.length;v<g&&!(c&&S);v++)P=arguments[v],c=c||P.initialize,S=S||P.prototype;return c=c||function(){f.apply(this,arguments)},S=c.prototype=S||i(this.prototype),s(S,"constructor",{value:c,writable:!0,configurable:!0}),d(c,this),arguments.length&&this.inject.apply(c,arguments),c.base=f,c}}).inject({enumerable:!1,initialize:_,set:_,inject:function(){for(var f=0,c=arguments.length;f<c;f++){var S=arguments[f];S&&d(this,S,S.enumerable,S.beans,S.preserve)}return this},extend:function(){var f=i(this);return f.inject.apply(f,arguments)},each:function(f,c){return l(this,f,c)},clone:function(){return new this.constructor(this)},statics:{set:u,each:l,create:i,define:s,describe:r,clone:function(f){return u(new f.constructor,f)},isPlainObject:function(f){var c=f!=null&&f.constructor;return c&&(c===Object||c===_||c.name==="Object")},pick:function(f,c){return f!==M?f:c},slice:function(f,c,S){return n.call(f,c,S)}}})};b.exports=I,I.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+I.each(this,function(e,t){if(!/^_/.test(t)){var n=typeof e;this.push(t+": "+(n==="number"?G.instance.number(e):n==="string"?"'"+e+"'":e))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(e){return I.importJSON(e,this)},exportJSON:function(e){return I.exportJSON(this,e)},toJSON:function(){return I.serialize(this)},set:function(e,t){return e&&I.filter(this,e,t,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function e(){var t=e.base.apply(this,arguments),n=t.prototype._class;return n&&!I.exports[n]&&(I.exports[n]=t),t},equals:function(e,t){if(e===t)return!0;if(e&&e.equals)return e.equals(t);if(t&&t.equals)return t.equals(e);if(e&&t&&typeof e=="object"&&typeof t=="object"){if(Array.isArray(e)&&Array.isArray(t)){var n=e.length;if(n!==t.length)return!1;for(;n--;)if(!I.equals(e[n],t[n]))return!1}else{var i=Object.keys(e),n=i.length;if(n!==Object.keys(t).length)return!1;for(;n--;){var r=i[n];if(!(t.hasOwnProperty(r)&&I.equals(e[r],t[r])))return!1}}return!0}return!1},read:function(e,t,n,i){if(this===I){var r=this.peek(e,t);return e.__index++,r}var s=this.prototype,o=s._readIndex,a=t||o&&e.__index||0,u=e.length,l=e[a];if(i=i||u-a,l instanceof this||n&&n.readNull&&l==null&&i<=1)return o&&(e.__index=a+1),l&&n&&n.clone?l.clone():l;if(l=I.create(s),o&&(l.__read=!0),l=l.initialize.apply(l,a>0||a+i<u?I.slice(e,a,a+i):e)||l,o){e.__index=a+l.__read;var d=l.__filtered;d&&(e.__filtered=d,l.__filtered=M),l.__read=M}return l},peek:function(e,t){return e[e.__index=t||e.__index||0]},remain:function(e){return e.length-(e.__index||0)},readList:function(e,t,n,i){for(var r=[],s,o=t||0,a=i?o+i:e.length,u=o;u<a;u++)r.push(Array.isArray(s=e[u])?this.read(s,0,n):this.read(e,u,n,1));return r},readNamed:function(e,t,n,i,r){var s=this.getNamed(e,t),o=s!==M;if(o){var a=e.__filtered;if(!a){var u=this.getSource(e);a=e.__filtered=I.create(u),a.__unfiltered=u}a[t]=M}return this.read(o?[s]:e,n,i,r)},readSupported:function(e,t){var n=this.getSource(e),i=this,r=!1;return n&&Object.keys(n).forEach(function(s){if(s in t){var o=i.readNamed(e,s);o!==M&&(t[s]=o),r=!0}}),r},getSource:function(e){var t=e.__source;if(t===M){var n=e.length===1&&e[0];t=e.__source=n&&I.isPlainObject(n)?n:null}return t},getNamed:function(e,t){var n=this.getSource(e);if(n)return t?n[t]:e.__filtered||n},hasNamed:function(e,t){return!!this.getNamed(e,t)},filter:function(e,t,n,i){var r;function s(d){if(!(n&&d in n)&&!(r&&d in r)){var _=t[d];_!==M&&(e[d]=_)}}if(i){for(var o={},a=0,u,l=i.length;a<l;a++)(u=i[a])in t&&(s(u),o[u]=!0);r=o}return Object.keys(t.__unfiltered||t).forEach(s),e},isPlainValue:function(e,t){return I.isPlainObject(e)||Array.isArray(e)||t&&typeof e=="string"},serialize:function(e,t,n,i){t=t||{};var r=!i,s;if(r&&(t.formatter=new G(t.precision),i={length:0,definitions:{},references:{},add:function(_,f){var c="#"+_._id,S=this.references[c];if(!S){this.length++;var v=f.call(_),P=_._class;P&&v[0]!==P&&v.unshift(P),this.definitions[c]=v,S=this.references[c]=[c]}return S}}),e&&e._serialize){s=e._serialize(t,i);var o=e._class;o&&!e._compactSerialize&&(r||!n)&&s[0]!==o&&s.unshift(o)}else if(Array.isArray(e)){s=[];for(var a=0,u=e.length;a<u;a++)s[a]=I.serialize(e[a],t,n,i)}else if(I.isPlainObject(e)){s={};for(var l=Object.keys(e),a=0,u=l.length;a<u;a++){var d=l[a];s[d]=I.serialize(e[d],t,n,i)}}else typeof e=="number"?s=t.formatter.number(e,t.precision):s=e;return r&&i.length>0?[["dictionary",i.definitions],s]:s},deserialize:function(e,t,n,i,r){var s=e,o=!n,a=o&&e&&e.length&&e[0][0]==="dictionary";if(n=n||{},Array.isArray(e)){var u=e[0],l=u==="dictionary";if(e.length==1&&/^#/.test(u))return n.dictionary[u];u=I.exports[u],s=[];for(var d=u?1:0,_=e.length;d<_;d++)s.push(I.deserialize(e[d],t,n,l,a));if(u){var f=s;t?s=t(u,f,o||r):s=new u(f)}}else if(I.isPlainObject(e)){s={},i&&(n.dictionary=s);for(var c in e)s[c]=I.deserialize(e[c],t,n)}return a?s[1]:s},exportJSON:function(e,t){var n=I.serialize(e,t);return t&&t.asString==!1?n:JSON.stringify(n)},importJSON:function(e,t){return I.deserialize(typeof e=="string"?JSON.parse(e):e,function(n,i,r){var s=r&&t&&t.constructor===n,o=s?t:I.create(n.prototype);if(i.length===1&&o instanceof R&&(s||!(o instanceof $))){var a=i[0];I.isPlainObject(a)&&(a.insert=!1,s&&(i=i.concat([R.INSERT])))}return(s?o.set:n).apply(o,i),s&&(t=null),o})},push:function(e,t){var n=t.length;if(n<4096)e.push.apply(e,t);else{var i=e.length;e.length+=n;for(var r=0;r<n;r++)e[i+r]=t[r]}return e},splice:function(e,t,n,i){var r=t&&t.length,s=n===M;n=s?e.length:n,n>e.length&&(n=e.length);for(var o=0;o<r;o++)t[o]._index=n+o;if(s)return I.push(e,t),[];var a=[n,i];t&&I.push(a,t);for(var u=e.splice.apply(e,a),o=0,l=u.length;o<l;o++)u[o]._index=M;for(var o=n+r,l=e.length;o<l;o++)e[o]._index=o;return u},capitalize:function(e){return e.replace(/\b[a-z]/g,function(t){return t.toUpperCase()})},camelize:function(e){return e.replace(/-(.)/g,function(t,n){return n.toUpperCase()})},hyphenate:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var O={on:function(e,t){if(typeof e!="string")I.each(e,function(s,o){this.on(o,s)},this);else{var n=this._eventTypes,i=n&&n[e],r=this._callbacks=this._callbacks||{};r=r[e]=r[e]||[],r.indexOf(t)===-1&&(r.push(t),i&&i.install&&r.length===1&&i.install.call(this,e))}return this},off:function(e,t){if(typeof e!="string"){I.each(e,function(o,a){this.off(a,o)},this);return}var n=this._eventTypes,i=n&&n[e],r=this._callbacks&&this._callbacks[e],s;return r&&(!t||(s=r.indexOf(t))!==-1&&r.length===1?(i&&i.uninstall&&i.uninstall.call(this,e),delete this._callbacks[e]):s!==-1&&r.splice(s,1)),this},once:function(e,t){return this.on(e,function n(){t.apply(this,arguments),this.off(e,n)})},emit:function(e,t){var n=this._callbacks&&this._callbacks[e];if(!n)return!1;var i=I.slice(arguments,1),r=t&&t.target&&!t.currentTarget;n=n.slice(),r&&(t.currentTarget=this);for(var s=0,o=n.length;s<o;s++)if(n[s].apply(this,i)==!1){t&&t.stop&&t.stop();break}return r&&delete t.currentTarget,!0},responds:function(e){return!!(this._callbacks&&this._callbacks[e])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(e){var t=this._eventTypes,n=this._callbacks,i=e?"install":"uninstall";if(t){for(var r in n)if(n[r].length>0){var s=t[r],o=s&&s[i];o&&o.call(this,r)}}},statics:{inject:function e(t){var n=t._events;if(n){var i={};I.each(n,function(r,s){var o=typeof r=="string",a=o?r:s,u=I.capitalize(a),l=a.substring(2).toLowerCase();i[l]=o?{}:r,a="_"+a,t["get"+u]=function(){return this[a]},t["set"+u]=function(d){var _=this[a];_&&this.off(l,_),d&&this.on(l,d),this[a]=d}}),t._eventTypes=i}return e.base.apply(this,arguments)}}},D=I.extend({_class:"PaperScope",initialize:function e(){De=this,this.settings=new I({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=e._id++,e._scopes[this._id]=this;var t=e.prototype;if(!this.support){var n=it.getContext(1,1)||{};t.support={nativeDash:"setLineDash"in n||"mozDash"in n,nativeBlendModes:zn.nativeModes},it.release(n)}if(!this.agent){var i=T.navigator.userAgent.toLowerCase(),r=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(i)||[])[0],s=r==="darwin"?"mac":r,o=t.agent=t.browser={platform:s};s&&(o[s]=!0),i.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(a,u,l,d,_){if(!o.chrome){var f=u==="opera"?d:/^(node|trident)$/.test(u)?_:l;o.version=f,o.versionNumber=parseFloat(f),u={trident:"msie",jsdom:"node"}[u]||u,o.name=u,o[u]=!0}}),o.chrome&&delete o.webkit,o.atom&&delete o.chrome}},version:"0.12.18",getView:function(){var e=this.project;return e&&e._view},getPaper:function(){return this},execute:function(e,t){var n=De.PaperScript.execute(e,this,t);return Xe.updateFocus(),n},install:function(e){var t=this;I.each(["project","view","tool"],function(i){I.define(e,i,{configurable:!0,get:function(){return t[i]}})});for(var n in this)!/^_/.test(n)&&this[n]&&(e[n]=this[n])},setup:function(e){return De=this,this.project=new W(e),this},createCanvas:function(e,t){return it.getCanvas(e,t)},activate:function(){De=this},clear:function(){for(var e=this.projects,t=this.tools,n=e.length-1;n>=0;n--)e[n].remove();for(var n=t.length-1;n>=0;n--)t[n].remove()},remove:function(){this.clear(),delete D._scopes[this._id]},statics:new function(){function e(t){return t+="Attribute",function(n,i){return n[t](i)||n[t]("data-paper-"+i)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:e("get"),hasAttribute:e("has")}}}),U=I.extend(O,{initialize:function(e){this._scope=De,this._index=this._scope[this._list].push(this)-1,(e||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var e=this._scope[this._reference];return e&&e!==this&&e.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",e),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(I.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),L={findItemBoundsCollisions:function(e,t,n){function i(o){for(var a=new Array(o.length),u=0;u<o.length;u++){var l=o[u].getBounds();a[u]=[l.left,l.top,l.right,l.bottom]}return a}var r=i(e),s=!t||t===e?r:i(t);return this.findBoundsCollisions(r,s,n||0)},findCurveBoundsCollisions:function(e,t,n,i){function r(f){for(var c=Math.min,S=Math.max,v=new Array(f.length),P=0;P<f.length;P++){var g=f[P];v[P]=[c(g[0],g[2],g[4],g[6]),c(g[1],g[3],g[5],g[7]),S(g[0],g[2],g[4],g[6]),S(g[1],g[3],g[5],g[7])]}return v}var s=r(e),o=!t||t===e?s:r(t);if(i){for(var a=this.findBoundsCollisions(s,o,n||0,!1,!0),u=this.findBoundsCollisions(s,o,n||0,!0,!0),l=[],d=0,_=a.length;d<_;d++)l[d]={hor:a[d],ver:u[d]};return l}return this.findBoundsCollisions(s,o,n||0)},findBoundsCollisions:function(e,t,n,i,r){var s=!t||e===t,o=s?e:e.concat(t),a=e.length,u=o.length;function l(me,ye,Se){for(var ce=0,de=me.length;ce<de;){var be=de+ce>>>1;o[me[be]][ye]<Se?ce=be+1:de=be}return ce-1}for(var d=i?1:0,_=d+2,f=i?0:1,c=f+2,S=new Array(u),v=0;v<u;v++)S[v]=v;S.sort(function(me,ye){return o[me][d]-o[ye][d]});for(var P=[],g=new Array(a),v=0;v<u;v++){var w=S[v],h=o[w],p=s?w:w-a,x=w<a,E=s||!x,y=x?[]:null;if(P.length){var z=l(P,_,h[d]-n)+1;if(P.splice(0,z),s&&r){y=y.concat(P);for(var F=0;F<P.length;F++){var q=P[F];g[q].push(p)}}else for(var X=h[c],N=h[f],F=0;F<P.length;F++){var q=P[F],Z=o[q],J=q<a,ee=s||q>=a;(r||(x&&ee||E&&J)&&X>=Z[f]-n&&N<=Z[c]+n)&&(x&&ee&&y.push(s?q:q-a),E&&J&&g[q].push(p))}}if(x&&(e===t&&y.push(w),g[w]=y),P.length){var te=h[_],oe=l(P,_,te);P.splice(oe+1,0,w)}else P.push(w)}for(var v=0;v<g.length;v++){var _e=g[v];_e&&_e.sort(function(ye,Se){return ye-Se})}return g}},G=I.extend({initialize:function(e){this.precision=I.pick(e,5),this.multiplier=Math.pow(10,this.precision)},number:function(e){return this.precision<16?Math.round(e*this.multiplier)/this.multiplier:e},pair:function(e,t,n){return this.number(e)+(n||",")+this.number(t)},point:function(e,t){return this.number(e.x)+(t||",")+this.number(e.y)},size:function(e,t){return this.number(e.width)+(t||",")+this.number(e.height)},rectangle:function(e,t){return this.point(e,t)+(t||",")+this.size(e,t)}});G.instance=new G;var j=new function(){var e=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],t=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,i=Math.sqrt,r=Math.pow,s=Math.log2||function(_){return Math.log(_)*Math.LOG2E},o=1e-12,a=112e-18;function u(_,f,c){return _<f?f:_>c?c:_}function l(_,f,c){function S(z){var F=z*134217729,q=z-F,X=q+F,N=z-X;return[X,N]}var v=f*f-_*c,P=f*f+_*c;if(n(v)*3<P){var g=S(_),w=S(f),h=S(c),p=f*f,x=w[0]*w[0]-p+2*w[0]*w[1]+w[1]*w[1],E=_*c,y=g[0]*h[0]-E+g[0]*h[1]+g[1]*h[0]+g[1]*h[1];v=p-E+(x-y)}return v}function d(){var _=Math.max.apply(Math,arguments);return _&&(_<1e-8||_>1e8)?r(2,-Math.round(s(_))):0}return{EPSILON:o,MACHINE_EPSILON:a,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(i(2)-1)/3,isZero:function(_){return _>=-o&&_<=o},isMachineZero:function(_){return _>=-a&&_<=a},clamp:u,integrate:function(_,f,c,S){for(var v=e[S-2],P=t[S-2],g=(c-f)*.5,w=g+f,h=0,p=S+1>>1,x=S&1?P[h++]*_(w):0;h<p;){var E=g*v[h];x+=P[h++]*(_(w+E)+_(w-E))}return g*x},findRoot:function(_,f,c,S,v,P,g){for(var w=0;w<P;w++){var h=_(c),p=h/f(c),x=c-p;if(n(p)<g){c=x;break}h>0?(v=c,c=x<=S?(S+v)*.5:x):(S=c,c=x>=v?(S+v)*.5:x)}return u(c,S,v)},solveQuadratic:function(_,f,c,S,v,P){var g,w=1/0;if(n(_)<o){if(n(f)<o)return n(c)<o?-1:0;g=-c/f}else{f*=-.5;var h=l(_,f,c);if(h&&n(h)<a){var p=d(n(_),n(f),n(c));p&&(_*=p,f*=p,c*=p,h=l(_,f,c))}if(h>=-a){var x=h<0?0:i(h),E=f+(f<0?-x:x);E===0?(g=c/_,w=-g):(g=E/_,w=c/E)}}var y=0,z=v==null,F=v-o,q=P+o;return isFinite(g)&&(z||g>F&&g<q)&&(S[y++]=z?g:u(g,v,P)),w!==g&&isFinite(w)&&(z||w>F&&w<q)&&(S[y++]=z?w:u(w,v,P)),y},solveCubic:function(_,f,c,S,v,P,g){var w=d(n(_),n(f),n(c),n(S)),h,p,x,E,y;w&&(_*=w,f*=w,c*=w,S*=w);function z(oe){h=oe;var _e=_*h;p=_e+f,x=p*h+c,E=(_e+p)*h+x,y=x*h+S}if(n(_)<o)_=f,p=c,x=S,h=1/0;else if(n(S)<o)p=f,x=c,h=0;else{z(-(f/_)/3);var F=y/_,q=r(n(F),1/3),X=F<0?-1:1,N=-E/_,Z=N>0?1.324717957244746*Math.max(q,i(N)):q,J=h-X*Z;if(J!==h){do z(J),J=E===0?h:h-y/E/(1+a);while(X*J>X*h);n(_)*h*h>n(S/h)&&(x=-S/h,p=(x-c)/h)}}var ee=j.solveQuadratic(_,p,x,v,P,g),te=P==null;return isFinite(h)&&(ee===0||ee>0&&h!==v[0]&&h!==v[1])&&(te||h>P-o&&h<g+o)&&(v[ee++]=te?h:u(h,P,g)),ee}}},ie={_id:1,_pools:{},get:function(e){if(e){var t=this._pools[e];return t||(t=this._pools[e]={_id:1}),t._id++}else return this._id++}},k=I.extend({_class:"Point",_readIndex:!0,initialize:function(t,n){var i=typeof t,r=this.__read,s=0;if(i==="number"){var o=typeof n=="number";this._set(t,o?n:t),r&&(s=o?2:1)}else if(i==="undefined"||t===null)this._set(0,0),r&&(s=t===null?1:0);else{var a=i==="string"?t.split(/[\s,]+/)||[]:t;s=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"x"in a?this._set(a.x||0,a.y||0):"width"in a?this._set(a.width||0,a.height||0):"angle"in a?(this._set(a.length||0,0),this.setAngle(a.angle||0)):(this._set(0,0),s=0)}return r&&(this.__read=s),this},set:"#initialize",_set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return this===e||e&&(this.x===e.x&&this.y===e.y||Array.isArray(e)&&this.x===e[0]&&this.y===e[1])||!1},clone:function(){return new k(this.x,this.y)},toString:function(){var e=G.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+" }"},_serialize:function(e){var t=e.formatter;return[t.number(this.x),t.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(e){if(this.isZero()){var t=this._angle||0;this._set(Math.cos(t)*e,Math.sin(t)*e)}else{var n=e/this.getLength();j.isZero(n)&&this.getAngle(),this._set(this.x*n,this.y*n)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(e){this.setAngleInRadians.call(this,e*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var e=k.read(arguments),t=this.getLength()*e.getLength();if(j.isZero(t))return NaN;var n=this.dot(e)/t;return Math.acos(n<-1?-1:n>1?1:n)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(e){if(this._angle=e,!this.isZero()){var t=this.getLength();this._set(Math.cos(e)*t,Math.sin(e)*t)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var e=k.read(arguments);return Math.atan2(this.cross(e),this.dot(e))*180/Math.PI},getDistance:function(){var e=arguments,t=k.read(e),n=t.x-this.x,i=t.y-this.y,r=n*n+i*i,s=I.read(e);return s?r:Math.sqrt(r)},normalize:function(e){e===M&&(e=1);var t=this.getLength(),n=t!==0?e/t:0,i=new k(this.x*n,this.y*n);return n>=0&&(i._angle=this._angle),i},rotate:function(e,t){if(e===0)return this.clone();e=e*Math.PI/180;var n=t?this.subtract(t):this,i=Math.sin(e),r=Math.cos(e);return n=new k(n.x*r-n.y*i,n.x*i+n.y*r),t?n.add(t):n},transform:function(e){return e?e._transformPoint(this):this},add:function(){var e=k.read(arguments);return new k(this.x+e.x,this.y+e.y)},subtract:function(){var e=k.read(arguments);return new k(this.x-e.x,this.y-e.y)},multiply:function(){var e=k.read(arguments);return new k(this.x*e.x,this.y*e.y)},divide:function(){var e=k.read(arguments);return new k(this.x/e.x,this.y/e.y)},modulo:function(){var e=k.read(arguments);return new k(this.x%e.x,this.y%e.y)},negate:function(){return new k(-this.x,-this.y)},isInside:function(){return V.read(arguments).contains(this)},isClose:function(){var e=arguments,t=k.read(e),n=I.read(e);return this.getDistance(t)<=n},isCollinear:function(){var e=k.read(arguments);return k.isCollinear(this.x,this.y,e.x,e.y)},isColinear:"#isCollinear",isOrthogonal:function(){var e=k.read(arguments);return k.isOrthogonal(this.x,this.y,e.x,e.y)},isZero:function(){var e=j.isZero;return e(this.x)&&e(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(e){return this.x*(e>1&&e<4?-1:1)>=0&&this.y*(e>2?-1:1)>=0},dot:function(){var e=k.read(arguments);return this.x*e.x+this.y*e.y},cross:function(){var e=k.read(arguments);return this.x*e.y-this.y*e.x},project:function(){var e=k.read(arguments),t=e.isZero()?0:this.dot(e)/e.dot(e);return new k(e.x*t,e.y*t)},statics:{min:function(){var e=arguments,t=k.read(e),n=k.read(e);return new k(Math.min(t.x,n.x),Math.min(t.y,n.y))},max:function(){var e=arguments,t=k.read(e),n=k.read(e);return new k(Math.max(t.x,n.x),Math.max(t.y,n.y))},random:function(){return new k(Math.random(),Math.random())},isCollinear:function(e,t,n,i){return Math.abs(e*i-t*n)<=Math.sqrt((e*e+t*t)*(n*n+i*i))*1e-8},isOrthogonal:function(e,t,n,i){return Math.abs(e*n+t*i)<=Math.sqrt((e*e+t*t)*(n*n+i*i))*1e-8}}},I.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return new k(t(this.x),t(this.y))}},{})),ue=k.extend({initialize:function(t,n,i,r){this._x=t,this._y=n,this._owner=i,this._setter=r},_set:function(e,t,n){return this._x=e,this._y=t,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(e){this._owner._changeSelection(this._getSelection(),e)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),se=I.extend({_class:"Size",_readIndex:!0,initialize:function(t,n){var i=typeof t,r=this.__read,s=0;if(i==="number"){var o=typeof n=="number";this._set(t,o?n:t),r&&(s=o?2:1)}else if(i==="undefined"||t===null)this._set(0,0),r&&(s=t===null?1:0);else{var a=i==="string"?t.split(/[\s,]+/)||[]:t;s=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"width"in a?this._set(a.width||0,a.height||0):"x"in a?this._set(a.x||0,a.y||0):(this._set(0,0),s=0)}return r&&(this.__read=s),this},set:"#initialize",_set:function(e,t){return this.width=e,this.height=t,this},equals:function(e){return e===this||e&&(this.width===e.width&&this.height===e.height||Array.isArray(e)&&this.width===e[0]&&this.height===e[1])||!1},clone:function(){return new se(this.width,this.height)},toString:function(){var e=G.instance;return"{ width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){var t=e.formatter;return[t.number(this.width),t.number(this.height)]},add:function(){var e=se.read(arguments);return new se(this.width+e.width,this.height+e.height)},subtract:function(){var e=se.read(arguments);return new se(this.width-e.width,this.height-e.height)},multiply:function(){var e=se.read(arguments);return new se(this.width*e.width,this.height*e.height)},divide:function(){var e=se.read(arguments);return new se(this.width/e.width,this.height/e.height)},modulo:function(){var e=se.read(arguments);return new se(this.width%e.width,this.height%e.height)},negate:function(){return new se(-this.width,-this.height)},isZero:function(){var e=j.isZero;return e(this.width)&&e(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(e,t){return new se(Math.min(e.width,t.width),Math.min(e.height,t.height))},max:function(e,t){return new se(Math.max(e.width,t.width),Math.max(e.height,t.height))},random:function(){return new se(Math.random(),Math.random())}}},I.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return new se(t(this.width),t(this.height))}},{})),ae=se.extend({initialize:function(t,n,i,r){this._width=t,this._height=n,this._owner=i,this._setter=r},_set:function(e,t,n){return this._width=e,this._height=t,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(e){this._width=e,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(e){this._height=e,this._owner[this._setter](this)}}),V=I.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,n,i,r){var s=arguments,o=typeof t,a;if(o==="number"?(this._set(t,n,i,r),a=4):o==="undefined"||t===null?(this._set(0,0,0,0),a=t===null?1:0):s.length===1&&(Array.isArray(t)?(this._set.apply(this,t),a=1):t.x!==M||t.width!==M?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),a=1):t.from===M&&t.to===M&&(this._set(0,0,0,0),I.readSupported(s,this)&&(a=1))),a===M){var u=k.readNamed(s,"from"),l=I.peek(s),d=u.x,_=u.y,f,c;if(l&&l.x!==M||I.hasNamed(s,"to")){var S=k.readNamed(s,"to");f=S.x-d,c=S.y-_,f<0&&(d=S.x,f=-f),c<0&&(_=S.y,c=-c)}else{var v=se.read(s);f=v.width,c=v.height}this._set(d,_,f,c),a=s.__index}var P=s.__filtered;return P&&(this.__filtered=P),this.__read&&(this.__read=a),this},set:"#initialize",_set:function(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this},clone:function(){return new V(this.x,this.y,this.width,this.height)},equals:function(e){var t=I.isPlainValue(e)?V.read(arguments):e;return t===this||t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height||!1},toString:function(){var e=G.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+", width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){var t=e.formatter;return[t.number(this.x),t.number(this.y),t.number(this.width),t.number(this.height)]},getPoint:function(e){var t=e?k:ue;return new t(this.x,this.y,this,"setPoint")},setPoint:function(){var e=k.read(arguments);this.x=e.x,this.y=e.y},getSize:function(e){var t=e?se:ae;return new t(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var e=se.read(arguments),t=this._sx,n=this._sy,i=e.width,r=e.height;t&&(this.x+=(this.width-i)*t),n&&(this.y+=(this.height-r)*n),this.width=i,this.height=r,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(e){if(!this._fw){var t=e-this.x;this.width-=this._sx===.5?t*2:t}this.x=e,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(e){if(!this._fh){var t=e-this.y;this.height-=this._sy===.5?t*2:t}this.y=e,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(e){if(!this._fw){var t=e-this.x;this.width=this._sx===.5?t*2:t}this.x=e-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(e){if(!this._fh){var t=e-this.y;this.height=this._sy===.5?t*2:t}this.y=e-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(e){this._fw||this._sx===.5?this.x=e-this.width/2:(this._sx&&(this.x+=(e-this.x)*2*this._sx),this.width=(e-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(e){this._fh||this._sy===.5?this.y=e-this.height/2:(this._sy&&(this.y+=(e-this.y)*2*this._sy),this.height=(e-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(e){var t=e?k:ue;return new t(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var e=k.read(arguments);return this.setCenterX(e.x),this.setCenterY(e.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(e){return e&&e.width!==M||(Array.isArray(e)?e:arguments).length===4?this._containsRectangle(V.read(arguments)):this._containsPoint(k.read(arguments))},_containsPoint:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t+e.width<=this.x+this.width&&n+e.height<=this.y+this.height},intersects:function(){var e=V.read(arguments),t=I.read(arguments)||0;return e.x+e.width>this.x-t&&e.y+e.height>this.y-t&&e.x<this.x+this.width+t&&e.y<this.y+this.height+t},intersect:function(){var e=V.read(arguments),t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),i=Math.min(this.x+this.width,e.x+e.width),r=Math.min(this.y+this.height,e.y+e.height);return new V(t,n,i-t,r-n)},unite:function(){var e=V.read(arguments),t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x+this.width,e.x+e.width),r=Math.max(this.y+this.height,e.y+e.height);return new V(t,n,i-t,r-n)},include:function(){var e=k.read(arguments),t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x+this.width,e.x),r=Math.max(this.y+this.height,e.y);return new V(t,n,i-t,r-n)},expand:function(){var e=se.read(arguments),t=e.width,n=e.height;return new V(this.x-t/2,this.y-n/2,this.width+t,this.height+n)},scale:function(e,t){return this.expand(this.width*e-this.width,this.height*(t===M?e:t)-this.height)}},I.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(e,t){var n=e.join(""),i=/^[RL]/.test(n);t>=4&&(e[1]+=i?"Y":"X");var r=e[i?0:1],s=e[i?1:0],o="get"+r,a="get"+s,u="set"+r,l="set"+s,d="get"+n,_="set"+n;this[d]=function(f){var c=f?k:ue;return new c(this[o](),this[a](),this,_)},this[_]=function(){var f=k.read(arguments);this[u](f.x),this[l](f.y)}},{beans:!0})),Y=V.extend({initialize:function(t,n,i,r,s,o){this._set(t,n,i,r,!0),this._owner=s,this._setter=o},_set:function(e,t,n,i,r){return this._x=e,this._y=t,this._width=n,this._height=i,r||this._owner[this._setter](this),this}},new function(){var e=V.prototype;return I.each(["x","y","width","height"],function(t){var n=I.capitalize(t),i="_"+t;this["get"+n]=function(){return this[i]},this["set"+n]=function(r){this[i]=r,this._dontNotify||this._owner[this._setter](this)}},I.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(t){var n="set"+t;this[n]=function(){this._dontNotify=!0,e[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(t){var n=this._owner;n._changeSelection&&n._changeSelection(2,t)}}))}),Q=I.extend({_class:"Matrix",initialize:function e(t,n){var i=arguments,r=i.length,s=!0;if(r>=6?this._set.apply(this,i):r===1||r===2?t instanceof e?this._set(t._a,t._b,t._c,t._d,t._tx,t._ty,n):Array.isArray(t)?this._set.apply(this,n?t.concat([n]):t):s=!1:r?s=!1:this.reset(),!s)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(e,t,n,i,r,s,o){return this._a=e,this._b=t,this._c=n,this._d=i,this._tx=r,this._ty=s,o||this._changed(),this},_serialize:function(e,t){return I.serialize(this.getValues(),e,!0,t)},_changed:function(){var e=this._owner;e&&(e._applyMatrix?e.transform(null,!0):e._changed(25))},clone:function(){return new Q(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(e){return e===this||e&&this._a===e._a&&this._b===e._b&&this._c===e._c&&this._d===e._d&&this._tx===e._tx&&this._ty===e._ty},toString:function(){var e=G.instance;return"[["+[e.number(this._a),e.number(this._c),e.number(this._tx)].join(", ")+"], ["+[e.number(this._b),e.number(this._d),e.number(this._ty)].join(", ")+"]]"},reset:function(e){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,e||this._changed(),this},apply:function(e,t){var n=this._owner;return n?(n.transform(null,I.pick(e,!0),t),this.isIdentity()):!1},translate:function(){var e=k.read(arguments),t=e.x,n=e.y;return this._tx+=t*this._a+n*this._c,this._ty+=t*this._b+n*this._d,this._changed(),this},scale:function(){var e=arguments,t=k.read(e),n=k.read(e,0,{readNull:!0});return n&&this.translate(n),this._a*=t.x,this._b*=t.x,this._c*=t.y,this._d*=t.y,n&&this.translate(n.negate()),this._changed(),this},rotate:function(e){e*=Math.PI/180;var t=k.read(arguments,1),n=t.x,i=t.y,r=Math.cos(e),s=Math.sin(e),o=n-n*r+i*s,a=i-n*s-i*r,u=this._a,l=this._b,d=this._c,_=this._d;return this._a=r*u+s*d,this._b=r*l+s*_,this._c=-s*u+r*d,this._d=-s*l+r*_,this._tx+=o*u+a*d,this._ty+=o*l+a*_,this._changed(),this},shear:function(){var e=arguments,t=k.read(e),n=k.read(e,0,{readNull:!0});n&&this.translate(n);var i=this._a,r=this._b;return this._a+=t.y*this._c,this._b+=t.y*this._d,this._c+=t.x*i,this._d+=t.x*r,n&&this.translate(n.negate()),this._changed(),this},skew:function(){var e=arguments,t=k.read(e),n=k.read(e,0,{readNull:!0}),i=Math.PI/180,r=new k(Math.tan(t.x*i),Math.tan(t.y*i));return this.shear(r,n)},append:function(e,t){if(e){var n=this._a,i=this._b,r=this._c,s=this._d,o=e._a,a=e._c,u=e._b,l=e._d,d=e._tx,_=e._ty;this._a=o*n+u*r,this._c=a*n+l*r,this._b=o*i+u*s,this._d=a*i+l*s,this._tx+=d*n+_*r,this._ty+=d*i+_*s,t||this._changed()}return this},prepend:function(e,t){if(e){var n=this._a,i=this._b,r=this._c,s=this._d,o=this._tx,a=this._ty,u=e._a,l=e._c,d=e._b,_=e._d,f=e._tx,c=e._ty;this._a=u*n+l*i,this._c=u*r+l*s,this._b=d*n+_*i,this._d=d*r+_*s,this._tx=u*o+l*a+f,this._ty=d*o+_*a+c,t||this._changed()}return this},appended:function(e){return this.clone().append(e)},prepended:function(e){return this.clone().prepend(e)},invert:function(){var e=this._a,t=this._b,n=this._c,i=this._d,r=this._tx,s=this._ty,o=e*i-t*n,a=null;return o&&!isNaN(o)&&isFinite(r)&&isFinite(s)&&(this._a=i/o,this._b=-t/o,this._c=-n/o,this._d=e/o,this._tx=(n*s-i*r)/o,this._ty=(t*r-e*s)/o,a=this),a},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new Q(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var e=this._a*this._d-this._c*this._b;return e&&!isNaN(e)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(e,t,n){return arguments.length<3?this._transformPoint(k.read(arguments)):this._transformCoordinates(e,t,n)},_transformPoint:function(e,t,n){var i=e.x,r=e.y;return t||(t=new k),t._set(i*this._a+r*this._c+this._tx,i*this._b+r*this._d+this._ty,n)},_transformCoordinates:function(e,t,n){for(var i=0,r=2*n;i<r;i+=2){var s=e[i],o=e[i+1];t[i]=s*this._a+o*this._c+this._tx,t[i+1]=s*this._b+o*this._d+this._ty}return t},_transformCorners:function(e){var t=e.x,n=e.y,i=t+e.width,r=n+e.height,s=[t,n,i,n,i,r,t,r];return this._transformCoordinates(s,s,4)},_transformBounds:function(e,t,n){for(var i=this._transformCorners(e),r=i.slice(0,2),s=r.slice(),o=2;o<8;o++){var a=i[o],u=o&1;a<r[u]?r[u]=a:a>s[u]&&(s[u]=a)}return t||(t=new V),t._set(r[0],r[1],s[0]-r[0],s[1]-r[1],n)},inverseTransform:function(){return this._inverseTransform(k.read(arguments))},_inverseTransform:function(e,t,n){var i=this._a,r=this._b,s=this._c,o=this._d,a=this._tx,u=this._ty,l=i*o-r*s,d=null;if(l&&!isNaN(l)&&isFinite(a)&&isFinite(u)){var _=e.x-this._tx,f=e.y-this._ty;t||(t=new k),d=t._set((_*o-f*s)/l,(f*i-_*r)/l,n)}return d},decompose:function(){var e=this._a,t=this._b,n=this._c,i=this._d,r=e*i-t*n,s=Math.sqrt,o=Math.atan2,a=180/Math.PI,u,l,d;if(e!==0||t!==0){var _=s(e*e+t*t);u=Math.acos(e/_)*(t>0?1:-1),l=[_,r/_],d=[o(e*n+t*i,_*_),0]}else if(n!==0||i!==0){var f=s(n*n+i*i);u=Math.asin(n/f)*(i>0?1:-1),l=[r/f,f],d=[0,o(e*n+t*i,f*f)]}else u=0,d=l=[0,0];return{translation:this.getTranslation(),rotation:u*a,scaling:new k(l),skewing:new k(d[0]*a,d[1]*a)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new k(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(e){this.isIdentity()||e.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},I.each(["a","b","c","d","tx","ty"],function(e){var t=I.capitalize(e),n="_"+e;this["get"+t]=function(){return this[n]},this["set"+t]=function(i){this[n]=i,this._changed()}},{})),re=I.extend({_class:"Line",initialize:function(t,n,i,r,s){var o=!1;arguments.length>=4?(this._px=t,this._py=n,this._vx=i,this._vy=r,o=s):(this._px=t.x,this._py=t.y,this._vx=n.x,this._vy=n.y,o=i),o||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new k(this._px,this._py)},getVector:function(){return new k(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(e,t){return re.intersect(this._px,this._py,this._vx,this._vy,e._px,e._py,e._vx,e._vy,!0,t)},getSide:function(e,t){return re.getSide(this._px,this._py,this._vx,this._vy,e.x,e.y,!0,t)},getDistance:function(e){return Math.abs(this.getSignedDistance(e))},getSignedDistance:function(e){return re.getSignedDistance(this._px,this._py,this._vx,this._vy,e.x,e.y,!0)},isCollinear:function(e){return k.isCollinear(this._vx,this._vy,e._vx,e._vy)},isOrthogonal:function(e){return k.isOrthogonal(this._vx,this._vy,e._vx,e._vy)},statics:{intersect:function(e,t,n,i,r,s,o,a,u,l){u||(n-=e,i-=t,o-=r,a-=s);var d=n*a-i*o;if(!j.isMachineZero(d)){var _=e-r,f=t-s,c=(o*f-a*_)/d,S=(n*f-i*_)/d,v=1e-12,P=-v,g=1+v;if(l||P<c&&c<g&&P<S&&S<g)return l||(c=c<=0?0:c>=1?1:c),new k(e+c*n,t+c*i)}},getSide:function(e,t,n,i,r,s,o,a){o||(n-=e,i-=t);var u=r-e,l=s-t,d=u*i-l*n;return!a&&j.isMachineZero(d)&&(d=(u*n+u*n)/(n*n+i*i),d>=0&&d<=1&&(d=0)),d<0?-1:d>0?1:0},getSignedDistance:function(e,t,n,i,r,s,o){return o||(n-=e,i-=t),n===0?i>0?r-e:e-r:i===0?n<0?s-t:t-s:((r-e)*i-(s-t)*n)/(i>n?i*Math.sqrt(1+n*n/(i*i)):n*Math.sqrt(1+i*i/(n*n)))},getDistance:function(e,t,n,i,r,s,o){return Math.abs(re.getSignedDistance(e,t,n,i,r,s,o))}}}),W=U.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){U.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new On(null,null,this),this._view=Xe.create(this,t||it.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(e,t){return I.serialize(this._children,e,!0,t)},_changed:function(e,t){if(e&1){var n=this._view;n&&(n._needsUpdate=!0,!n._requested&&n._autoUpdate&&n.requestUpdate())}var i=this._changes;if(i&&t){var r=this._changesById,s=t._id,o=r[s];o?o.flags|=e:i.push(r[s]={item:t,flags:e})}},clear:function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t].remove()},isEmpty:function(){return!this._children.length},remove:function e(){return e.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(e){this._currentStyle.set(e)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new $({project:this,insert:!0})},getSymbolDefinitions:function(){var e=[],t={};return this.getItems({class:Ie,match:function(n){var i=n._definition,r=i._id;return t[r]||(t[r]=!0,e.push(i)),!1}}),e},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var e=this._selectionItems,t=[];for(var n in e){var i=e[n],r=i._selection;r&1&&i.isInserted()?t.push(i):r||this._updateSelection(i)}return t},_updateSelection:function(e){var t=e._id,n=this._selectionItems;e._selection?n[t]!==e&&(this._selectionCount++,n[t]=e):n[t]===e&&(this._selectionCount--,delete n[t])},selectAll:function(){for(var e=this._children,t=0,n=e.length;t<n;t++)e[t].setFullySelected(!0)},deselectAll:function(){var e=this._selectionItems;for(var t in e)e[t].setFullySelected(!1)},addLayer:function(e){return this.insertLayer(M,e)},insertLayer:function(e,t){if(t instanceof $){t._remove(!1,!0),I.splice(this._children,[t],e,0),t._setProject(this,!0);var n=t._name;n&&t.setName(n),this._changes&&t._changed(5),this._activeLayer||(this._activeLayer=t)}else t=null;return t},_insertItem:function(e,t,n){return t=this.insertLayer(e,t)||(this._activeLayer||this._insertItem(M,new $(R.NO_INSERT),!0)).insertChild(e,t),n&&t.activate&&t.activate(),t},getItems:function(e){return R._getItems(this,e)},getItem:function(e){return R._getItems(this,e,null,null,!0)[0]||null},importJSON:function(e){this.activate();var t=this._activeLayer;return I.importJSON(e,t&&t.isEmpty()&&t)},removeOn:function(e){var t=this._removeSets;if(t){e==="mouseup"&&(t.mousedrag=null);var n=t[e];if(n){for(var i in n){var r=n[i];for(var s in t){var o=t[s];o&&o!=n&&delete o[r._id]}r.remove()}t[e]=null}}},draw:function(e,t,n){this._updateVersion++,e.save(),t.applyToContext(e);for(var i=this._children,r=new I({offset:new k(0,0),pixelRatio:n,viewMatrix:t.isIdentity()?null:t,matrices:[new Q],updateMatrix:!0}),s=0,o=i.length;s<o;s++)i[s].draw(e,r);if(e.restore(),this._selectionCount>0){e.save(),e.strokeWidth=1;var a=this._selectionItems,u=this._scope.settings.handleSize,l=this._updateVersion;for(var d in a)a[d]._drawSelection(e,t,u,a,l);e.restore()}}}),R=I.extend(O,{statics:{extend:function e(t){return t._serializeFields&&(t._serializeFields=I.set({},this.prototype._serializeFields,t._serializeFields)),e.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new Q,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var e=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return I.each(e,function(t){this._events[t]={install:function(n){this.getView()._countItemEvent(n,1)},uninstall:function(n){this.getView()._countItemEvent(n,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:e}})},{initialize:function(){},_initialize:function(e,t){var n=e&&I.isPlainObject(e),i=n&&e.internal===!0,r=this._matrix=new Q,s=n&&e.project||De.project,o=De.settings;return this._id=i?null:ie.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&o.applyMatrix,t&&r.translate(t),r._owner=this,this._style=new On(s._currentStyle,this,s),i||n&&e.insert==!1||!o.insertItems&&!(n&&e.insert==!0)?this._setProject(s):(n&&e.parent||s)._insertItem(M,this,!0),n&&e!==R.NO_INSERT&&e!==R.INSERT&&this.set(e,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(e,t){var n={},i=this;function r(s){for(var o in s){var a=i[o];I.equals(a,o==="leading"?s.fontSize*1.2:s[o])||(n[o]=I.serialize(a,e,o!=="data",t))}}return r(this._serializeFields),this instanceof ne||r(this._style._defaults),[this._class,n]},_changed:function(e){var t=this._symbol,n=this._parent||t,i=this._project;e&8&&(this._bounds=this._position=this._decomposed=M),e&16&&(this._globalMatrix=M),n&&e&72&&R._clearBoundsCache(n),e&2&&R._clearBoundsCache(this),i&&i._changed(e,this),t&&t._changed(e)},getId:function(){return this._id},getName:function(){return this._name},setName:function(e){if(this._name&&this._removeNamed(),e===+e+"")throw new Error("Names consisting only of numbers are not supported.");var t=this._getOwner();if(e&&t){var n=t._children,i=t._namedChildren;(i[e]=i[e]||[]).push(this),e in n||(n[e]=this)}this._name=e||M,this._changed(256)},getStyle:function(){return this._style},setStyle:function(e){this.getStyle().set(e)}},I.each(["locked","visible","blendMode","opacity","guide"],function(e){var t=I.capitalize(e),n="_"+e,i={locked:256,visible:265};this["get"+t]=function(){return this[n]},this["set"+t]=function(r){r!=this[n]&&(this[n]=r,this._changed(i[e]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(e){if(e!==this._selection){this._selection=e;var t=this._project;t&&(t._updateSelection(this),this._changed(257))}},_changeSelection:function(e,t){var n=this._selection;this.setSelection(t?n|e:n&~e)},isSelected:function(){if(this._selectChildren){for(var e=this._children,t=0,n=e.length;t<n;t++)if(e[t].isSelected())return!0}return!!(this._selection&1)},setSelected:function(e){if(this._selectChildren)for(var t=this._children,n=0,i=t.length;n<i;n++)t[n].setSelected(e);this._changeSelection(1,e)},isFullySelected:function(){var e=this._children,t=!!(this._selection&1);if(e&&t){for(var n=0,i=e.length;n<i;n++)if(!e[n].isFullySelected())return!1;return!0}return t},setFullySelected:function(e){var t=this._children;if(t)for(var n=0,i=t.length;n<i;n++)t[n].setFullySelected(e);this._changeSelection(1,e)},isClipMask:function(){return this._clipMask},setClipMask:function(e){this._clipMask!=(e=!!e)&&(this._clipMask=e,e&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(e){this._data=e},getPosition:function(e){var t=e?k:ue,n=this._position||(this._position=this._getPositionFromBounds());return new t(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(k.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(e){return this._pivot?this._matrix._transformPoint(this._pivot):(e||this.getBounds()).getCenter(!0)},getPivot:function(){var e=this._pivot;return e?new ue(e.x,e.y,this,"setPivot"):null},setPivot:function(){this._pivot=k.read(arguments,0,{clone:!0,readNull:!0}),this._position=M}},I.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(e,t){this[t]=function(n){return this.getBounds(n,e)}},{beans:!0,getBounds:function(e,t){var n=t||e instanceof Q,i=I.set({},n?t:e,this._boundsOptions);(!i.stroke||this.getStrokeScaling())&&(i.cacheItem=this);var r=this._getCachedBounds(n&&e,i).rect;return arguments.length?r:new Y(r.x,r.y,r.width,r.height,this,"setBounds")},setBounds:function(){var e=V.read(arguments),t=this.getBounds(),n=this._matrix,i=new Q,r=e.getCenter();i.translate(r),(e.width!=t.width||e.height!=t.height)&&(n.isInvertible()||(n.set(n._backup||new Q().translate(n.getTranslation())),t=this.getBounds()),i.scale(t.width!==0?e.width/t.width:0,t.height!==0?e.height/t.height:0)),r=t.getCenter(),i.translate(-r.x,-r.y),this.transform(i)},_getBounds:function(e,t){var n=this._children;return!n||!n.length?new V:(R._updateBoundsCache(this,t.cacheItem),R._getBounds(n,e,t))},_getBoundsCacheKey:function(e,t){return[e.stroke?1:0,e.handle?1:0,t?1:0].join("")},_getCachedBounds:function(e,t,n){e=e&&e._orNullIfIdentity();var i=t.internal&&!n,r=t.cacheItem,s=i?null:this._matrix._orNullIfIdentity(),o=r&&(!e||e.equals(s))&&this._getBoundsCacheKey(t,i),a=this._bounds;if(R._updateBoundsCache(this._parent||this._symbol,r),o&&a&&o in a){var u=a[o];return{rect:u.rect.clone(),nonscaling:u.nonscaling}}var l=this._getBounds(e||s,t),d=l.rect||l,_=this._style,f=l.nonscaling||_.hasStroke()&&!_.getStrokeScaling();if(o){a||(this._bounds=a={});var u=a[o]={rect:d.clone(),nonscaling:f,internal:i}}return{rect:d,nonscaling:f}},_getStrokeMatrix:function(e,t){var n=this.getStrokeScaling()?null:t&&t.internal?this:this._parent||this._symbol&&this._symbol._item,i=n?n.getViewMatrix().invert():e;return i&&i._shiftless()},statics:{_updateBoundsCache:function(e,t){if(e&&t){var n=t._id,i=e._boundsCache=e._boundsCache||{ids:{},list:[]};i.ids[n]||(i.list.push(t),i.ids[n]=t)}},_clearBoundsCache:function(e){var t=e._boundsCache;if(t){e._bounds=e._position=e._boundsCache=M;for(var n=0,i=t.list,r=i.length;n<r;n++){var s=i[n];s!==e&&(s._bounds=s._position=M,s._boundsCache&&R._clearBoundsCache(s))}}},_getBounds:function(e,t,n){var i=1/0,r=-i,s=i,o=r,a=!1;n=n||{};for(var u=0,l=e.length;u<l;u++){var d=e[u];if(d._visible&&!d.isEmpty(!0)){var _=d._getCachedBounds(t&&t.appended(d._matrix),n,!0),f=_.rect;i=Math.min(f.x,i),s=Math.min(f.y,s),r=Math.max(f.x+f.width,r),o=Math.max(f.y+f.height,o),_.nonscaling&&(a=!0)}}return{rect:isFinite(i)?new V(i,s,r-i,o-s):new V,nonscaling:a}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var e=this._decompose();return e?e.rotation:0},setRotation:function(e){var t=this.getRotation();if(t!=null&&e!=null){var n=this._decomposed;this.rotate(e-t),n&&(n.rotation=e,this._decomposed=n)}},getScaling:function(){var e=this._decompose(),t=e&&e.scaling;return new ue(t?t.x:1,t?t.y:1,this,"setScaling")},setScaling:function(){var e=this.getScaling(),t=k.read(arguments,0,{clone:!0,readNull:!0});if(e&&t&&!e.equals(t)){var n=this.getRotation(),i=this._decomposed,r=new Q,s=j.isZero;if(s(e.x)||s(e.y))r.translate(i.translation),n&&r.rotate(n),r.scale(t.x,t.y),this._matrix.set(r);else{var o=this.getPosition(!0);r.translate(o),n&&r.rotate(n),r.scale(t.x/e.x,t.y/e.y),n&&r.rotate(-n),r.translate(o.negate()),this.transform(r)}i&&(i.scaling=t,this._decomposed=i)}},getMatrix:function(){return this._matrix},setMatrix:function(){var e=this._matrix;e.set.apply(e,arguments)},getGlobalMatrix:function(e){var t=this._globalMatrix;if(t)for(var n=this._parent,i=[];n;){if(!n._globalMatrix){t=null;for(var r=0,s=i.length;r<s;r++)i[r]._globalMatrix=null;break}i.push(n),n=n._parent}if(!t){t=this._globalMatrix=this._matrix.clone();var n=this._parent;n&&t.prepend(n.getGlobalMatrix(!0))}return e?t:t.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(e){(this._applyMatrix=this._canApplyMatrix&&!!e)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(e,t){if(this._project!==e){this._project&&this._installEvents(!1),this._project=e;for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._setProject(e);t=!0}t&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function e(t){e.base.call(this,t);for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._installEvents(t)},getLayer:function(){for(var e=this;e=e._parent;)if(e instanceof $)return e;return null},getParent:function(){return this._parent},setParent:function(e){return e.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(e){this.removeChildren(),this.addChildren(e)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var e=this._getOwner();return e&&e._children[this._index+1]||null},getPreviousSibling:function(){var e=this._getOwner();return e&&e._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(e){var t=this._parent,n=t&&t._children;n&&t.insertChildren(e in n?e:M,[this])},equals:function(e){return e===this||e&&this._class===e._class&&this._style.equals(e._style)&&this._matrix.equals(e._matrix)&&this._locked===e._locked&&this._visible===e._visible&&this._blendMode===e._blendMode&&this._opacity===e._opacity&&this._clipMask===e._clipMask&&this._guide===e._guide&&this._equals(e)||!1},_equals:function(e){return I.equals(this._children,e._children)},clone:function(e){var t=new this.constructor(R.NO_INSERT),n=this._children,i=I.pick(e?e.insert:M,e===M||e===!0),r=I.pick(e?e.deep:M,!0);n&&t.copyAttributes(this),(!n||r)&&t.copyContent(this),n||t.copyAttributes(this),i&&t.insertAbove(this);var s=this._name,o=this._parent;if(s&&o){for(var n=o._children,a=s,u=1;n[s];)s=a+" "+u++;s!==a&&t.setName(s)}return t},copyContent:function(e){for(var t=e._children,n=0,i=t&&t.length;n<i;n++)this.addChild(t[n].clone(!1),!0)},copyAttributes:function(e,t){this.setStyle(e._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],i=0,r=n.length;i<r;i++){var s=n[i];e.hasOwnProperty(s)&&(this[s]=e[s])}t||this._matrix.set(e._matrix,!0),this.setApplyMatrix(e._applyMatrix),this.setPivot(e._pivot),this.setSelection(e._selection);var o=e._data,a=e._name;this._data=o?I.clone(o):null,a&&this.setName(a)},rasterize:function(e,t){var n,i,r;I.isPlainObject(e)?(n=e.resolution,i=e.insert,r=e.raster):(n=e,i=t),r||(r=new ve(R.NO_INSERT));var s=this.getStrokeBounds(),o=(n||this.getView().getResolution())/72,a=s.getTopLeft().floor(),u=s.getBottomRight().ceil(),l=new se(u.subtract(a)),d=l.multiply(o);if(r.setSize(d,!0),!d.isZero()){var _=r.getContext(!0),f=new Q().scale(o).translate(a.negate());_.save(),f.applyToContext(_),this.draw(_,new I({matrices:[f]})),_.restore()}return r._matrix.set(new Q().translate(a.add(l.divide(2))).scale(1/o)),(i===M||i)&&r.insertAbove(this),r},contains:function(){var e=this._matrix;return e.isInvertible()&&!!this._contains(e._inverseTransform(k.read(arguments)))},_contains:function(e){var t=this._children;if(t){for(var n=t.length-1;n>=0;n--)if(t[n].contains(e))return!0;return!1}return e.isInside(this.getInternalBounds())},isInside:function(){return V.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Fe.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(e,t){return e instanceof R?this._asPathItem().getIntersections(e._asPathItem(),null,t,!0).length>0:!1}},new function(){function e(){var i=arguments;return this._hitTest(k.read(i),Me.getOptions(i))}function t(){var i=arguments,r=k.read(i),s=Me.getOptions(i),o=[];return this._hitTest(r,new I({all:o},s)),o}function n(i,r,s,o){var a=this._children;if(a)for(var u=a.length-1;u>=0;u--){var l=a[u],d=l!==o&&l._hitTest(i,r,s);if(d&&!r.all)return d}return null}return W.inject({hitTest:e,hitTestAll:t,_hitTest:n}),{hitTest:e,hitTestAll:t,_hitTestChildren:n}},{_hitTest:function(e,t,n){if(this._locked||!this._visible||this._guide&&!t.guides||this.isEmpty())return null;var i=this._matrix,r=n?n.appended(i):this.getGlobalMatrix().prepend(this.getView()._matrix),s=Math.max(t.tolerance,1e-12),o=t._tolerancePadding=new se(Fe._getStrokePadding(s,i._shiftless().invert()));if(e=i._inverseTransform(e),!e||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(e))return null;var a=!(t.guides&&!this._guide||t.selected&&!this.isSelected()||t.type&&t.type!==I.hyphenate(this._class)||t.class&&!(this instanceof t.class)),u=t.match,l=this,d,_;function f(h){return h&&u&&!u(h)&&(h=null),h&&t.all&&t.all.push(h),h}function c(h,p){var x=p?d["get"+p]():l.getPosition();if(e.subtract(x).divide(o).length<=1)return new Me(h,l,{name:p?I.hyphenate(p):h,point:x})}var S=t.position,v=t.center,P=t.bounds;if(a&&this._parent&&(S||v||P)){if((v||P)&&(d=this.getInternalBounds()),_=S&&c("position")||v&&c("center","Center"),!_&&P)for(var g=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],w=0;w<8&&!_;w++)_=c("bounds",g[w]);_=f(_)}return _||(_=this._hitTestChildren(e,t,r)||a&&f(this._hitTestSelf(e,t,r,this.getStrokeScaling()?null:r._shiftless().invert()))||null),_&&_.point&&(_.point=i.transform(_.point)),_},_hitTestSelf:function(e,t){if(t.fill&&this.hasFill()&&this._contains(e))return new Me("fill",this)},matches:function(e,t){function n(o,a){for(var u in o)if(o.hasOwnProperty(u)){var l=o[u],d=a[u];if(I.isPlainObject(l)&&I.isPlainObject(d)){if(!n(l,d))return!1}else if(!I.equals(l,d))return!1}return!0}var i=typeof e;if(i==="object"){for(var r in e)if(e.hasOwnProperty(r)&&!this.matches(r,e[r]))return!1;return!0}else{if(i==="function")return e(this);if(e==="match")return t(this);var s=/^(empty|editable)$/.test(e)?this["is"+I.capitalize(e)]():e==="type"?I.hyphenate(this._class):this[e];if(e==="class"){if(typeof t=="function")return this instanceof t;s=this._class}if(typeof t=="function")return!!t(s);if(t){if(t.test)return t.test(s);if(I.isPlainObject(t))return n(t,s)}return I.equals(s,t)}},getItems:function(e){return R._getItems(this,e,this._matrix)},getItem:function(e){return R._getItems(this,e,this._matrix,null,!0)[0]||null},statics:{_getItems:function e(t,n,i,r,s){if(!r){var o=typeof n=="object"&&n,a=o&&o.overlapping,u=o&&o.inside,l=a||u,f=l&&V.read([l]);r={items:[],recursive:o&&o.recursive!==!1,inside:!!u,overlapping:!!a,rect:f,path:a&&new Fe.Rectangle({rectangle:f,insert:!1})},o&&(n=I.filter({},n,{recursive:!0,inside:!0,overlapping:!0}))}var d=t._children,_=r.items,f=r.rect;i=f&&(i||new Q);for(var c=0,S=d&&d.length;c<S;c++){var v=d[c],P=i&&i.appended(v._matrix),g=!0;if(f){var l=v.getBounds(P);if(!f.intersects(l))continue;f.contains(l)||r.overlapping&&(l.contains(f)||r.path.intersects(v,P))||(g=!1)}if(g&&v.matches(n)&&(_.push(v),s)||(r.recursive!==!1&&e(v,n,P,r,s),s&&_.length>0))break}return _}}},{importJSON:function(e){var t=I.importJSON(e,this);return t!==this?this.addChild(t):t},addChild:function(e){return this.insertChild(M,e)},insertChild:function(e,t){var n=t?this.insertChildren(e,[t]):null;return n&&n[0]},addChildren:function(e){return this.insertChildren(this._children.length,e)},insertChildren:function(e,t){var n=this._children;if(n&&t&&t.length>0){t=I.slice(t);for(var i={},r=t.length-1;r>=0;r--){var s=t[r],o=s&&s._id;!s||i[o]?t.splice(r,1):(s._remove(!1,!0),i[o]=!0)}I.splice(n,t,e,0);for(var a=this._project,u=a._changes,r=0,l=t.length;r<l;r++){var s=t[r],d=s._name;s._parent=this,s._setProject(a,!0),d&&s.setName(d),u&&s._changed(5)}this._changed(11)}else t=null;return t},_insertItem:"#insertChild",_insertAt:function(e,t){var n=e&&e._getOwner(),i=e!==this&&n?this:null;return i&&(i._remove(!1,!0),n._insertItem(e._index+t,i)),i},insertAbove:function(e){return this._insertAt(e,1)},insertBelow:function(e){return this._insertAt(e,0)},sendToBack:function(){var e=this._getOwner();return e?e._insertItem(0,this):null},bringToFront:function(){var e=this._getOwner();return e?e._insertItem(M,this):null},appendTop:"#addChild",appendBottom:function(e){return this.insertChild(0,e)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(e){return e._insertItem(M,this)},copyTo:function(e){return this.clone(!1).addTo(e)},reduce:function(e){var t=this._children;if(t&&t.length===1){var n=t[0].reduce(e);return this._parent?(n.insertAbove(this),this.remove()):n.remove(),n}return this},_removeNamed:function(){var e=this._getOwner();if(e){var t=e._children,n=e._namedChildren,i=this._name,r=n[i],s=r?r.indexOf(this):-1;s!==-1&&(t[i]==this&&delete t[i],r.splice(s,1),r.length?t[i]=r[0]:delete n[i])}},_remove:function(e,t){var n=this._getOwner(),i=this._project,r=this._index;return this._style&&this._style._dispose(),n?(this._name&&this._removeNamed(),r!=null&&(i._activeLayer===this&&(i._activeLayer=this.getNextSibling()||this.getPreviousSibling()),I.splice(n._children,null,r,1)),this._installEvents(!1),e&&i._changes&&this._changed(5),t&&n._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(e){var t=e&&e.insertBelow(this);return t&&this.remove(),t},removeChildren:function(e,t){if(!this._children)return null;e=e||0,t=I.pick(t,this._children.length);for(var n=I.splice(this._children,null,e,t-e),i=n.length-1;i>=0;i--)n[i]._remove(!0,!1);return n.length>0&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var e=0,t=this._children.length;e<t;e++)this._children[e]._index=e;this._changed(11)}},isEmpty:function(e){var t=this._children,n=t?t.length:0;if(e){for(var i=0;i<n;i++)if(!t[i].isEmpty(e))return!1;return!0}return!n},isEditable:function(){for(var e=this;e;){if(!e._visible||e._locked)return!1;e=e._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(e){function t(o){var a=[];do a.unshift(o);while(o=o._parent);return a}for(var n=t(this),i=t(e),r=0,s=Math.min(n.length,i.length);r<s;r++)if(n[r]!=i[r])return n[r]._index<i[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(e){return this._getOrder(e)===-1},isBelow:function(e){return this._getOrder(e)===1},isParent:function(e){return this._parent===e},isChild:function(e){return e&&e._parent===this},isDescendant:function(e){for(var t=this;t=t._parent;)if(t===e)return!0;return!1},isAncestor:function(e){return e?e.isDescendant(this):!1},isSibling:function(e){return this._parent===e._parent},isGroupedWith:function(e){for(var t=this._parent;t;){if(t._parent&&/^(Group|Layer|CompoundPath)$/.test(t._class)&&e.isDescendant(t))return!0;t=t._parent}return!1}},I.each(["rotate","scale","shear","skew"],function(e){var t=e==="rotate";this[e]=function(){var n=arguments,i=(t?I:k).read(n),r=k.read(n,0,{readNull:!0});return this.transform(new Q()[e](i,r||this.getPosition(!0)))}},{translate:function(){var e=new Q;return this.transform(e.translate.apply(e,arguments))},transform:function(e,t,n){var i=this._matrix,r=e&&!e.isIdentity(),s=n&&this._canApplyMatrix||this._applyMatrix&&(r||!i.isIdentity()||t&&this._children);if(!r&&!s)return this;if(r){!e.isInvertible()&&i.isInvertible()&&(i._backup=i.getValues()),i.prepend(e,!0);var o=this._style,a=o.getFillColor(!0),u=o.getStrokeColor(!0);a&&a.transform(e),u&&u.transform(e)}if(s&&(s=this._transformContent(i,t,n))){var l=this._pivot;l&&i._transformPoint(l,l,!0),i.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0)}var d=this._bounds,_=this._position;(r||s)&&this._changed(25);var f=r&&d&&e.decompose();if(f&&f.skewing.isZero()&&f.rotation%90===0){for(var c in d){var S=d[c];if(S.nonscaling)delete d[c];else if(s||!S.internal){var v=S.rect;e._transformBounds(v,v)}}this._bounds=d;var P=d[this._getBoundsCacheKey(this._boundsOptions||{})];P&&(this._position=this._getPositionFromBounds(P.rect))}else r&&_&&this._pivot&&(this._position=e._transformPoint(_,_));return this},_transformContent:function(e,t,n){var i=this._children;if(i){for(var r=0,s=i.length;r<s;r++)i[r].transform(e,t,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(k.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(k.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(k.read(arguments))},localToParent:function(){return this._matrix._transformPoint(k.read(arguments))},fitBounds:function(e,t){e=V.read(arguments);var n=this.getBounds(),i=n.height/n.width,r=e.height/e.width,s=(t?i>r:i<r)?e.width/n.width:e.height/n.height,o=new V(new k,new se(n.width*s,n.height*s));o.setCenter(e.getCenter()),this.setBounds(o)}}),{_setStyles:function(e,t,n){var i=this._style,r=this._matrix;if(i.hasFill()&&(e.fillStyle=i.getFillColor().toCanvasStyle(e,r)),i.hasStroke()){e.strokeStyle=i.getStrokeColor().toCanvasStyle(e,r),e.lineWidth=i.getStrokeWidth();var s=i.getStrokeJoin(),o=i.getStrokeCap(),a=i.getMiterLimit();if(s&&(e.lineJoin=s),o&&(e.lineCap=o),a&&(e.miterLimit=a),De.support.nativeDash){var u=i.getDashArray(),l=i.getDashOffset();u&&u.length&&("setLineDash"in e?(e.setLineDash(u),e.lineDashOffset=l):(e.mozDash=u,e.mozDashOffset=l))}}if(i.hasShadow()){var d=t.pixelRatio||1,_=n._shiftless().prepend(new Q().scale(d,d)),f=_.transform(new k(i.getShadowBlur(),0)),c=_.transform(this.getShadowOffset());e.shadowColor=i.getShadowColor().toCanvasStyle(e),e.shadowBlur=f.getLength(),e.shadowOffsetX=c.x,e.shadowOffsetY=c.y}},draw:function(e,t,n){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var i=t.matrices,r=t.viewMatrix,s=this._matrix,o=i[i.length-1].appended(s);if(o.isInvertible()){r=r?r.appended(o):o,i.push(o),t.updateMatrix&&(this._globalMatrix=o);var a=this._blendMode,u=j.clamp(this._opacity,0,1),l=a==="normal",d=zn.nativeModes[a],_=l&&u===1||t.dontStart||t.clip||(d||l&&u<1)&&this._canComposite(),f=t.pixelRatio||1,c,S,v;if(!_){var P=this.getStrokeBounds(r);if(!P.width||!P.height){i.pop();return}v=t.offset,S=t.offset=P.getTopLeft().floor(),c=e,e=it.getContext(P.getSize().ceil().add(1).multiply(f)),f!==1&&e.scale(f,f)}e.save();var g=n?n.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&r,w=!_&&t.clipItem,h=!g||w;if(_?(e.globalAlpha=u,d&&(e.globalCompositeOperation=a)):h&&e.translate(-S.x,-S.y),h&&(_?s:r).applyToContext(e),w&&t.clipItem.draw(e,t.extend({clip:!0})),g){e.setTransform(f,0,0,f,0,0);var p=t.offset;p&&e.translate(-p.x,-p.y)}this._draw(e,t,r,g),e.restore(),i.pop(),t.clip&&!t.dontFinish&&e.clip(this.getFillRule()),_||(zn.process(a,e,c,u,S.subtract(v).multiply(f)),it.release(e),t.offset=v)}}},_isUpdated:function(e){var t=this._parent;if(t instanceof dt)return t._isUpdated(e);var n=this._updateVersion===e;return!n&&t&&t._visible&&t._isUpdated(e)&&(this._updateVersion=e,n=!0),n},_drawSelection:function(e,t,n,i,r){var s=this._selection,o=s&1,a=s&2||o&&this._selectBounds,u=s&4;if(this._drawSelected||(o=!1),(o||a||u)&&this._isUpdated(r)){var l,d=this.getSelectedColor(!0)||(l=this.getLayer())&&l.getSelectedColor(!0),_=t.appended(this.getGlobalMatrix(!0)),f=n/2;if(e.strokeStyle=e.fillStyle=d?d.toCanvasStyle(e):"#009dec",o&&this._drawSelected(e,_,i),u){var c=this.getPosition(!0),S=this._parent,v=S?S.localToGlobal(c):c,P=v.x,g=v.y;e.beginPath(),e.arc(P,g,f,0,Math.PI*2,!0),e.stroke();for(var w=[[0,-1],[1,0],[0,1],[-1,0]],h=f,p=n+1,x=0;x<4;x++){var E=w[x],y=E[0],z=E[1];e.moveTo(P+y*h,g+z*h),e.lineTo(P+y*p,g+z*p),e.stroke()}}if(a){var F=_._transformCorners(this.getInternalBounds());e.beginPath();for(var x=0;x<8;x++)e[x?"lineTo":"moveTo"](F[x],F[++x]);e.closePath(),e.stroke();for(var x=0;x<8;x++)e.fillRect(F[x]-f,F[++x]-f,n,n)}}},_canComposite:function(){return!1}},I.each(["down","drag","up","move"],function(e){this["removeOn"+I.capitalize(e)]=function(){var t={};return t[e]=!0,this.removeOn(t)}},{removeOn:function(e){for(var t in e)if(e[t]){var n="mouse"+t,i=this._project,r=i._removeSets=i._removeSets||{};r[n]=r[n]||{},r[n][this._id]=this}return this}}),{tween:function(e,t,n){n||(n=t,t=e,e=null,n||(n=t,t=null));var i=n&&n.easing,r=n&&n.start,s=n!=null&&(typeof n=="number"?n:n.duration),o=new er(this,e,t,s,i,r);function a(u){o._handleFrame(u.time*1e3),o.running||this.off("frame",a)}return s&&this.on("frame",a),o},tweenTo:function(e,t){return this.tween(null,e,t)},tweenFrom:function(e,t){return this.tween(e,null,t)}}),ne=R.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function e(t){e.base.call(this,t),t&2050&&(this._clipItem=M)},_getClipItem:function(){var e=this._clipItem;if(e===M){e=null;for(var t=this._children,n=0,i=t.length;n<i;n++)if(t[n]._clipMask){e=t[n];break}this._clipItem=e}return e},isClipped:function(){return!!this._getClipItem()},setClipped:function(e){var t=this.getFirstChild();t&&t.setClipMask(e)},_getBounds:function e(t,n){var i=this._getClipItem();return i?i._getCachedBounds(i._matrix.prepended(t),I.set({},n,{stroke:!1})):e.base.call(this,t,n)},_hitTestChildren:function e(t,n,i){var r=this._getClipItem();return(!r||r.contains(t))&&e.base.call(this,t,n,i,r)},_draw:function(e,t){var n=t.clip,i=!n&&this._getClipItem();t=t.extend({clipItem:i,clip:!1}),n?(e.beginPath(),t.dontStart=t.dontFinish=!0):i&&i.draw(e,t.extend({clip:!0}));for(var r=this._children,s=0,o=r.length;s<o;s++){var a=r[s];a!==i&&a.draw(e,t)}}}),$=ne.extend({_class:"Layer",initialize:function(){ne.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function e(){return this._parent?e.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),he=R.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,n){this._initialize(t,n)},_equals:function(e){return this._type===e._type&&this._size.equals(e._size)&&I.equals(this._radius,e._radius)},copyContent:function(e){this.setType(e._type),this.setSize(e._size),this.setRadius(e._radius)},getType:function(){return this._type},setType:function(e){this._type=e},getShape:"#getType",setShape:"#setType",getSize:function(){var e=this._size;return new ae(e.width,e.height,this,"setSize")},setSize:function(){var e=se.read(arguments);if(!this._size)this._size=e.clone();else if(!this._size.equals(e)){var t=this._type,n=e.width,i=e.height;t==="rectangle"?this._radius.set(se.min(this._radius,e.divide(2).abs())):t==="circle"?(n=i=(n+i)/2,this._radius=n/2):t==="ellipse"&&this._radius._set(n/2,i/2),this._size._set(n,i),this._changed(9)}},getRadius:function(){var e=this._radius;return this._type==="circle"?e:new ae(e.width,e.height,this,"setRadius")},setRadius:function(e){var t=this._type;if(t==="circle"){if(e===this._radius)return;var n=e*2;this._radius=e,this._size._set(n,n)}else if(e=se.read(arguments),!this._radius)this._radius=e.clone();else{if(this._radius.equals(e))return;if(this._radius.set(e),t==="rectangle"){var n=se.max(this._size,e.multiply(2));this._size.set(n)}else t==="ellipse"&&this._size._set(e.width*2,e.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(e){var t=new Fe[I.capitalize(this._type)]({center:new k,size:this._size,radius:this._radius,insert:!1});return t.copyAttributes(this),De.settings.applyMatrix&&t.setApplyMatrix(!0),(e===M||e)&&t.insertAbove(this),t},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(e,t,n,i){var r=this._style,s=r.hasFill(),o=r.hasStroke(),a=t.dontFinish||t.clip,u=!i;if(s||o||a){var l=this._type,d=this._radius,_=l==="circle";if(t.dontStart||e.beginPath(),u&&_)e.arc(0,0,d,0,Math.PI*2,!0);else{var f=_?d:d.width,c=_?d:d.height,S=this._size,v=S.width,P=S.height;if(u&&l==="rectangle"&&f===0&&c===0)e.rect(-v/2,-P/2,v,P);else{var g=v/2,w=P/2,h=1-.5522847498307936,p=f*h,x=c*h,E=[-g,-w+c,-g,-w+x,-g+p,-w,-g+f,-w,g-f,-w,g-p,-w,g,-w+x,g,-w+c,g,w-c,g,w-x,g-p,w,g-f,w,-g+f,w,-g+p,w,-g,w-x,-g,w-c];i&&i.transform(E,E,32),e.moveTo(E[0],E[1]),e.bezierCurveTo(E[2],E[3],E[4],E[5],E[6],E[7]),g!==f&&e.lineTo(E[8],E[9]),e.bezierCurveTo(E[10],E[11],E[12],E[13],E[14],E[15]),w!==c&&e.lineTo(E[16],E[17]),e.bezierCurveTo(E[18],E[19],E[20],E[21],E[22],E[23]),g!==f&&e.lineTo(E[24],E[25]),e.bezierCurveTo(E[26],E[27],E[28],E[29],E[30],E[31])}}e.closePath()}!a&&(s||o)&&(this._setStyles(e,t,n),s&&(e.fill(r.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),o&&e.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(e,t){var n=new V(this._size).setCenter(0,0),i=this._style,r=t.stroke&&i.hasStroke()&&i.getStrokeWidth();return e&&(n=e._transformBounds(n)),r?n.expand(Fe._getStrokePadding(r,this._getStrokeMatrix(e,t))):n}},new function(){function e(n,i,r){var s=n._radius;if(!s.isZero())for(var o=n._size.divide(2),a=1;a<=4;a++){var u=new k(a>1&&a<4?-1:1,a>2?-1:1),l=u.multiply(o),d=l.subtract(u.multiply(s)),_=new V(r?l.add(u.multiply(r)):l,d);if(_.contains(i))return{point:d,quadrant:a}}}function t(n,i,r,s){var o=n.divide(i);return(!s||o.isInQuadrant(s))&&o.subtract(o.normalize()).multiply(i).divide(r).length<=1}return{_contains:function n(i){if(this._type==="rectangle"){var r=e(this,i);return r?i.subtract(r.point).divide(this._radius).getLength()<=1:n.base.call(this,i)}else return i.divide(this.size).getLength()<=.5},_hitTestSelf:function n(i,r,s,o){var a=!1,u=this._style,l=r.stroke&&u.hasStroke(),d=r.fill&&u.hasFill();if(l||d){var _=this._type,f=this._radius,c=l?u.getStrokeWidth()/2:0,S=r._tolerancePadding.add(Fe._getStrokePadding(c,!u.getStrokeScaling()&&o));if(_==="rectangle"){var v=S.multiply(2),P=e(this,i,v);if(P)a=t(i.subtract(P.point),f,S,P.quadrant);else{var g=new V(this._size).setCenter(0,0),w=g.expand(v),h=g.expand(v.negate());a=w._containsPoint(i)&&!h._containsPoint(i)}}else a=t(i,f,S)}return a?new Me(l?"stroke":"fill",this):n.base.apply(this,arguments)}}},{statics:new function(){function e(t,n,i,r,s){var o=I.create(he.prototype);return o._type=t,o._size=i,o._radius=r,o._initialize(I.getNamed(s),n),o}return{Circle:function(){var t=arguments,n=k.readNamed(t,"center"),i=I.readNamed(t,"radius");return e("circle",n,new se(i*2),i,t)},Rectangle:function(){var t=arguments,n=V.readNamed(t,"rectangle"),i=se.min(se.readNamed(t,"radius"),n.getSize(!0).divide(2));return e("rectangle",n.getCenter(!0),n.getSize(!0),i,t)},Ellipse:function(){var t=arguments,n=he._readEllipse(t),i=n.radius;return e("ellipse",n.center,i.multiply(2),i,t)},_readEllipse:function(t){var n,i;if(I.hasNamed(t,"radius"))n=k.readNamed(t,"center"),i=se.readNamed(t,"radius");else{var r=V.readNamed(t,"rectangle");n=r.getCenter(!0),i=r.getSize(!0).divide(2)}return{center:n,radius:i}}}}}),ve=R.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(t,n){if(!this._initialize(t,n!==M&&k.read(arguments))){var i,r=typeof t,s=r==="string"?C.getElementById(t):r==="object"?t:null;if(s&&s!==R.NO_INSERT){if(s.getContext||s.naturalHeight!=null)i=s;else if(s){var o=se.read(arguments);o.isZero()||(i=it.getCanvas(o))}}i?this.setImage(i):this.setSource(t)}this._size||(this._size=new se,this._loaded=!1)},_equals:function(e){return this.getSource()===e.getSource()},copyContent:function(e){var t=e._image,n=e._canvas;if(t)this._setImage(t);else if(n){var i=it.getCanvas(e._size);i.getContext("2d").drawImage(n,0,0),this._setImage(i)}this._crossOrigin=e._crossOrigin},getSize:function(){var e=this._size;return new ae(e?e.width:0,e?e.height:0,this,"setSize")},setSize:function(e,t){var n=se.read(arguments);if(n.equals(this._size))t&&this.clear();else if(n.width>0&&n.height>0){var i=!t&&this.getElement();this._setImage(it.getCanvas(n)),i&&this.getContext(!0).drawImage(i,0,0,n.width,n.height)}else this._canvas&&it.release(this._canvas),this._size=n.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(e){this.setSize(e,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(e){this.setSize(this.getWidth(),e)},getLoaded:function(){return this._loaded},isEmpty:function(){var e=this._size;return!e||e.width===0&&e.height===0},getResolution:function(){var e=this._matrix,t=new k(0,0).transform(e),n=new k(1,0).transform(e).subtract(t),i=new k(0,1).transform(e).subtract(t);return new se(72/n.getLength(),72/i.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(e){var t=this;function n(i){var r=t.getView(),s=i&&i.type||"load";r&&t.responds(s)&&(De=r._scope,t.emit(s,new vn(i)))}this._setImage(e),this._loaded?setTimeout(n,0):e&&nt.add(e,{load:function(i){t._setImage(e),n(i)},error:n})},_setImage:function(e){this._canvas&&it.release(this._canvas),e&&e.getContext?(this._image=null,this._canvas=e,this._loaded=!0):(this._image=e,this._canvas=null,this._loaded=!!(e&&e.src&&e.complete)),this._size=new se(e?e.naturalWidth||e.width:0,e?e.naturalHeight||e.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var e=it.getContext(this._size);try{this._image&&e.drawImage(this._image,0,0),this._canvas=e.canvas}catch{it.release(e)}}return this._canvas},setCanvas:"#setImage",getContext:function(e){return this._context||(this._context=this.getCanvas().getContext("2d")),e&&(this._image=null,this._changed(1025)),this._context},setContext:function(e){this._context=e},getSource:function(){var e=this._image;return e&&e.src||this.toDataURL()},setSource:function(e){var t=new T.Image,n=this._crossOrigin;n&&(t.crossOrigin=n),e&&(t.src=e),this.setImage(t)},getCrossOrigin:function(){var e=this._image;return e&&e.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(e){this._crossOrigin=e;var t=this._image;t&&(t.crossOrigin=e)},getSmoothing:function(){return this._smoothing},setSmoothing:function(e){this._smoothing=typeof e=="string"?e:e?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var e=V.read(arguments),t=it.getContext(e.getSize());return t.drawImage(this.getCanvas(),e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.canvas},getSubRaster:function(){var e=V.read(arguments),t=new ve(R.NO_INSERT);return t._setImage(this.getSubCanvas(e)),t.translate(e.getCenter().subtract(this.getSize().divide(2))),t._matrix.prepend(this._matrix),t.insertAbove(this),t},toDataURL:function(){var e=this._image,t=e&&e.src;if(/^data:/.test(t))return t;var n=this.getCanvas();return n?n.toDataURL.apply(n,arguments):null},drawImage:function(e){var t=k.read(arguments,1);this.getContext(!0).drawImage(e,t.x,t.y)},getAverageColor:function(e){var t,n;if(e?e instanceof vt?(n=e,t=e.getBounds()):typeof e=="object"&&("width"in e?t=new V(e):"x"in e&&(t=new V(e.x-.5,e.y-.5,1,1))):t=this.getBounds(),!t)return null;var i=32,r=Math.min(t.width,i),s=Math.min(t.height,i),o=ve._sampleContext;o?o.clearRect(0,0,i+1,i+1):o=ve._sampleContext=it.getContext(new se(i)),o.save();var a=new Q().scale(r/t.width,s/t.height).translate(-t.x,-t.y);a.applyToContext(o),n&&n.draw(o,new I({clip:!0,matrices:[a]})),this._matrix.applyToContext(o);var u=this.getElement(),l=this._size;u&&o.drawImage(u,-l.width/2,-l.height/2),o.restore();for(var d=o.getImageData(.5,.5,Math.ceil(r),Math.ceil(s)).data,_=[0,0,0],f=0,c=0,S=d.length;c<S;c+=4){var v=d[c+3];f+=v,v/=255,_[0]+=d[c]*v,_[1]+=d[c+1]*v,_[2]+=d[c+2]*v}for(var c=0;c<3;c++)_[c]/=f;return f?tt.read(_):null},getPixel:function(){var e=k.read(arguments),t=this.getContext().getImageData(e.x,e.y,1,1).data;return new tt("rgb",[t[0]/255,t[1]/255,t[2]/255],t[3]/255)},setPixel:function(){var e=arguments,t=k.read(e),n=tt.read(e),i=n._convert("rgb"),r=n._alpha,s=this.getContext(!0),o=s.createImageData(1,1),a=o.data;a[0]=i[0]*255,a[1]=i[1]*255,a[2]=i[2]*255,a[3]=r!=null?r*255:255,s.putImageData(o,t.x,t.y)},clear:function(){var e=this._size;this.getContext(!0).clearRect(0,0,e.width+1,e.height+1)},createImageData:function(){var e=se.read(arguments);return this.getContext().createImageData(e.width,e.height)},getImageData:function(){var e=V.read(arguments);return e.isEmpty()&&(e=new V(this._size)),this.getContext().getImageData(e.x,e.y,e.width,e.height)},putImageData:function(e){var t=k.read(arguments,1);this.getContext(!0).putImageData(e,t.x,t.y)},setImageData:function(e){this.setSize(e),this.getContext(!0).putImageData(e,0,0)},_getBounds:function(e,t){var n=new V(this._size).setCenter(0,0);return e?e._transformBounds(n):n},_hitTestSelf:function(e){if(this._contains(e)){var t=this;return new Me("pixel",t,{offset:e.add(t._size.divide(2)).round(),color:{get:function(){return t.getPixel(this.offset)}}})}},_draw:function(e,t,n){var i=this.getElement();if(i&&i.width>0&&i.height>0){e.globalAlpha=j.clamp(this._opacity,0,1),this._setStyles(e,t,n);var r=this._smoothing,s=r==="off";Ye.setPrefixed(e,s?"imageSmoothingEnabled":"imageSmoothingQuality",s?!1:r),e.drawImage(i,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Ie=R.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,n){this._initialize(t,n!==M&&k.read(arguments,1))||this.setDefinition(t instanceof Be?t:new Be(t))},_equals:function(e){return this._definition===e._definition},copyContent:function(e){this.setDefinition(e._definition)},getDefinition:function(){return this._definition},setDefinition:function(e){this._definition=e,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(e,t){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(e),t)},_hitTestSelf:function(e,t,n){var i=t.extend({all:!1}),r=this._definition._item._hitTest(e,i,n);return r&&(r.item=this),r},_draw:function(e,t){this._definition._item.draw(e,t)}}),Be=I.extend({_class:"SymbolDefinition",initialize:function(t,n){this._id=ie.get(),this.project=De.project,t&&this.setItem(t,n)},_serialize:function(e,t){return t.add(this,function(){return I.serialize([this._class,this._item],e,!1,t)})},_changed:function(e){e&8&&R._clearBoundsCache(this),e&1&&this.project._changed(e)},getItem:function(){return this._item},setItem:function(e,t){e._symbol&&(e=e.clone()),this._item&&(this._item._symbol=null),this._item=e,e.remove(),e.setSelected(!1),t||e.setPosition(new k),e._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(e){return new Ie(this,e)},clone:function(){return new Be(this._item.clone(!1))},equals:function(e){return e===this||e&&this._item.equals(e._item)||!1}}),Me=I.extend({_class:"HitResult",initialize:function(t,n,i){this.type=t,this.item=n,i&&this.inject(i)},statics:{getOptions:function(e){var t=e&&I.read(e);return new I({type:null,tolerance:De.settings.hitTolerance,fill:!t,stroke:!t,segments:!t,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},t)}}}),Ce=I.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,n,i,r,s,o){var a=arguments.length,u,l,d,_;a>0&&(t==null||typeof t=="object"?a===1&&t&&"point"in t?(u=t.point,l=t.handleIn,d=t.handleOut,_=t.selection):(u=t,l=n,d=i,_=r):(u=[t,n],l=i!==M?[i,r]:null,d=s!==M?[s,o]:null)),new Ze(u,this,"_point"),new Ze(l,this,"_handleIn"),new Ze(d,this,"_handleOut"),_&&this.setSelection(_)},_serialize:function(e,t){var n=this._point,i=this._selection,r=i||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return i&&r.push(i),I.serialize(r,e,!0,t)},_changed:function(e){var t=this._path;if(t){var n=t._curves,i=this._index,r;n&&((!e||e===this._point||e===this._handleIn)&&(r=i>0?n[i-1]:t._closed?n[n.length-1]:null)&&r._changed(),(!e||e===this._point||e===this._handleOut)&&(r=n[i])&&r._changed()),t._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(k.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(k.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(k.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var e=this._handleIn,t=this._handleOut;return!e.isZero()&&!t.isZero()&&e.isCollinear(t)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(e){var t=this._selection,n=this._path;this._selection=e=e||0,n&&e!==t&&(n._updateSelection(this,t,e),n._changed(257))},_changeSelection:function(e,t){var n=this._selection;this.setSelection(t?n|e:n&~e)},isSelected:function(){return!!(this._selection&7)},setSelected:function(e){this._changeSelection(7,e)},getIndex:function(){return this._index!==M?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var e=this._path,t=this._index;return e?(t>0&&!e._closed&&t===e._segments.length-1&&t--,e.getCurves()[t]||null):null},getLocation:function(){var e=this.getCurve();return e?new ft(e,this===e._segment1?0:1):null},getNext:function(){var e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},smooth:function(e,t,n){var i=e||{},r=i.type,s=i.factor,o=this.getPrevious(),a=this.getNext(),u=(o||this)._point,l=this._point,d=(a||this)._point,_=u.getDistance(l),f=l.getDistance(d);if(!r||r==="catmull-rom"){var c=s===M?.5:s,S=Math.pow(_,c),v=S*S,P=Math.pow(f,c),g=P*P;if(!t&&o){var w=2*g+3*P*S+v,h=3*P*(P+S);this.setHandleIn(h!==0?new k((g*u._x+w*l._x-v*d._x)/h-l._x,(g*u._y+w*l._y-v*d._y)/h-l._y):new k)}if(!n&&a){var w=2*v+3*S*P+g,h=3*S*(S+P);this.setHandleOut(h!==0?new k((v*d._x+w*l._x-g*u._x)/h-l._x,(v*d._y+w*l._y-g*u._y)/h-l._y):new k)}}else if(r==="geometric"){if(o&&a){var p=u.subtract(d),x=s===M?.4:s,E=x*_/(_+f);t||this.setHandleIn(p.multiply(E)),n||this.setHandleOut(p.multiply(E-x))}}else throw new Error("Smoothing method '"+r+"' not supported.")},getPrevious:function(){var e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var e=this._path;return e&&this._index===e._segments.length-1||!1},reverse:function(){var e=this._handleIn,t=this._handleOut,n=e.clone();e.set(t),t.set(n)},reversed:function(){return new Ce(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Ce(this._point,this._handleIn,this._handleOut)},equals:function(e){return e===this||e&&this._class===e._class&&this._point.equals(e._point)&&this._handleIn.equals(e._handleIn)&&this._handleOut.equals(e._handleOut)||!1},toString:function(){var e=["point: "+this._point];return this._handleIn.isZero()||e.push("handleIn: "+this._handleIn),this._handleOut.isZero()||e.push("handleOut: "+this._handleOut),"{ "+e.join(", ")+" }"},transform:function(e){this._transformCoordinates(e,new Array(6),!0),this._changed()},interpolate:function(e,t,n){var i=1-n,r=n,s=e._point,o=t._point,a=e._handleIn,u=t._handleIn,l=t._handleOut,d=e._handleOut;this._point._set(i*s._x+r*o._x,i*s._y+r*o._y,!0),this._handleIn._set(i*a._x+r*u._x,i*a._y+r*u._y,!0),this._handleOut._set(i*d._x+r*l._x,i*d._y+r*l._y,!0),this._changed()},_transformCoordinates:function(e,t,n){var i=this._point,r=!n||!this._handleIn.isZero()?this._handleIn:null,s=!n||!this._handleOut.isZero()?this._handleOut:null,o=i._x,a=i._y,u=2;return t[0]=o,t[1]=a,r&&(t[u++]=r._x+o,t[u++]=r._y+a),s&&(t[u++]=s._x+o,t[u++]=s._y+a),e&&(e._transformCoordinates(t,t,u/2),o=t[0],a=t[1],n?(i._x=o,i._y=a,u=2,r&&(r._x=t[u++]-o,r._y=t[u++]-a),s&&(s._x=t[u++]-o,s._y=t[u++]-a)):(r||(t[u++]=o,t[u++]=a),s||(t[u++]=o,t[u++]=a))),t}}),Ze=k.extend({initialize:function(t,n,i){var r,s,o;if(!t)r=s=0;else if((r=t[0])!==M)s=t[1];else{var a=t;(r=a.x)===M&&(a=k.read(arguments),r=a.x),s=a.y,o=a.selected}this._x=r,this._y=s,this._owner=n,n[i]=this,o&&this.setSelected(!0)},_set:function(e,t){return this._x=e,this._y=t,this._owner._changed(this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner._changed(this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner._changed(this)},isZero:function(){var e=j.isZero;return e(this._x)&&e(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(e){this._owner._changeSelection(this._getSelection(),e)},_getSelection:function(){var e=this._owner;return this===e._point?1:this===e._handleIn?2:this===e._handleOut?4:0}}),we=I.extend({_class:"Curve",beans:!0,initialize:function(t,n,i,r,s,o,a,u){var l=arguments.length,d,_,f,c,S,v;l===3?(this._path=t,d=n,_=i):l?l===1?"segment1"in t?(d=new Ce(t.segment1),_=new Ce(t.segment2)):"point1"in t?(f=t.point1,S=t.handle1,v=t.handle2,c=t.point2):Array.isArray(t)&&(f=[t[0],t[1]],c=[t[6],t[7]],S=[t[2]-t[0],t[3]-t[1]],v=[t[4]-t[6],t[5]-t[7]]):l===2?(d=new Ce(t),_=new Ce(n)):l===4?(f=t,S=n,v=i,c=r):l===8&&(f=[t,n],c=[a,u],S=[i-t,r-n],v=[s-a,o-u]):(d=new Ce,_=new Ce),this._segment1=d||new Ce(f,null,S),this._segment2=_||new Ce(c,v,null)},_serialize:function(e,t){return I.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],e,!0,t)},_changed:function(){this._length=this._bounds=M},clone:function(){return new we(this._segment1,this._segment2)},toString:function(){var e=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||e.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||e.push("handle2: "+this._segment2._handleIn),e.push("point2: "+this._segment2._point),"{ "+e.join(", ")+" }"},classify:function(){return we.classify(this.getValues())},remove:function(){var e=!1;if(this._path){var t=this._segment2,n=t._handleOut;e=t.remove(),e&&this._segment1._handleOut.set(n)}return e},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(k.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(k.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(k.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(k.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var e=this._path;return e&&this._segment1._index===e._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(e){this.getPoint1().setSelected(e),this.getHandle1().setSelected(e),this.getHandle2().setSelected(e),this.getPoint2().setSelected(e)},getValues:function(e){return we.getValues(this._segment1,this._segment2,e)},getPoints:function(){for(var e=this.getValues(),t=[],n=0;n<8;n+=2)t.push(new k(e[n],e[n+1]));return t}},{getLength:function(){return this._length==null&&(this._length=we.getLength(this.getValues(),0,1)),this._length},getArea:function(){return we.getArea(this.getValues())},getLine:function(){return new re(this._segment1._point,this._segment2._point)},getPart:function(e,t){return new we(we.getPart(this.getValues(),e,t))},getPartLength:function(e,t){return we.getLength(this.getValues(),e,t)},divideAt:function(e){return this.divideAtTime(e&&e.curve===this?e.time:this.getTimeAt(e))},divideAtTime:function(e,t){var n=1e-8,i=1-n,r=null;if(e>=n&&e<=i){var s=we.subdivide(this.getValues(),e),o=s[0],a=s[1],u=t||this.hasHandles(),l=this._segment1,d=this._segment2,_=this._path;u&&(l._handleOut._set(o[2]-o[0],o[3]-o[1]),d._handleIn._set(a[4]-a[6],a[5]-a[7]));var f=o[6],c=o[7],S=new Ce(new k(f,c),u&&new k(o[4]-f,o[5]-c),u&&new k(a[2]-f,a[3]-c));_?(_.insert(l._index+1,S),r=this.getNext()):(this._segment2=S,this._changed(),r=new we(S,d))}return r},splitAt:function(e){var t=this._path;return t?t.splitAt(e):null},splitAtTime:function(e){return this.splitAt(this.getLocationAtTime(e))},divide:function(e,t){return this.divideAtTime(e===M?.5:t?e:this.getTimeAt(e))},split:function(e,t){return this.splitAtTime(e===M?.5:t?e:this.getTimeAt(e))},reversed:function(){return new we(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(e,t,n,i){var r=e._point,s=e._handleOut,o=t._handleIn,a=t._point,u=r.x,l=r.y,d=a.x,_=a.y,f=i?[u,l,u,l,d,_,d,_]:[u,l,u+s._x,l+s._y,d+o._x,_+o._y,d,_];return n&&n._transformCoordinates(f,f,4),f},subdivide:function(e,t){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];t===M&&(t=.5);var d=1-t,_=d*n+t*r,f=d*i+t*s,c=d*r+t*o,S=d*s+t*a,v=d*o+t*u,P=d*a+t*l,g=d*_+t*c,w=d*f+t*S,h=d*c+t*v,p=d*S+t*P,x=d*g+t*h,E=d*w+t*p;return[[n,i,_,f,g,w,x,E],[x,E,h,p,v,P,u,l]]},getMonoCurves:function(e,t){var n=[],i=t?0:1,r=e[i+0],s=e[i+2],o=e[i+4],a=e[i+6];if(r>=s==s>=o&&s>=o==o>=a||we.isStraight(e))n.push(e);else{var u=3*(s-o)-r+a,l=2*(r+o)-4*s,d=s-r,_=1e-8,f=1-_,c=[],S=j.solveQuadratic(u,l,d,c,_,f);if(!S)n.push(e);else{c.sort();var v=c[0],P=we.subdivide(e,v);n.push(P[0]),S>1&&(v=(c[1]-v)/(1-v),P=we.subdivide(P[1],v),n.push(P[0])),n.push(P[1])}}return n},solveCubic:function(e,t,n,i,r,s){var o=e[t],a=e[t+2],u=e[t+4],l=e[t+6],d=0;if(!(o<n&&l<n&&a<n&&u<n||o>n&&l>n&&a>n&&u>n)){var _=3*(a-o),f=3*(u-a)-_,c=l-o-_-f;d=j.solveCubic(c,f,_,o-n,i,r,s)}return d},getTimeOf:function(e,t){var n=new k(e[0],e[1]),i=new k(e[6],e[7]),r=1e-12,s=1e-7,o=t.isClose(n,r)?0:t.isClose(i,r)?1:null;if(o===null)for(var a=[t.x,t.y],u=[],l=0;l<2;l++)for(var d=we.solveCubic(e,l,a[l],u,0,1),_=0;_<d;_++){var f=u[_];if(t.isClose(we.getPoint(e,f),s))return f}return t.isClose(n,s)?0:t.isClose(i,s)?1:null},getNearestTime:function(e,t){if(we.isStraight(e)){var n=e[0],i=e[1],r=e[6],s=e[7],o=r-n,a=s-i,u=o*o+a*a;if(u===0)return 0;var l=((t.x-n)*o+(t.y-i)*a)/u;return l<1e-12?0:l>.999999999999?1:we.getTimeOf(e,new k(n+l*o,i+l*a))}var d=100,_=1/0,f=0;function c(P){if(P>=0&&P<=1){var g=t.getDistance(we.getPoint(e,P),!0);if(g<_)return _=g,f=P,!0}}for(var S=0;S<=d;S++)c(S/d);for(var v=1/(d*2);v>1e-8;)!c(f-v)&&!c(f+v)&&(v/=2);return f},getPart:function(e,t,n){var i=t>n;if(i){var r=t;t=n,n=r}return t>0&&(e=we.subdivide(e,t)[1]),n<1&&(e=we.subdivide(e,(n-t)/(1-t))[0]),i?[e[6],e[7],e[4],e[5],e[2],e[3],e[0],e[1]]:e},isFlatEnough:function(e,t){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],d=3*r-2*n-u,_=3*s-2*i-l,f=3*o-2*u-n,c=3*a-2*l-i;return Math.max(d*d,f*f)+Math.max(_*_,c*c)<=16*t*t},getArea:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],u=e[7];return 3*((u-n)*(i+s)-(a-t)*(r+o)+r*(t-s)-i*(n-o)+u*(s+t/3)-a*(o+n/3))/20},getBounds:function(e){for(var t=e.slice(0,2),n=t.slice(),i=[0,0],r=0;r<2;r++)we._addBounds(e[r],e[r+2],e[r+4],e[r+6],r,0,t,n,i);return new V(t[0],t[1],n[0]-t[0],n[1]-t[1])},_addBounds:function(e,t,n,i,r,s,o,a,u){function l(x,E){var y=x-E,z=x+E;y<o[r]&&(o[r]=y),z>a[r]&&(a[r]=z)}s/=2;var d=o[r]+s,_=a[r]-s;if(e<d||t<d||n<d||i<d||e>_||t>_||n>_||i>_)if(t<e!=t<i&&n<e!=n<i)l(e,0),l(i,0);else{var f=3*(t-n)-e+i,c=2*(e+n)-4*t,S=t-e,v=j.solveQuadratic(f,c,S,u),P=1e-8,g=1-P;l(i,0);for(var w=0;w<v;w++){var h=u[w],p=1-h;P<=h&&h<=g&&l(p*p*p*e+3*p*p*h*t+3*p*h*h*n+h*h*h*i,s)}}}}},I.each(["getBounds","getStrokeBounds","getHandleBounds"],function(e){this[e]=function(){this._bounds||(this._bounds={});var t=this._bounds[e];return t||(t=this._bounds[e]=Fe[e]([this._segment1,this._segment2],!1,this._path)),t.clone()}},{}),I.each({isStraight:function(e,t,n,i){if(t.isZero()&&n.isZero())return!0;var r=i.subtract(e);if(r.isZero())return!1;if(r.isCollinear(t)&&r.isCollinear(n)){var s=new re(e,i),o=1e-7;if(s.getDistance(e.add(t))<o&&s.getDistance(i.add(n))<o){var a=r.dot(r),u=r.dot(t)/a,l=r.dot(n)/a;return u>=0&&u<=1&&l<=0&&l>=-1}}return!1},isLinear:function(e,t,n,i){var r=i.subtract(e).divide(3);return t.equals(r)&&n.negate().equals(r)}},function(e,t){this[t]=function(n){var i=this._segment1,r=this._segment2;return e(i._point,i._handleOut,r._handleIn,r._point,n)},this.statics[t]=function(n,i){var r=n[0],s=n[1],o=n[6],a=n[7];return e(new k(r,s),new k(n[2]-r,n[3]-s),new k(n[4]-o,n[5]-a),new k(o,a),i)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(e){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(e||0)},isCollinear:function(e){return e&&this.isStraight()&&e.isStraight()&&this.getLine().isCollinear(e.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(e,t){return this.getLocationAtTime(t?e:this.getTimeAt(e))},getLocationAtTime:function(e){return e!=null&&e>=0&&e<=1?new ft(this,e):null},getTimeAt:function(e,t){return we.getTimeAt(this.getValues(),e,t)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var e=k.read(arguments);return e.isZero()?[]:we.getTimesWithTangent(this.getValues(),e)},getOffsetAtTime:function(e){return this.getPartLength(0,e)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(k.read(arguments)))},getOffsetOf:function(){var e=this.getLocationOf.apply(this,arguments);return e?e.getOffset():null},getTimeOf:function(){return we.getTimeOf(this.getValues(),k.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var e=k.read(arguments),t=this.getValues(),n=we.getNearestTime(t,e),i=we.getPoint(t,n);return new ft(this,n,i,null,e.getDistance(i))},getNearestPoint:function(){var e=this.getNearestLocation.apply(this,arguments);return e&&e.getPoint()}},new function(){var e=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return I.each(e,function(t){this[t+"At"]=function(n,i){var r=this.getValues();return we[t](r,i?n:we.getTimeAt(r,n))},this[t+"AtTime"]=function(n){return we[t](this.getValues(),n)}},{statics:{_evaluateMethods:e}})},new function(){function e(i){var r=i[0],s=i[1],o=i[2],a=i[3],u=i[4],l=i[5],d=i[6],_=i[7],f=9*(o-u)+3*(d-r),c=6*(r+u)-12*o,S=3*(o-r),v=9*(a-l)+3*(_-s),P=6*(s+l)-12*a,g=3*(a-s);return function(w){var h=(f*w+c)*w+S,p=(v*w+P)*w+g;return Math.sqrt(h*h+p*p)}}function t(i,r){return Math.max(2,Math.min(16,Math.ceil(Math.abs(r-i)*32)))}function n(i,r,s,o){if(r==null||r<0||r>1)return null;var a=i[0],u=i[1],l=i[2],d=i[3],_=i[4],f=i[5],c=i[6],S=i[7],v=j.isZero;v(l-a)&&v(d-u)&&(l=a,d=u),v(_-c)&&v(f-S)&&(_=c,f=S);var P=3*(l-a),g=3*(_-l)-P,w=c-a-P-g,h=3*(d-u),p=3*(f-d)-h,x=S-u-h-p,E,y;if(s===0)E=r===0?a:r===1?c:((w*r+g)*r+P)*r+a,y=r===0?u:r===1?S:((x*r+p)*r+h)*r+u;else{var z=1e-8,F=1-z;if(r<z?(E=P,y=h):r>F?(E=3*(c-_),y=3*(S-f)):(E=(3*w*r+2*g)*r+P,y=(3*x*r+2*p)*r+h),o){E===0&&y===0&&(r<z||r>F)&&(E=_-l,y=f-d);var q=Math.sqrt(E*E+y*y);q&&(E/=q,y/=q)}if(s===3){var _=6*w*r+2*g,f=6*x*r+2*p,X=Math.pow(E*E+y*y,3/2);E=X!==0?(E*f-y*_)/X:0,y=0}}return s===2?new k(y,-E):new k(E,y)}return{statics:{classify:function(i){var r=i[0],s=i[1],o=i[2],a=i[3],u=i[4],l=i[5],d=i[6],_=i[7],f=r*(_-l)+s*(u-d)+d*l-_*u,c=o*(s-_)+a*(d-r)+r*_-s*d,S=u*(a-s)+l*(r-o)+o*s-a*r,v=3*S,P=v-c,g=P-c+f,w=Math.sqrt(g*g+P*P+v*v),h=w!==0?1/w:0,p=j.isZero,x="serpentine";g*=h,P*=h,v*=h;function E(q,X,N){var Z=X!==M,J=Z&&X>0&&X<1,ee=Z&&N>0&&N<1;return Z&&(!(J||ee)||q==="loop"&&!(J&&ee))&&(q="arch",J=ee=!1),{type:q,roots:J||ee?J&&ee?X<N?[X,N]:[N,X]:[J?X:N]:null}}if(p(g))return p(P)?E(p(v)?"line":"quadratic"):E(x,v/(3*P));var y=3*P*P-4*g*v;if(p(y))return E("cusp",P/(2*g));var z=y>0?Math.sqrt(y/3):Math.sqrt(-y),F=2*g;return E(y>0?x:"loop",(P+z)/F,(P-z)/F)},getLength:function(i,r,s,o){if(r===M&&(r=0),s===M&&(s=1),we.isStraight(i)){var a=i;s<1&&(a=we.subdivide(a,s)[0],r/=s),r>0&&(a=we.subdivide(a,r)[1]);var u=a[6]-a[0],l=a[7]-a[1];return Math.sqrt(u*u+l*l)}return j.integrate(o||e(i),r,s,t(r,s))},getTimeAt:function(i,r,s){if(s===M&&(s=r<0?1:0),r===0)return s;var o=Math.abs,a=1e-12,u=r>0,l=u?s:0,d=u?1:s,_=e(i),f=we.getLength(i,l,d,_),c=o(r)-f;if(o(c)<a)return u?d:l;if(c>a)return null;var S=r/f,v=0;function P(g){return v+=j.integrate(_,s,g,t(s,g)),s=g,v-r}return j.findRoot(P,_,s+S,l,d,32,1e-12)},getPoint:function(i,r){return n(i,r,0,!1)},getTangent:function(i,r){return n(i,r,1,!0)},getWeightedTangent:function(i,r){return n(i,r,1,!1)},getNormal:function(i,r){return n(i,r,2,!0)},getWeightedNormal:function(i,r){return n(i,r,2,!1)},getCurvature:function(i,r){return n(i,r,3,!1).x},getPeaks:function(i){var r=i[0],s=i[1],o=i[2],a=i[3],u=i[4],l=i[5],d=i[6],_=i[7],f=-r+3*o-3*u+d,c=3*r-6*o+3*u,S=-3*r+3*o,v=-s+3*a-3*l+_,P=3*s-6*a+3*l,g=-3*s+3*a,w=1e-8,h=1-w,p=[];return j.solveCubic(9*(f*f+v*v),9*(f*c+P*v),2*(c*c+P*P)+3*(S*f+g*v),S*c+P*g,p,w,h),p.sort()}}}},new function(){function e(c,S,v,P,g,w,h){var p=!h&&v.getPrevious()===g,x=!h&&v!==g&&v.getNext()===g,E=1e-8,y=1-E;if(P!==null&&P>=(p?E:0)&&P<=(x?y:1)&&w!==null&&w>=(x?E:0)&&w<=(p?y:1)){var z=new ft(v,P,null,h),F=new ft(g,w,null,h);z._intersection=F,F._intersection=z,(!S||S(z))&&ft.insert(c,z,!0)}}function t(c,S,v,P,g,w,h,p,x,E,y,z,F){if(++x>=4096||++p>=40)return x;var q=1e-9,X=S[0],N=S[1],Z=S[6],J=S[7],ee=re.getSignedDistance,te=ee(X,N,Z,J,S[2],S[3]),oe=ee(X,N,Z,J,S[4],S[5]),_e=te*oe>0?3/4:4/9,me=_e*Math.min(0,te,oe),ye=_e*Math.max(0,te,oe),Se=ee(X,N,Z,J,c[0],c[1]),ce=ee(X,N,Z,J,c[2],c[3]),de=ee(X,N,Z,J,c[4],c[5]),be=ee(X,N,Z,J,c[6],c[7]),xe=n(Se,ce,de,be),Pe=xe[0],Te=xe[1],Ee,Oe;if(te===0&&oe===0&&Se===0&&ce===0&&de===0&&be===0||(Ee=i(Pe,Te,me,ye))==null||(Oe=i(Pe.reverse(),Te.reverse(),me,ye))==null)return x;var Re=E+(y-E)*Ee,Le=E+(y-E)*Oe;if(Math.max(F-z,Le-Re)<q){var rt=(Re+Le)/2,st=(z+F)/2;e(g,w,h?P:v,h?st:rt,h?v:P,h?rt:st)}else{c=we.getPart(c,Ee,Oe);var lt=F-z;if(Oe-Ee>.8)if(Le-Re>lt){var Qe=we.subdivide(c,.5),rt=(Re+Le)/2;x=t(S,Qe[0],P,v,g,w,!h,p,x,z,F,Re,rt),x=t(S,Qe[1],P,v,g,w,!h,p,x,z,F,rt,Le)}else{var Qe=we.subdivide(S,.5),st=(z+F)/2;x=t(Qe[0],c,P,v,g,w,!h,p,x,z,st,Re,Le),x=t(Qe[1],c,P,v,g,w,!h,p,x,st,F,Re,Le)}else lt===0||lt>=q?x=t(S,c,P,v,g,w,!h,p,x,z,F,Re,Le):x=t(c,S,v,P,g,w,h,p,x,Re,Le,z,F)}return x}function n(c,S,v,P){var g=[0,c],w=[1/3,S],h=[2/3,v],p=[1,P],x=S-(2*c+P)/3,E=v-(c+2*P)/3,y;if(x*E<0)y=[[g,w,p],[g,h,p]];else{var z=x/E;y=[z>=2?[g,w,p]:z<=.5?[g,h,p]:[g,w,h,p],[g,p]]}return(x||E)<0?y.reverse():y}function i(c,S,v,P){return c[0][1]<v?r(c,!0,v):S[0][1]>P?r(S,!1,P):c[0][0]}function r(c,S,v){for(var P=c[0][0],g=c[0][1],w=1,h=c.length;w<h;w++){var p=c[w][0],x=c[w][1];if(S?x>=v:x<=v)return x===v?p:P+(v-g)*(p-P)/(x-g);P=p,g=x}return null}function s(c,S,v,P,g){var w=j.isZero;if(w(P)&&w(g)){var h=we.getTimeOf(c,new k(S,v));return h===null?[]:[h]}for(var p=Math.atan2(-g,P),x=Math.sin(p),E=Math.cos(p),y=[],z=[],F=0;F<8;F+=2){var q=c[F]-S,X=c[F+1]-v;y.push(q*E-X*x,q*x+X*E)}return we.solveCubic(y,1,0,z,0,1),z}function o(c,S,v,P,g,w,h){for(var p=S[0],x=S[1],E=S[6],y=S[7],z=s(c,p,x,E-p,y-x),F=0,q=z.length;F<q;F++){var X=z[F],N=we.getPoint(c,X),Z=we.getTimeOf(S,N);Z!==null&&e(g,w,h?P:v,h?Z:X,h?v:P,h?X:Z)}}function a(c,S,v,P,g,w){var h=re.intersect(c[0],c[1],c[6],c[7],S[0],S[1],S[6],S[7]);h&&e(g,w,v,we.getTimeOf(c,h),P,we.getTimeOf(S,h))}function u(c,S,v,P,g,w){var h=1e-12,p=Math.min,x=Math.max;if(x(c[0],c[2],c[4],c[6])+h>p(S[0],S[2],S[4],S[6])&&p(c[0],c[2],c[4],c[6])-h<x(S[0],S[2],S[4],S[6])&&x(c[1],c[3],c[5],c[7])+h>p(S[1],S[3],S[5],S[7])&&p(c[1],c[3],c[5],c[7])-h<x(S[1],S[3],S[5],S[7])){var E=_(c,S);if(E)for(var y=0;y<2;y++){var z=E[y];e(g,w,v,z[0],P,z[1],!0)}else{var F=we.isStraight(c),q=we.isStraight(S),X=F&&q,N=F&&!q,Z=g.length;if((X?a:F||q?o:t)(N?S:c,N?c:S,N?P:v,N?v:P,g,w,N,0,0,0,1,0,1),!X||g.length===Z)for(var y=0;y<4;y++){var J=y>>1,ee=y&1,te=J*6,oe=ee*6,_e=new k(c[te],c[te+1]),me=new k(S[oe],S[oe+1]);_e.isClose(me,h)&&e(g,w,v,J,P,ee)}}}return g}function l(c,S,v,P){var g=we.classify(c);if(g.type==="loop"){var w=g.roots;e(v,P,S,w[0],S,w[1])}return v}function d(c,S,v,P,g,w){var h=1e-7,p=!S;p&&(S=c);for(var x=c.length,E=S.length,y=new Array(x),z=p?y:new Array(E),F=[],q=0;q<x;q++)y[q]=c[q].getValues(P);if(!p)for(var q=0;q<E;q++)z[q]=S[q].getValues(g);for(var X=L.findCurveBoundsCollisions(y,z,h),N=0;N<x;N++){var Z=c[N],J=y[N];p&&l(J,Z,F,v);var ee=X[N];if(ee)for(var te=0;te<ee.length;te++){if(w&&F.length)return F;var oe=ee[te];if(!p||oe>N){var _e=S[oe],me=z[oe];u(J,me,Z,_e,F,v)}}}return F}function _(c,S){function v(be){var xe=be[6]-be[0],Pe=be[7]-be[1];return xe*xe+Pe*Pe}var P=Math.abs,g=re.getDistance,w=1e-8,h=1e-7,p=we.isStraight(c),x=we.isStraight(S),E=p&&x,y=v(c)<v(S),z=y?S:c,F=y?c:S,q=z[0],X=z[1],N=z[6]-q,Z=z[7]-X;if(g(q,X,N,Z,F[0],F[1],!0)<h&&g(q,X,N,Z,F[6],F[7],!0)<h)!E&&g(q,X,N,Z,z[2],z[3],!0)<h&&g(q,X,N,Z,z[4],z[5],!0)<h&&g(q,X,N,Z,F[2],F[3],!0)<h&&g(q,X,N,Z,F[4],F[5],!0)<h&&(p=x=E=!0);else if(E)return null;if(p^x)return null;for(var J=[c,S],ee=[],te=0;te<4&&ee.length<2;te++){var oe=te&1,_e=oe^1,me=te>>1,ye=we.getTimeOf(J[oe],new k(J[_e][me?6:0],J[_e][me?7:1]));if(ye!=null){var Se=oe?[me,ye]:[ye,me];(!ee.length||P(Se[0]-ee[0][0])>w&&P(Se[1]-ee[0][1])>w)&&ee.push(Se)}if(te>2&&!ee.length)break}if(ee.length!==2)ee=null;else if(!E){var ce=we.getPart(c,ee[0][0],ee[1][0]),de=we.getPart(S,ee[0][1],ee[1][1]);(P(de[2]-ce[2])>h||P(de[3]-ce[3])>h||P(de[4]-ce[4])>h||P(de[5]-ce[5])>h)&&(ee=null)}return ee}function f(c,S){var v=c[0],P=c[1],g=c[2],w=c[3],h=c[4],p=c[5],x=c[6],E=c[7],y=S.normalize(),z=y.x,F=y.y,q=3*x-9*h+9*g-3*v,X=3*E-9*p+9*w-3*P,N=6*h-12*g+6*v,Z=6*p-12*w+6*P,J=3*g-3*v,ee=3*w-3*P,te=2*q*F-2*X*z,oe=[];if(Math.abs(te)<j.CURVETIME_EPSILON){var _e=q*ee-X*J,te=q*Z-X*N;if(te!=0){var me=-_e/te;me>=0&&me<=1&&oe.push(me)}}else{var ye=(N*N-4*q*J)*F*F+(-2*N*Z+4*X*J+4*q*ee)*z*F+(Z*Z-4*X*ee)*z*z,Se=N*F-Z*z;if(ye>=0&&te!=0){var ce=Math.sqrt(ye),de=-(Se+ce)/te,be=(-Se+ce)/te;de>=0&&de<=1&&oe.push(de),be>=0&&be<=1&&oe.push(be)}}return oe}return{getIntersections:function(c){var S=this.getValues(),v=c&&c!==this&&c.getValues();return v?u(S,v,this,c,[]):l(S,this,[])},statics:{getOverlaps:_,getIntersections:d,getCurveLineIntersections:s,getTimesWithTangent:f}}}),ft=I.extend({_class:"CurveLocation",initialize:function(t,n,i,r,s){if(n>=.99999999){var o=t.getNext();o&&(n=0,t=o)}this._setCurve(t),this._time=n,this._point=i||t.getPointAtTime(n),this._overlap=r,this._distance=s,this._intersection=this._next=this._previous=null},_setPath:function(e){this._path=e,this._version=e?e._version:0},_setCurve:function(e){this._setPath(e._path),this._curve=e,this._segment=null,this._segment1=e._segment1,this._segment2=e._segment2},_setSegment:function(e){var t=e.getCurve();t?this._setCurve(t):(this._setPath(e._path),this._segment1=e,this._segment2=null),this._segment=e,this._time=e===this._segment1?0:1,this._point=e._point.clone()},getSegment:function(){var e=this._segment;if(!e){var t=this.getCurve(),n=this.getTime();n===0?e=t._segment1:n===1?e=t._segment2:n!=null&&(e=t.getPartLength(0,n)<t.getPartLength(n,1)?t._segment1:t._segment2),this._segment=e}return e},getCurve:function(){var e=this._path,t=this;e&&e._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function n(i){var r=i&&i.getCurve();if(r&&(t._time=r.getTimeOf(t._point))!=null)return t._setCurve(r),r}return this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var e=this.getCurve();return e&&e._path},getIndex:function(){var e=this.getCurve();return e&&e.getIndex()},getTime:function(){var e=this.getCurve(),t=this._time;return e&&t==null?this._time=e.getTimeOf(this._point):t},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var e=this._offset;if(e==null){e=0;var t=this.getPath(),n=this.getIndex();if(t&&n!=null)for(var i=t.getCurves(),r=0;r<n;r++)e+=i[r].getLength();this._offset=e+=this.getCurveOffset()}return e},getCurveOffset:function(){var e=this._curveOffset;if(e==null){var t=this.getCurve(),n=this.getTime();this._curveOffset=e=n!=null&&t&&t.getPartLength(0,n)}return e},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var e=this.getCurve(),t=e&&e.divideAtTime(this.getTime());return t&&this._setSegment(t._segment1),t},split:function(){var e=this.getCurve(),t=e._path,n=e&&e.splitAtTime(this.getTime());return n&&this._setSegment(t.getLastSegment()),n},equals:function(e,t){var n=this===e;if(!n&&e instanceof ft){var i=this.getCurve(),r=e.getCurve(),s=i._path,o=r._path;if(s===o){var a=Math.abs,u=1e-7,l=a(this.getOffset()-e.getOffset()),d=!t&&this._intersection,_=!t&&e._intersection;n=(l<u||s&&a(s.getLength()-l)<u)&&(!d&&!_||d&&_&&d.equals(_,!0))}}return n},toString:function(){var e=[],t=this.getPoint(),n=G.instance;t&&e.push("point: "+t);var i=this.getIndex();i!=null&&e.push("index: "+i);var r=this.getTime();return r!=null&&e.push("time: "+n.number(r)),this._distance!=null&&e.push("distance: "+n.number(this._distance)),"{ "+e.join(", ")+" }"},isTouching:function(){var e=this._intersection;if(e&&this.getTangent().isCollinear(e.getTangent())){var t=this.getCurve(),n=e.getCurve();return!(t.isStraight()&&n.isStraight()&&t.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var e=this._intersection;if(!e)return!1;var t=this.getTime(),n=e.getTime(),i=1e-8,r=1-i,s=t>=i&&t<=r,o=n>=i&&n<=r;if(s&&o)return!this.isTouching();var a=this.getCurve(),u=a&&t<i?a.getPrevious():a,l=e.getCurve(),d=l&&n<i?l.getPrevious():l;if(t>r&&(a=a.getNext()),n>r&&(l=l.getNext()),!u||!a||!d||!l)return!1;var _=[];function f(z,F){var q=z.getValues(),X=we.classify(q).roots||we.getPeaks(q),N=X.length,Z=we.getLength(q,F&&N?X[N-1]:0,!F&&N?X[0]:1);_.push(N?Z:Z/32)}function c(z,F,q){return F<q?z>F&&z<q:z>F||z<q}s||(f(u,!0),f(a,!1)),o||(f(d,!0),f(l,!1));var S=this.getPoint(),v=Math.min.apply(Math,_),P=s?a.getTangentAtTime(t):a.getPointAt(v).subtract(S),g=s?P.negate():u.getPointAt(-v).subtract(S),w=o?l.getTangentAtTime(n):l.getPointAt(v).subtract(S),h=o?w.negate():d.getPointAt(-v).subtract(S),p=g.getAngle(),x=P.getAngle(),E=h.getAngle(),y=w.getAngle();return!!(s?c(p,E,y)^c(x,E,y)&&c(p,y,E)^c(x,y,E):c(E,p,x)^c(y,p,x)&&c(E,x,p)^c(y,x,p))},hasOverlap:function(){return!!this._overlap}},I.each(we._evaluateMethods,function(e){var t=e+"At";this[e]=function(){var n=this.getCurve(),i=this.getTime();return i!=null&&n&&n[t](i,!0)}},{preserve:!0}),new function(){function e(t,n,i){var r=t.length,s=0,o=r-1;function a(S,v){for(var P=S+v;P>=-1&&P<=r;P+=v){var g=t[(P%r+r)%r];if(!n.getPoint().isClose(g.getPoint(),1e-7))break;if(n.equals(g))return g}return null}for(;s<=o;){var u=s+o>>>1,l=t[u],d;if(i&&(d=n.equals(l)?l:a(u,-1)||a(u,1)))return n._overlap&&(d._overlap=d._intersection._overlap=!0),d;var _=n.getPath(),f=l.getPath(),c=_!==f?_._id-f._id:n.getIndex()+n.getTime()-(l.getIndex()+l.getTime());c<0?o=u-1:s=u+1}return t.splice(s,0,n),n}return{statics:{insert:e,expand:function(t){for(var n=t.slice(),i=t.length-1;i>=0;i--)e(n,t[i]._intersection,!1);return n}}}}),vt=R.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(e){var t,n,i;if(I.isPlainObject(e)?(n=e.segments,t=e.pathData):Array.isArray(e)?n=e:typeof e=="string"&&(t=e),n){var r=n[0];i=r&&Array.isArray(r[0])}else t&&(i=(t.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(t));var s=i?dt:Fe;return new s(e)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(e){this.isClockwise()!=(e=!!e)&&this.reverse()},setPathData:function(e){var t=e&&e.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),n,i=!1,r,s,o=new k,a=new k;function u(h,p){var x=+n[h];return i&&(x+=o[p]),x}function l(h){return new k(u(h,"x"),u(h+1,"y"))}this.clear();for(var d=0,_=t&&t.length;d<_;d++){var f=t[d],c=f[0],S=c.toLowerCase();n=f.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var v=n&&n.length;switch(i=c===S,r==="z"&&!/[mz]/.test(S)&&this.moveTo(o),S){case"m":case"l":for(var P=S==="m",g=0;g<v;g+=2)this[P?"moveTo":"lineTo"](o=l(g)),P&&(a=o,P=!1);s=o;break;case"h":case"v":var w=S==="h"?"x":"y";o=o.clone();for(var g=0;g<v;g++)o[w]=u(g,w),this.lineTo(o);s=o;break;case"c":for(var g=0;g<v;g+=6)this.cubicCurveTo(l(g),s=l(g+2),o=l(g+4));break;case"s":for(var g=0;g<v;g+=4)this.cubicCurveTo(/[cs]/.test(r)?o.multiply(2).subtract(s):o,s=l(g),o=l(g+2)),r=S;break;case"q":for(var g=0;g<v;g+=4)this.quadraticCurveTo(s=l(g),o=l(g+2));break;case"t":for(var g=0;g<v;g+=2)this.quadraticCurveTo(s=/[qt]/.test(r)?o.multiply(2).subtract(s):o,o=l(g)),r=S;break;case"a":for(var g=0;g<v;g+=7)this.arcTo(o=l(g+5),new se(+n[g],+n[g+1]),+n[g+2],+n[g+4],+n[g+3]);break;case"z":this.closePath(1e-12),o=a;break}r=S}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(e){var t=e.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(e):{};return t.onPath||!!(this.getFillRule()==="evenodd"?t.windingL&1||t.windingR&1:t.winding)},getIntersections:function(e,t,n,i){var r=this===e||!e,s=this._matrix._orNullIfIdentity(),o=r?s:(n||e._matrix)._orNullIfIdentity();return r||this.getBounds(s).intersects(e.getBounds(o),1e-12)?we.getIntersections(this.getCurves(),!r&&e.getCurves(),t,s,o,i):[]},getCrossings:function(e){return this.getIntersections(e,function(t){return t.isCrossing()})},getNearestLocation:function(){for(var e=k.read(arguments),t=this.getCurves(),n=1/0,i=null,r=0,s=t.length;r<s;r++){var o=t[r].getNearestLocation(e);o._distance<n&&(n=o._distance,i=o)}return i},getNearestPoint:function(){var e=this.getNearestLocation.apply(this,arguments);return e&&e.getPoint()},interpolate:function(e,t,n){var i=!this._children,r=i?"_segments":"_children",s=e[r],o=t[r],a=this[r];if(!s||!o||s.length!==o.length)throw new Error("Invalid operands in interpolate() call: "+e+", "+t);var u=a.length,l=o.length;if(u<l)for(var d=i?Ce:Fe,_=u;_<l;_++)this.add(new d);else u>l&&this[i?"removeSegments":"removeChildren"](l,u);for(var _=0;_<l;_++)a[_].interpolate(s[_],o[_],n);i&&(this.setClosed(e._closed),this._changed(9))},compare:function(e){var t=!1;if(e){var n=this._children||[this],i=e._children?e._children.slice():[e],r=n.length,s=i.length,o=[],a=0;t=!0;for(var u=L.findItemBoundsCollisions(n,i,j.GEOMETRIC_EPSILON),l=r-1;l>=0&&t;l--){var d=n[l];t=!1;var _=u[l];if(_)for(var f=_.length-1;f>=0&&!t;f--)d.compare(i[_[f]])&&(o[_[f]]||(o[_[f]]=!0,a++),t=!0)}t=t&&a===s}return t}}),Fe=vt.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var n=arguments,i=Array.isArray(t)?typeof t[0]=="object"?t:n:t&&t.size===M&&(t.x!==M||t.point!==M)?n:null;i&&i.length>0?this.setSegments(i):(this._curves=M,this._segmentSelection=0,!i&&typeof t=="string"&&(this.setPathData(t),t=null)),this._initialize(!i&&t)},_equals:function(e){return this._closed===e._closed&&I.equals(this._segments,e._segments)},copyContent:function(e){this.setSegments(e._segments),this._closed=e._closed},_changed:function e(t){if(e.base.call(this,t),t&8){if(this._length=this._area=M,t&32)this._version++;else if(this._curves)for(var n=0,i=this._curves.length;n<i;n++)this._curves[n]._changed()}else t&64&&(this._bounds=M)},getStyle:function(){var e=this._parent;return(e instanceof dt?e:this)._style},getSegments:function(){return this._segments},setSegments:function(e){var t=this.isFullySelected(),n=e&&e.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=M,n){var i=e[n-1];typeof i=="boolean"&&(this.setClosed(i),n--),this._add(Ce.readList(e,0,{},n))}t&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var e=this._curves,t=this._segments;if(!e){var n=this._countCurves();e=this._curves=new Array(n);for(var i=0;i<n;i++)e[i]=new we(this,t[i],t[i+1]||t[0])}return e},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var e=this.getCurves();return e[e.length-1]},isClosed:function(){return this._closed},setClosed:function(e){if(this._closed!=(e=!!e)){if(this._closed=e,this._curves){var t=this._curves.length=this._countCurves();e&&(this._curves[t-1]=new we(this,this._segments[t-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(e,t){var n=this._segments,i=n.length,r=new G(t),s=new Array(6),o=!0,a,u,l,d,_,f,c,S,v=[];function P(w,h){if(w._transformCoordinates(e,s),a=s[0],u=s[1],o)v.push("M"+r.pair(a,u)),o=!1;else if(_=s[2],f=s[3],_===a&&f===u&&c===l&&S===d){if(!h){var p=a-l,x=u-d;v.push(p===0?"v"+r.number(x):x===0?"h"+r.number(p):"l"+r.pair(p,x))}}else v.push("c"+r.pair(c-l,S-d)+" "+r.pair(_-l,f-d)+" "+r.pair(a-l,u-d));l=a,d=u,c=s[4],S=s[5]}if(!i)return"";for(var g=0;g<i;g++)P(n[g]);return this._closed&&i>0&&(P(n[0],!0),v.push("z")),v.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(e){for(var t=this._segments,n=new Array(6),i=0,r=t.length;i<r;i++)t[i]._transformCoordinates(e,n,!0);return!0},_add:function(e,o){for(var n=this._segments,i=this._curves,r=e.length,s=o==null,o=s?n.length:o,a=0;a<r;a++){var u=e[a];u._path&&(u=e[a]=u.clone()),u._path=this,u._index=o+a,u._selection&&this._updateSelection(u,0,u._selection)}if(s)I.push(n,e);else{n.splice.apply(n,[o,0].concat(e));for(var a=o+r,l=n.length;a<l;a++)n[a]._index=a}if(i){var d=this._countCurves(),_=o>0&&o+r-1===d?o-1:o,f=_,c=Math.min(_+r,d);e._curves&&(i.splice.apply(i,[_,0].concat(e._curves)),f+=e._curves.length);for(var a=f;a<c;a++)i.splice(a,0,new we(this,null,null));this._adjustCurves(_,c)}return this._changed(41),e},_adjustCurves:function(e,t){for(var n=this._segments,i=this._curves,r,s=e;s<t;s++)r=i[s],r._path=this,r._segment1=n[s],r._segment2=n[s+1]||n[0],r._changed();(r=i[this._closed&&!e?n.length-1:e-1])&&(r._segment2=n[e]||n[0],r._changed()),(r=i[t])&&(r._segment1=n[t],r._changed())},_countCurves:function(){var e=this._segments.length;return!this._closed&&e>0?e-1:e},add:function(e){var t=arguments;return t.length>1&&typeof e!="number"?this._add(Ce.readList(t)):this._add([Ce.read(t)])[0]},insert:function(e,t){var n=arguments;return n.length>2&&typeof t!="number"?this._add(Ce.readList(n,1),e):this._add([Ce.read(n,1)],e)[0]},addSegment:function(){return this._add([Ce.read(arguments)])[0]},insertSegment:function(e){return this._add([Ce.read(arguments,1)],e)[0]},addSegments:function(e){return this._add(Ce.readList(e))},insertSegments:function(e,t){return this._add(Ce.readList(t),e)},removeSegment:function(e){return this.removeSegments(e,e+1)[0]||null},removeSegments:function(e,t,n){e=e||0,t=I.pick(t,this._segments.length);var i=this._segments,r=this._curves,s=i.length,o=i.splice(e,t-e),a=o.length;if(!a)return o;for(var u=0;u<a;u++){var l=o[u];l._selection&&this._updateSelection(l,l._selection,0),l._index=l._path=null}for(var u=e,d=i.length;u<d;u++)i[u]._index=u;if(r){for(var _=e>0&&t===s+(this._closed?1:0)?e-1:e,r=r.splice(_,a),u=r.length-1;u>=0;u--)r[u]._path=null;n&&(o._curves=r.slice(1)),this._adjustCurves(_,_)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var e=this._segments,t=0,n=e.length;t<n;t++)if(e[t].hasHandles())return!0;return!1},clearHandles:function(){for(var e=this._segments,t=0,n=e.length;t<n;t++)e[t].clearHandles()},getLength:function(){if(this._length==null){for(var e=this.getCurves(),t=0,n=0,i=e.length;n<i;n++)t+=e[n].getLength();this._length=t}return this._length},getArea:function(){var e=this._area;if(e==null){var t=this._segments,n=this._closed;e=0;for(var i=0,r=t.length;i<r;i++){var s=i+1===r;e+=we.getArea(we.getValues(t[i],t[s?0:i+1],null,s&&!n))}this._area=e}return e},isFullySelected:function(){var e=this._segments.length;return this.isSelected()&&e>0&&this._segmentSelection===e*7},setFullySelected:function(e){e&&this._selectSegments(!0),this.setSelected(e)},setSelection:function e(t){t&1||this._selectSegments(!1),e.base.call(this,t)},_selectSegments:function(e){var t=this._segments,n=t.length,i=e?7:0;this._segmentSelection=i*n;for(var r=0;r<n;r++)t[r]._selection=i},_updateSelection:function(e,t,n){e._selection=n;var i=this._segmentSelection+=n-t;i>0&&this.setSelected(!0)},divideAt:function(e){var t=this.getLocationAt(e),n;return t&&(n=t.getCurve().divideAt(t.getCurveOffset()))?n._segment1:null},splitAt:function(e){var t=this.getLocationAt(e),n=t&&t.index,i=t&&t.time,r=1e-8,s=1-r;i>s&&(n++,i=0);var o=this.getCurves();if(n>=0&&n<o.length){i>=r&&o[n++].divideAtTime(i);var a=this.removeSegments(n,this._segments.length,!0),u;return this._closed?(this.setClosed(!1),u=this):(u=new Fe(R.NO_INSERT),u.insertAbove(this),u.copyAttributes(this)),u._add(a,0),this.addSegment(a[0]),u}return null},split:function(e,t){var n,i=t===M?e:(n=this.getCurves()[e])&&n.getLocationAtTime(t);return i!=null?this.splitAt(i):null},join:function(e,t){var n=t||0;if(e&&e!==this){var i=e._segments,r=this.getLastSegment(),s=e.getLastSegment();if(!s)return this;r&&r._point.isClose(s._point,n)&&e.reverse();var o=e.getFirstSegment();if(r&&r._point.isClose(o._point,n))r.setHandleOut(o._handleOut),this._add(i.slice(1));else{var a=this.getFirstSegment();a&&a._point.isClose(o._point,n)&&e.reverse(),s=e.getLastSegment(),a&&a._point.isClose(s._point,n)?(a.setHandleIn(s._handleIn),this._add(i.slice(0,i.length-1),0)):this._add(i.slice())}e._closed&&this._add([i[0]]),e.remove()}var u=this.getFirstSegment(),l=this.getLastSegment();return u!==l&&u._point.isClose(l._point,n)&&(u.setHandleIn(l._handleIn),l.remove(),this.setClosed(!0)),this},reduce:function(e){for(var t=this.getCurves(),n=e&&e.simplify,i=n?1e-7:0,r=t.length-1;r>=0;r--){var s=t[r];!s.hasHandles()&&(!s.hasLength(i)||n&&s.isCollinear(s.getNext()))&&s.remove()}return this},reverse:function(){this._segments.reverse();for(var e=0,t=this._segments.length;e<t;e++){var n=this._segments[e],i=n._handleIn;n._handleIn=n._handleOut,n._handleOut=i,n._index=e}this._curves=null,this._changed(9)},flatten:function(e){for(var t=new dn(this,e||.25,256,!0),n=t.parts,i=n.length,r=[],s=0;s<i;s++)r.push(new Ce(n[s].curve.slice(0,2)));!this._closed&&i>0&&r.push(new Ce(n[i-1].curve.slice(6))),this.setSegments(r)},simplify:function(e){var t=new Wi(this).fit(e||2.5);return t&&this.setSegments(t),!!t},smooth:function(e){var t=this,n=e||{},i=n.type||"asymmetric",r=this._segments,s=r.length,o=this._closed;function a(Pe,Te){var Ee=Pe&&Pe.index;if(Ee!=null){var Oe=Pe.path;if(Oe&&Oe!==t)throw new Error(Pe._class+" "+Ee+" of "+Oe+" is not part of "+t);Te&&Pe instanceof we&&Ee++}else Ee=typeof Pe=="number"?Pe:Te;return Math.min(Ee<0&&o?Ee%s:Ee<0?Ee+s:Ee,s-1)}var u=o&&n.from===M&&n.to===M,l=a(n.from,0),d=a(n.to,s-1);if(l>d)if(o)l-=s;else{var _=l;l=d,d=_}if(/^(?:asymmetric|continuous)$/.test(i)){var f=i==="asymmetric",c=Math.min,S=d-l+1,v=S-1,P=u?c(S,4):1,g=P,w=P,h=[];if(o||(g=c(1,l),w=c(1,s-d-1)),v+=g+w,v<=1)return;for(var p=0,x=l-g;p<=v;p++,x++)h[p]=r[(x<0?x+s:x)%s]._point;for(var E=h[0]._x+2*h[1]._x,y=h[0]._y+2*h[1]._y,z=2,F=v-1,q=[E],X=[y],N=[z],Z=[],J=[],p=1;p<v;p++){var ee=p<F,te=ee||f?1:2,oe=ee?4:f?2:7,_e=ee?4:f?3:8,me=ee?2:f?0:1,ye=te/z;z=N[p]=oe-ye,E=q[p]=_e*h[p]._x+me*h[p+1]._x-ye*E,y=X[p]=_e*h[p]._y+me*h[p+1]._y-ye*y}Z[F]=q[F]/N[F],J[F]=X[F]/N[F];for(var p=v-2;p>=0;p--)Z[p]=(q[p]-Z[p+1])/N[p],J[p]=(X[p]-J[p+1])/N[p];Z[v]=(3*h[v]._x-Z[F])/2,J[v]=(3*h[v]._y-J[F])/2;for(var p=g,Se=v-w,x=l;p<=Se;p++,x++){var ce=r[x<0?x+s:x],de=ce._point,be=Z[p]-de._x,xe=J[p]-de._y;(u||p<Se)&&ce.setHandleOut(be,xe),(u||p>g)&&ce.setHandleIn(-be,-xe)}}else for(var p=l;p<=d;p++)r[p<0?p+s:p].smooth(n,!u&&p===l,!u&&p===d)},toShape:function(e){if(!this._closed)return null;var t=this._segments,n,i,r,s;function o(f,c){var S=t[f],v=S.getNext(),P=t[c],g=P.getNext();return S._handleOut.isZero()&&v._handleIn.isZero()&&P._handleOut.isZero()&&g._handleIn.isZero()&&v._point.subtract(S._point).isCollinear(g._point.subtract(P._point))}function a(f){var c=t[f],S=c.getPrevious(),v=c.getNext();return S._handleOut.isZero()&&c._handleIn.isZero()&&c._handleOut.isZero()&&v._handleIn.isZero()&&c._point.subtract(S._point).isOrthogonal(v._point.subtract(c._point))}function u(f){var c=t[f],S=c.getNext(),v=c._handleOut,P=S._handleIn,g=.5522847498307936;if(v.isOrthogonal(P)){var w=c._point,h=S._point,p=new re(w,v,!0).intersect(new re(h,P,!0),!0);return p&&j.isZero(v.getLength()/p.subtract(w).getLength()-g)&&j.isZero(P.getLength()/p.subtract(h).getLength()-g)}return!1}function l(f,c){return t[f]._point.getDistance(t[c]._point)}if(!this.hasHandles()&&t.length===4&&o(0,2)&&o(1,3)&&a(1)?(n=he.Rectangle,i=new se(l(0,3),l(0,1)),s=t[1]._point.add(t[2]._point).divide(2)):t.length===8&&u(0)&&u(2)&&u(4)&&u(6)&&o(1,5)&&o(3,7)?(n=he.Rectangle,i=new se(l(1,6),l(0,3)),r=i.subtract(new se(l(0,7),l(1,2))).divide(2),s=t[3]._point.add(t[4]._point).divide(2)):t.length===4&&u(0)&&u(1)&&u(2)&&u(3)&&(j.isZero(l(0,2)-l(1,3))?(n=he.Circle,r=l(0,2)/2):(n=he.Ellipse,r=new se(l(2,0)/2,l(3,1)/2)),s=t[1]._point),n){var d=this.getPosition(!0),_=new n({center:d,size:i,radius:r,insert:!1});return _.copyAttributes(this,!0),_._matrix.prepend(this._matrix),_.rotate(s.subtract(d).getAngle()+90),(e===M||e)&&_.insertAbove(this),_}return null},toPath:"#clone",compare:function e(t){if(!t||t instanceof dt)return e.base.call(this,t);var n=this.getCurves(),i=t.getCurves(),r=n.length,s=i.length;if(!r||!s)return r==s;for(var o=n[0].getValues(),a=[],u=0,l,d=0,_,f=0;f<s;f++){var P=i[f].getValues();a.push(P);var c=we.getOverlaps(o,P);if(c){l=!f&&c[0][0]>0?s-1:f,_=c[0][1];break}}for(var S=Math.abs,v=1e-8,P=a[l],g;o&&P;){var c=we.getOverlaps(o,P);if(c){var w=c[0][0];if(S(w-d)<v){d=c[1][0],d===1&&(o=++u<r?n[u].getValues():null,d=0);var h=c[0][1];if(S(h-_)<v){if(g||(g=[l,h]),_=c[1][1],_===1&&(++l>=s&&(l=0),P=a[l]||i[l].getValues(),_=0),!o)return g[0]===l&&g[1]===_;continue}}}break}return!1},_hitTestSelf:function(e,t,n,i){var r=this,s=this.getStyle(),o=this._segments,a=o.length,u=this._closed,l=t._tolerancePadding,d=l,_,f,c,S,v,P,g=t.stroke&&s.hasStroke(),w=t.fill&&s.hasFill(),h=t.curves,p=g?s.getStrokeWidth()/2:w&&t.tolerance>0||h?0:null;p!==null&&(p>0?(_=s.getStrokeJoin(),f=s.getStrokeCap(),c=s.getMiterLimit(),d=d.add(Fe._getStrokePadding(p,i))):_=f="round");function x(Z,J){return e.subtract(Z).divide(J).length<=1}function E(Z,J,ee){if(!t.selected||J.isSelected()){var te=Z._point;if(J!==te&&(J=J.add(te)),x(J,d))return new Me(ee,r,{segment:Z,point:J})}}function y(Z,J){return(J||t.segments)&&E(Z,Z._point,"segment")||!J&&t.handles&&(E(Z,Z._handleIn,"handle-in")||E(Z,Z._handleOut,"handle-out"))}function z(Z){S.add(Z)}function F(Z){var J=u||Z._index>0&&Z._index<a-1;if((J?_:f)==="round")return x(Z._point,d);if(S=new Fe({internal:!0,closed:!0}),J?Z.isSmooth()||Fe._addBevelJoin(Z,_,p,c,null,i,z,!0):f==="square"&&Fe._addSquareCap(Z,f,p,null,i,z,!0),!S.isEmpty()){var ee;return S.contains(e)||(ee=S.getNearestLocation(e))&&x(ee.getPoint(),l)}}if(t.ends&&!t.segments&&!u){if(P=y(o[0],!0)||y(o[a-1],!0))return P}else if(t.segments||t.handles){for(var q=0;q<a;q++)if(P=y(o[q]))return P}if(p!==null){if(v=this.getNearestLocation(e),v){var X=v.getTime();X===0||X===1&&a>1?F(v.getSegment())||(v=null):x(v.getPoint(),d)||(v=null)}if(!v&&_==="miter"&&a>1)for(var q=0;q<a;q++){var N=o[q];if(e.getDistance(N._point)<=c*p&&F(N)){v=N.getLocation();break}}}return!v&&w&&this._contains(e)||v&&!g&&!h?new Me("fill",this):v?new Me(g?"stroke":"curve",this,{location:v,point:v.getPoint()}):null}},I.each(we._evaluateMethods,function(e){this[e+"At"]=function(t){var n=this.getLocationAt(t);return n&&n[e]()}},{beans:!1,getLocationOf:function(){for(var e=k.read(arguments),t=this.getCurves(),n=0,i=t.length;n<i;n++){var r=t[n].getLocationOf(e);if(r)return r}return null},getOffsetOf:function(){var e=this.getLocationOf.apply(this,arguments);return e?e.getOffset():null},getLocationAt:function(e){if(typeof e=="number"){for(var t=this.getCurves(),n=0,i=0,r=t.length;i<r;i++){var s=n,o=t[i];if(n+=o.getLength(),n>e)return o.getLocationAt(e-s)}if(t.length>0&&e<=this.getLength())return new ft(t[t.length-1],1)}else if(e&&e.getPath&&e.getPath()===this)return e;return null},getOffsetsWithTangent:function(){var e=k.read(arguments);if(e.isZero())return[];for(var t=[],n=0,i=this.getCurves(),r=0,s=i.length;r<s;r++){for(var o=i[r],a=o.getTimesWithTangent(e),u=0,l=a.length;u<l;u++){var d=n+o.getOffsetAtTime(a[u]);t.indexOf(d)<0&&t.push(d)}n+=o.length}return t}}),new function(){function e(n,i,r,s){if(s<=0)return;var o=s/2,a=s-2,u=o-1,l=new Array(6),d,_;function f(w){var h=l[w],p=l[w+1];(d!=h||_!=p)&&(n.beginPath(),n.moveTo(d,_),n.lineTo(h,p),n.stroke(),n.beginPath(),n.arc(h,p,o,0,Math.PI*2,!0),n.fill())}for(var c=0,S=i.length;c<S;c++){var v=i[c],P=v._selection;if(v._transformCoordinates(r,l),d=l[0],_=l[1],P&2&&f(2),P&4&&f(4),n.fillRect(d-o,_-o,s,s),a>0&&!(P&1)){var g=n.fillStyle;n.fillStyle="#ffffff",n.fillRect(d-u,_-u,a,a),n.fillStyle=g}}}function t(n,i,r){var s=i._segments,o=s.length,a=new Array(6),u=!0,l,d,_,f,c,S,v,P;function g(h){if(r)h._transformCoordinates(r,a),l=a[0],d=a[1];else{var p=h._point;l=p._x,d=p._y}if(u)n.moveTo(l,d),u=!1;else{if(r)c=a[2],S=a[3];else{var x=h._handleIn;c=l+x._x,S=d+x._y}c===l&&S===d&&v===_&&P===f?n.lineTo(l,d):n.bezierCurveTo(v,P,c,S,l,d)}if(_=l,f=d,r)v=a[4],P=a[5];else{var x=h._handleOut;v=_+x._x,P=f+x._y}}for(var w=0;w<o;w++)g(s[w]);i._closed&&o>0&&g(s[0])}return{_draw:function(n,i,r,s){var o=i.dontStart,a=i.dontFinish||i.clip,u=this.getStyle(),l=u.hasFill(),d=u.hasStroke(),_=u.getDashArray(),f=!De.support.nativeDash&&d&&_&&_.length;o||n.beginPath(),(l||d&&!f||a)&&(t(n,this,s),this._closed&&n.closePath());function c(h){return _[(h%f+f)%f]}if(!a&&(l||d)&&(this._setStyles(n,i,r),l&&(n.fill(u.getFillRule()),n.shadowColor="rgba(0,0,0,0)"),d)){if(f){o||n.beginPath();for(var S=new dn(this,.25,32,!1,s),v=S.length,P=-u.getDashOffset(),g,w=0;P>0;)P-=c(w--)+c(w--);for(;P<v;)g=P+c(w++),(P>0||g>0)&&S.drawPart(n,Math.max(P,0),Math.max(g,0)),P=g+c(w++)}n.stroke()}},_drawSelected:function(n,i){n.beginPath(),t(n,this,i),n.stroke(),e(n,this._segments,i,De.settings.handleSize)}}},new function(){function e(t){var n=t._segments;if(!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return{moveTo:function(){var t=this._segments;t.length===1&&this.removeSegment(0),t.length||this._add([new Ce(k.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Ce(k.read(arguments))])},cubicCurveTo:function(){var t=arguments,n=k.read(t),i=k.read(t),r=k.read(t),s=e(this);s.setHandleOut(n.subtract(s._point)),this._add([new Ce(r,i.subtract(r))])},quadraticCurveTo:function(){var t=arguments,n=k.read(t),i=k.read(t),r=e(this)._point;this.cubicCurveTo(n.add(r.subtract(n).multiply(1/3)),n.add(i.subtract(n).multiply(1/3)),i)},curveTo:function(){var t=arguments,n=k.read(t),i=k.read(t),r=I.pick(I.read(t),.5),s=1-r,o=e(this)._point,a=n.subtract(o.multiply(s*s)).subtract(i.multiply(r*r)).divide(2*r*s);if(a.isNaN())throw new Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(a,i)},arcTo:function(){var t=arguments,n=Math.abs,i=Math.sqrt,r=e(this),s=r._point,o=k.read(t),a,u=I.peek(t),l=I.pick(u,!0),d,_,f,c;if(typeof l=="boolean")var S=s.add(o).divide(2),a=S.add(S.subtract(s).rotate(l?-90:90));else if(I.remain(t)<=2)a=o,o=k.read(t);else if(!s.equals(o)){var v=se.read(t),P=j.isZero;if(P(v.width)||P(v.height))return this.lineTo(o);var g=I.read(t),l=!!I.read(t),w=!!I.read(t),S=s.add(o).divide(2),h=s.subtract(S).rotate(-g),p=h.x,x=h.y,E=n(v.width),y=n(v.height),z=E*E,F=y*y,q=p*p,X=x*x,N=i(q/z+X/F);if(N>1&&(E*=N,y*=N,z=E*E,F=y*y),N=(z*F-z*X-F*q)/(z*X+F*q),n(N)<1e-12&&(N=0),N<0)throw new Error("Cannot create an arc with the given arguments");d=new k(E*x/y,-y*p/E).multiply((w===l?-1:1)*i(N)).rotate(g).add(S),c=new Q().translate(d).rotate(g).scale(E,y),f=c._inverseTransform(s),_=f.getDirectedAngle(c._inverseTransform(o)),!l&&_>0?_-=360:l&&_<0&&(_+=360)}if(a){var Z=new re(s.add(a).divide(2),a.subtract(s).rotate(90),!0),J=new re(a.add(o).divide(2),o.subtract(a).rotate(90),!0),ee=new re(s,o),te=ee.getSide(a);if(d=Z.intersect(J,!0),!d){if(!te)return this.lineTo(o);throw new Error("Cannot create an arc with the given arguments")}f=s.subtract(d),_=f.getDirectedAngle(o.subtract(d));var oe=ee.getSide(d,!0);oe===0?_=te*n(_):te===oe&&(_+=_<0?360:-360)}if(_){for(var _e=1e-5,me=n(_),ye=me>=360?4:Math.ceil((me-_e)/90),Se=_/ye,ce=Se*Math.PI/360,de=4/3*Math.sin(ce)/(1+Math.cos(ce)),be=[],xe=0;xe<=ye;xe++){var h=o,Pe=null;if(xe<ye&&(Pe=f.rotate(90).multiply(de),c?(h=c._transformPoint(f),Pe=c._transformPoint(f.add(Pe)).subtract(h)):h=d.add(f)),!xe)r.setHandleOut(Pe);else{var Te=f.rotate(-90).multiply(de);c&&(Te=c._transformPoint(f.add(Te)).subtract(h)),be.push(new Ce(h,Te,Pe))}f=f.rotate(Se)}this._add(be)}},lineBy:function(){var t=k.read(arguments),n=e(this)._point;this.lineTo(n.add(t))},curveBy:function(){var t=arguments,n=k.read(t),i=k.read(t),r=I.read(t),s=e(this)._point;this.curveTo(s.add(n),s.add(i),r)},cubicCurveBy:function(){var t=arguments,n=k.read(t),i=k.read(t),r=k.read(t),s=e(this)._point;this.cubicCurveTo(s.add(n),s.add(i),s.add(r))},quadraticCurveBy:function(){var t=arguments,n=k.read(t),i=k.read(t),r=e(this)._point;this.quadraticCurveTo(r.add(n),r.add(i))},arcBy:function(){var t=arguments,n=e(this)._point,i=n.add(k.read(t)),r=I.pick(I.peek(t),!0);typeof r=="boolean"?this.arcTo(i,r):this.arcTo(i,n.add(k.read(t)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(e,t){var n=t.handle?"getHandleBounds":t.stroke?"getStrokeBounds":"getBounds";return Fe[n](this._segments,this._closed,this,e,t)},statics:{getBounds:function(e,t,n,i,r,s){var o=e[0];if(!o)return new V;var a=new Array(6),u=o._transformCoordinates(i,new Array(6)),l=u.slice(0,2),d=l.slice(),_=new Array(2);function f(v){v._transformCoordinates(i,a);for(var P=0;P<2;P++)we._addBounds(u[P],u[P+4],a[P+2],a[P],P,s?s[P]:0,l,d,_);var g=u;u=a,a=g}for(var c=1,S=e.length;c<S;c++)f(e[c]);return t&&f(o),new V(l[0],l[1],d[0]-l[0],d[1]-l[1])},getStrokeBounds:function(e,t,n,i,r){var s=n.getStyle(),o=s.hasStroke(),a=s.getStrokeWidth(),u=o&&n._getStrokeMatrix(i,r),l=o&&Fe._getStrokePadding(a,u),d=Fe.getBounds(e,t,n,i,r,l);if(!o)return d;var _=a/2,f=s.getStrokeJoin(),c=s.getStrokeCap(),S=s.getMiterLimit(),v=new V(new se(l));function P(E){d=d.include(E)}function g(E){d=d.unite(v.setCenter(E._point.transform(i)))}function w(E,y){y==="round"||E.isSmooth()?g(E):Fe._addBevelJoin(E,y,_,S,i,u,P)}function h(E,y){y==="round"?g(E):Fe._addSquareCap(E,y,_,i,u,P)}var p=e.length-(t?0:1);if(p>0){for(var x=1;x<p;x++)w(e[x],f);t?w(e[0],f):(h(e[0],c),h(e[e.length-1],c))}return d},_getStrokePadding:function(e,t){if(!t)return[e,e];var n=new k(e,0).transform(t),i=new k(0,e).transform(t),r=n.getAngleInRadians(),s=n.getLength(),o=i.getLength(),a=Math.sin(r),u=Math.cos(r),l=Math.tan(r),d=Math.atan2(o*l,s),_=Math.atan2(o,l*s);return[Math.abs(s*Math.cos(d)*u+o*Math.sin(d)*a),Math.abs(o*Math.sin(_)*u+s*Math.cos(_)*a)]},_addBevelJoin:function(e,t,n,i,r,s,o,a){var u=e.getCurve(),l=u.getPrevious(),d=u.getPoint1().transform(r),_=l.getNormalAtTime(1).multiply(n).transform(s),f=u.getNormalAtTime(0).multiply(n).transform(s),c=_.getDirectedAngle(f);if((c<0||c>=180)&&(_=_.negate(),f=f.negate()),a&&o(d),o(d.add(_)),t==="miter"){var S=new re(d.add(_),new k(-_.y,_.x),!0).intersect(new re(d.add(f),new k(-f.y,f.x),!0),!0);S&&d.getDistance(S)<=i*n&&o(S)}o(d.add(f))},_addSquareCap:function(e,t,n,i,r,s,o){var a=e._point.transform(i),u=e.getLocation(),l=u.getNormal().multiply(u.getTime()===0?n:-n).transform(r);t==="square"&&(o&&(s(a.subtract(l)),s(a.add(l))),a=a.add(l.rotate(-90))),s(a.add(l)),s(a.subtract(l))},getHandleBounds:function(e,t,n,i,r){var s=n.getStyle(),o=r.stroke&&s.hasStroke(),a,u;if(o){var l=n._getStrokeMatrix(i,r),d=s.getStrokeWidth()/2,_=d;s.getStrokeJoin()==="miter"&&(_=d*s.getMiterLimit()),s.getStrokeCap()==="square"&&(_=Math.max(_,d*Math.SQRT2)),a=Fe._getStrokePadding(d,l),u=Fe._getStrokePadding(_,l)}for(var f=new Array(6),c=1/0,S=-c,v=c,P=S,g=0,w=e.length;g<w;g++){var h=e[g];h._transformCoordinates(i,f);for(var p=0;p<6;p+=2){var x=p?a:u,E=x?x[0]:0,y=x?x[1]:0,z=f[p],F=f[p+1],q=z-E,X=z+E,N=F-y,Z=F+y;q<c&&(c=q),X>S&&(S=X),N<v&&(v=N),Z>P&&(P=Z)}}return new V(c,v,S-c,P-v)}}});Fe.inject({statics:new function(){var e=.5522847498307936,t=[new Ce([-1,0],[0,e],[0,-e]),new Ce([0,-1],[-e,0],[e,0]),new Ce([1,0],[0,-e],[0,e]),new Ce([0,1],[e,0],[-e,0])];function n(r,s,o){var a=I.getNamed(o),u=new Fe(a&&(a.insert==!0?R.INSERT:a.insert==!1?R.NO_INSERT:null));return u._add(r),u._closed=s,u.set(a,R.INSERT)}function i(r,s,o){for(var a=new Array(4),u=0;u<4;u++){var l=t[u];a[u]=new Ce(l._point.multiply(s).add(r),l._handleIn.multiply(s),l._handleOut.multiply(s))}return n(a,!0,o)}return{Line:function(){var r=arguments;return n([new Ce(k.readNamed(r,"from")),new Ce(k.readNamed(r,"to"))],!1,r)},Circle:function(){var r=arguments,s=k.readNamed(r,"center"),o=I.readNamed(r,"radius");return i(s,new se(o),r)},Rectangle:function(){var r=arguments,s=V.readNamed(r,"rectangle"),o=se.readNamed(r,"radius",0,{readNull:!0}),a=s.getBottomLeft(!0),u=s.getTopLeft(!0),l=s.getTopRight(!0),d=s.getBottomRight(!0),_;if(!o||o.isZero())_=[new Ce(a),new Ce(u),new Ce(l),new Ce(d)];else{o=se.min(o,s.getSize(!0).divide(2));var f=o.width,c=o.height,S=f*e,v=c*e;_=[new Ce(a.add(f,0),null,[-S,0]),new Ce(a.subtract(0,c),[0,v]),new Ce(u.add(0,c),null,[0,-v]),new Ce(u.add(f,0),[-S,0],null),new Ce(l.subtract(f,0),null,[S,0]),new Ce(l.add(0,c),[0,-v],null),new Ce(d.subtract(0,c),null,[0,v]),new Ce(d.subtract(f,0),[S,0])]}return n(_,!0,r)},RoundRectangle:"#Rectangle",Ellipse:function(){var r=arguments,s=he._readEllipse(r);return i(s.center,s.radius,r)},Oval:"#Ellipse",Arc:function(){var r=arguments,s=k.readNamed(r,"from"),o=k.readNamed(r,"through"),a=k.readNamed(r,"to"),u=I.getNamed(r),l=new Fe(u&&u.insert==!1&&R.NO_INSERT);return l.moveTo(s),l.arcTo(o,a),l.set(u)},RegularPolygon:function(){for(var r=arguments,s=k.readNamed(r,"center"),o=I.readNamed(r,"sides"),a=I.readNamed(r,"radius"),u=360/o,l=o%3===0,d=new k(0,l?-a:a),_=l?-1:.5,f=new Array(o),c=0;c<o;c++)f[c]=new Ce(s.add(d.rotate((c+_)*u)));return n(f,!0,r)},Star:function(){for(var r=arguments,s=k.readNamed(r,"center"),o=I.readNamed(r,"points")*2,a=I.readNamed(r,"radius1"),u=I.readNamed(r,"radius2"),l=360/o,d=new k(0,-1),_=new Array(o),f=0;f<o;f++)_[f]=new Ce(s.add(d.rotate(l*f).multiply(f%2?u:a)));return n(_,!0,r)}}}});var dt=vt.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||(typeof t=="string"?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function e(t,n){var i=n,r=i[0];r&&typeof r[0]=="number"&&(i=[i]);for(var s=n.length-1;s>=0;s--){var o=i[s];i===n&&!(o instanceof Fe)&&(i=I.slice(i)),Array.isArray(o)?i[s]=new Fe({segments:o,insert:!1}):o instanceof dt&&(i.splice.apply(i,[s,1].concat(o.removeChildren())),o.remove())}return e.base.call(this,t,i)},reduce:function e(t){for(var n=this._children,i=n.length-1;i>=0;i--){var r=n[i].reduce(t);r.isEmpty()&&r.remove()}if(!n.length){var r=new Fe(R.NO_INSERT);return r.copyAttributes(this),r.insertAbove(this),this.remove(),r}return e.base.call(this)},isClosed:function(){for(var e=this._children,t=0,n=e.length;t<n;t++)if(!e[t]._closed)return!1;return!0},setClosed:function(e){for(var t=this._children,n=0,i=t.length;n<i;n++)t[n].setClosed(e)},getFirstSegment:function(){var e=this.getFirstChild();return e&&e.getFirstSegment()},getLastSegment:function(){var e=this.getLastChild();return e&&e.getLastSegment()},getCurves:function(){for(var e=this._children,t=[],n=0,i=e.length;n<i;n++)I.push(t,e[n].getCurves());return t},getFirstCurve:function(){var e=this.getFirstChild();return e&&e.getFirstCurve()},getLastCurve:function(){var e=this.getLastChild();return e&&e.getLastCurve()},getArea:function(){for(var e=this._children,t=0,n=0,i=e.length;n<i;n++)t+=e[n].getArea();return t},getLength:function(){for(var e=this._children,t=0,n=0,i=e.length;n<i;n++)t+=e[n].getLength();return t},getPathData:function(e,t){for(var n=this._children,i=[],r=0,s=n.length;r<s;r++){var o=n[r],a=o._matrix;i.push(o.getPathData(e&&!a.isIdentity()?e.appended(a):e,t))}return i.join("")},_hitTestChildren:function e(t,n,i){return e.base.call(this,t,n.class===Fe||n.type==="path"?n:I.set({},n,{fill:!1}),i)},_draw:function(e,t,n,i){var r=this._children;if(r.length){t=t.extend({dontStart:!0,dontFinish:!0}),e.beginPath();for(var s=0,o=r.length;s<o;s++)r[s].draw(e,t,i);if(!t.clip){this._setStyles(e,t,n);var a=this._style;a.hasFill()&&(e.fill(a.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),a.hasStroke()&&e.stroke()}}},_drawSelected:function(e,t,n){for(var i=this._children,r=0,s=i.length;r<s;r++){var o=i[r],a=o._matrix;n[o._id]||o._drawSelected(e,a.isIdentity()?t:t.appended(a))}}},new function(){function e(t,n){var i=t._children;if(n&&!i.length)throw new Error("Use a moveTo() command first");return i[i.length-1]}return I.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(t){this[t]=function(){var n=e(this,!0);n[t].apply(n,arguments)}},{moveTo:function(){var t=e(this),n=t&&t.isEmpty()?t:new Fe(R.NO_INSERT);n!==t&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var t=e(this,!0),n=t&&t.getLastSegment(),i=k.read(arguments);this.moveTo(n?i.add(n._point):i)},closePath:function(t){e(this,!0).closePath(t)}})},I.each(["reverse","flatten","simplify","smooth"],function(e){this[e]=function(t){for(var n=this._children,i,r=0,s=n.length;r<s;r++)i=n[r][e](t)||i;return i}},{}));vt.inject(new function(){var e=Math.min,t=Math.max,n=Math.abs,i={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function r(g){return g._children||[g]}function s(g,w){var h=g.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(w){for(var p=r(h),x=0,E=p.length;x<E;x++){var g=p[x];!g._closed&&!g.isEmpty()&&(g.closePath(1e-12),g.getFirstSegment().setHandleIn(0,0),g.getLastSegment().setHandleOut(0,0))}h=h.resolveCrossings().reorient(h.getFillRule()==="nonzero",!0)}return h}function o(g,w,h,p,x){var E=new dt(R.NO_INSERT);return E.addChildren(g,!0),E=E.reduce({simplify:w}),x&&x.insert==!1||E.insertAbove(p&&h.isSibling(p)&&h.getIndex()<p.getIndex()?p:h),E.copyAttributes(h,!0),E}function a(g){return g.hasOverlap()||g.isCrossing()}function u(g,w,h,p){if(p&&(p.trace==!1||p.stroke)&&/^(subtract|intersect)$/.test(h))return l(g,w,h);var x=s(g,!0),E=w&&g!==w&&s(w,!0),y=i[h];y[h]=!0,E&&(y.subtract||y.exclude)^(E.isClockwise()^x.isClockwise())&&E.reverse();var z=c(ft.expand(x.getIntersections(E,a))),F=r(x),q=E&&r(E),X=[],N=[],Z;function J(Pe){for(var Te=0,Ee=Pe.length;Te<Ee;Te++){var Oe=Pe[Te];I.push(X,Oe._segments),I.push(N,Oe.getCurves()),Oe._overlapsOnly=!0}}function ee(Pe){for(var Te=[],Ee=0,Oe=Pe&&Pe.length;Ee<Oe;Ee++)Te.push(N[Pe[Ee]]);return Te}if(z.length){J(F),q&&J(q);for(var te=new Array(N.length),oe=0,_e=N.length;oe<_e;oe++)te[oe]=N[oe].getValues();for(var me=L.findCurveBoundsCollisions(te,te,0,!0),ye={},oe=0;oe<N.length;oe++){var Se=N[oe],ce=Se._path._id,de=ye[ce]=ye[ce]||{};de[Se.getIndex()]={hor:ee(me[oe].hor),ver:ee(me[oe].ver)}}for(var oe=0,_e=z.length;oe<_e;oe++)v(z[oe]._segment,x,E,ye,y);for(var oe=0,_e=X.length;oe<_e;oe++){var be=X[oe],xe=be._intersection;be._winding||v(be,x,E,ye,y),xe&&xe._overlap||(be._path._overlapsOnly=!1)}Z=P(X,y)}else Z=f(q?F.concat(q):F.slice(),function(Pe){return!!y[Pe]});return o(Z,!0,g,w,p)}function l(g,w,h){var p=s(g),x=s(w),E=p.getIntersections(x,a),y=h==="subtract",z=h==="divide",F={},q=[];function X(J){if(!F[J._id]&&(z||x.contains(J.getPointAt(J.getLength()/2))^y))return q.unshift(J),F[J._id]=!0}for(var N=E.length-1;N>=0;N--){var Z=E[N].split();Z&&(X(Z)&&Z.getFirstSegment().setHandleIn(0,0),p.getLastSegment().setHandleOut(0,0))}return X(p),o(q,!1,g,w)}function d(g,w){for(var h=g;h;){if(h===w)return;h=h._previous}for(;g._next&&g._next!==w;)g=g._next;if(!g._next){for(;w._previous;)w=w._previous;g._next=w,w._previous=g}}function _(g){for(var w=g.length-1;w>=0;w--)g[w].clearHandles()}function f(g,w,h){var p=g&&g.length;if(p){var x=I.each(g,function(me,ye){this[me._id]={container:null,winding:me.isClockwise()?1:-1,index:ye}},{}),E=g.slice().sort(function(me,ye){return n(ye.getArea())-n(me.getArea())}),y=E[0],z=L.findItemBoundsCollisions(E,null,j.GEOMETRIC_EPSILON);h==null&&(h=y.isClockwise());for(var F=0;F<p;F++){var q=E[F],X=x[q._id],N=0,Z=z[F];if(Z){for(var J=null,ee=Z.length-1;ee>=0;ee--)if(Z[ee]<F){J=J||q.getInteriorPoint();var te=E[Z[ee]];if(te.contains(J)){var oe=x[te._id];N=oe.winding,X.winding+=N,X.container=oe.exclude?oe.container:te;break}}}if(w(X.winding)===w(N))X.exclude=!0,g[X.index]=null;else{var _e=X.container;q.setClockwise(_e?!_e.isClockwise():h)}}}return g}function c(g,w,h){var p=w&&[],x=1e-8,E=1-x,y=!1,z=h||[],F=h&&{},q,X,N;function Z(Te){return Te._path._id+"."+Te._segment1._index}for(var J=(h&&h.length)-1;J>=0;J--){var ee=h[J];ee._path&&(F[Z(ee)]=!0)}for(var J=g.length-1;J>=0;J--){var te=g[J],oe=te._time,_e=oe,me=w&&!w(te),ee=te._curve,ye;if(ee&&(ee!==X?(y=!ee.hasHandles()||F&&F[Z(ee)],q=[],N=null,X=ee):N>=x&&(oe/=N)),me){q&&q.push(te);continue}else w&&p.unshift(te);if(N=_e,oe<x)ye=ee._segment1;else if(oe>E)ye=ee._segment2;else{var Se=ee.divideAtTime(oe,!0);y&&z.push(ee,Se),ye=Se._segment1;for(var ce=q.length-1;ce>=0;ce--){var de=q[ce];de._time=(de._time-oe)/(1-oe)}}te._setSegment(ye);var be=ye._intersection,xe=te._intersection;if(be){d(be,xe);for(var Pe=be;Pe;)d(Pe._intersection,be),Pe=Pe._next}else ye._intersection=xe}return h||_(z),p||g}function S(g,w,h,p,x){var E=Array.isArray(w)?w:w[h?"hor":"ver"],y=h?1:0,z=y^1,F=[g.x,g.y],q=F[y],X=F[z],N=1e-9,Z=1e-6,J=q-N,ee=q+N,te=0,oe=0,_e=0,me=0,ye=!1,Se=!1,ce=1,de=[],be,xe;function Pe(He){var $e=He[z+0],gt=He[z+6];if(!(X<e($e,gt)||X>t($e,gt))){var at=He[y+0],mt=He[y+2],Ot=He[y+4],wt=He[y+6];if($e===gt){(at<ee&&wt>J||wt<ee&&at>J)&&(ye=!0);return}var yt=X===$e?0:X===gt||J>t(at,mt,Ot,wt)||ee<e(at,mt,Ot,wt)?1:we.solveCubic(He,z,X,de,0,1)>0?de[0]:1,_t=yt===0?at:yt===1?wt:we.getPoint(He,yt)[h?"y":"x"],pt=$e>gt?1:-1,zt=be[z]>be[z+6]?1:-1,bt=be[y+6];return X!==$e?(_t<J?_e+=pt:_t>ee?me+=pt:ye=!0,_t>q-Z&&_t<q+Z&&(ce/=2)):(pt!==zt?at<J?_e+=pt:at>ee&&(me+=pt):at!=bt&&(bt<ee&&_t>ee?(me+=pt,ye=!0):bt>J&&_t<J&&(_e+=pt,ye=!0)),ce/=4),be=He,!x&&_t>J&&_t<ee&&we.getTangent(He,yt)[h?"x":"y"]===0&&S(g,w,!h,p,!0)}}function Te(He){var $e=He[z+0],gt=He[z+2],at=He[z+4],mt=He[z+6];if(X<=t($e,gt,at,mt)&&X>=e($e,gt,at,mt)){for(var Ot=He[y+0],wt=He[y+2],yt=He[y+4],_t=He[y+6],pt=J>t(Ot,wt,yt,_t)||ee<e(Ot,wt,yt,_t)?[He]:we.getMonoCurves(He,h),zt,bt=0,pn=pt.length;bt<pn;bt++)if(zt=Pe(pt[bt]))return zt}}for(var Ee=0,Oe=E.length;Ee<Oe;Ee++){var Re=E[Ee],Le=Re._path,rt=Re.getValues(),st;if((!Ee||E[Ee-1]._path!==Le)&&(be=null,Le._closed||(xe=we.getValues(Le.getLastCurve().getSegment2(),Re.getSegment1(),null,!p),xe[z]!==xe[z+6]&&(be=xe)),!be)){be=rt;for(var lt=Le.getLastCurve();lt&&lt!==Re;){var Qe=lt.getValues();if(Qe[z]!==Qe[z+6]){be=Qe;break}lt=lt.getPrevious()}}if(st=Te(rt))return st;if(Ee+1===Oe||E[Ee+1]._path!==Le){if(xe&&(st=Te(xe)))return st;ye&&!_e&&!me&&(_e=me=Le.isClockwise(p)^h?1:-1),te+=_e,oe+=me,_e=me=0,ye&&(Se=!0,ye=!1),xe=null}}return te=n(te),oe=n(oe),{winding:t(te,oe),windingL:te,windingR:oe,quality:ce,onPath:Se}}function v(g,w,h,p,x){var E=[],y=g,z=0,N;do{var F=g.getCurve();if(F){var q=F.getLength();E.push({segment:g,curve:F,length:q}),z+=q}g=g.getNext()}while(g&&!g._intersection&&g!==y);for(var X=[.5,.25,.75],N={winding:0,quality:-1},Z=.001,J=1-Z,ee=0;ee<X.length&&N.quality<.5;ee++)for(var q=z*X[ee],te=0,oe=E.length;te<oe;te++){var _e=E[te],me=_e.length;if(q<=me){var F=_e.curve,ye=F._path,Se=ye._parent,ce=Se instanceof dt?Se:ye,de=j.clamp(F.getTimeAt(q),Z,J),be=F.getPointAtTime(de),xe=n(F.getTangentAtTime(de).y)<Math.SQRT1_2,Pe=null;if(x.subtract&&h){var Te=ce===w?h:w,Ee=Te._getWinding(be,xe,!0);if(ce===w&&Ee.winding||ce===h&&!Ee.winding){if(Ee.quality<1)continue;Pe={winding:0,quality:1}}}Pe=Pe||S(be,p[ye._id][F.getIndex()],xe,!0),Pe.quality>N.quality&&(N=Pe);break}q-=me}for(var te=E.length-1;te>=0;te--)E[te].segment._winding=N}function P(g,w){var h=[],p;function x(Oe){var Re;return!!(Oe&&!Oe._visited&&(!w||w[(Re=Oe._winding||{}).winding]&&!(w.unite&&Re.winding===2&&Re.windingL&&Re.windingR)))}function E(Oe){if(Oe){for(var Re=0,Le=p.length;Re<Le;Re++)if(Oe===p[Re])return!0}return!1}function y(Oe){for(var Re=Oe._segments,Le=0,rt=Re.length;Le<rt;Le++)Re[Le]._visited=!0}function z(Oe,Re){var Le=Oe._intersection,rt=Le,st=[];Re&&(p=[Oe]);function lt(Qe,He){for(;Qe&&Qe!==He;){var $e=Qe._segment,gt=$e&&$e._path;if(gt){var at=$e.getNext()||gt.getFirstSegment(),mt=at._intersection;$e!==Oe&&(E($e)||E(at)||at&&x($e)&&(x(at)||mt&&x(mt._segment)))&&st.push($e),Re&&p.push($e)}Qe=Qe._next}}if(Le){for(lt(Le);Le&&Le._previous;)Le=Le._previous;lt(Le,rt)}return st}g.sort(function(Oe,Re){var Le=Oe._intersection,rt=Re._intersection,st=!!(Le&&Le._overlap),lt=!!(rt&&rt._overlap),Qe=Oe._path,He=Re._path;return st^lt?st?1:-1:!Le^!rt?Le?1:-1:Qe!==He?Qe._id-He._id:Oe._index-Re._index});for(var F=0,q=g.length;F<q;F++){var X=g[F],N=x(X),Z=null,J=!1,ee=!0,te=[],oe,_e,me;if(N&&X._path._overlapsOnly){var ye=X._path,Se=X._intersection._segment._path;ye.compare(Se)&&(ye.getArea()&&h.push(ye.clone(!1)),y(ye),y(Se),N=!1)}for(;N;){var ce=!Z,de=z(X,ce),be=de.shift(),J=!ce&&(E(X)||E(be)),xe=!J&&be;if(ce&&(Z=new Fe(R.NO_INSERT),oe=null),J){(X.isFirst()||X.isLast())&&(ee=X._path._closed),X._visited=!0;break}if(xe&&oe&&(te.push(oe),oe=null),oe||(xe&&de.push(X),oe={start:Z._segments.length,crossings:de,visited:_e=[],handleIn:me}),xe&&(X=be),!x(X)){Z.removeSegments(oe.start);for(var Pe=0,Te=_e.length;Pe<Te;Pe++)_e[Pe]._visited=!1;_e.length=0;do X=oe&&oe.crossings.shift(),(!X||!X._path)&&(X=null,oe=te.pop(),oe&&(_e=oe.visited,me=oe.handleIn));while(oe&&!x(X));if(!X)break}var Ee=X.getNext();Z.add(new Ce(X._point,me,Ee&&X._handleOut)),X._visited=!0,_e.push(X),X=Ee||X._path.getFirstSegment(),me=Ee&&Ee._handleIn}J&&(ee&&(Z.getFirstSegment().setHandleIn(me),Z.setClosed(ee)),Z.getArea()!==0&&h.push(Z))}return h}return{_getWinding:function(g,w,h){return S(g,this.getCurves(),w,h)},unite:function(g,w){return u(this,g,"unite",w)},intersect:function(g,w){return u(this,g,"intersect",w)},subtract:function(g,w){return u(this,g,"subtract",w)},exclude:function(g,w){return u(this,g,"exclude",w)},divide:function(g,w){return w&&(w.trace==!1||w.stroke)?l(this,g,"divide"):o([this.subtract(g,w),this.intersect(g,w)],!0,this,g,w)},resolveCrossings:function(){var g=this._children,w=g||[this];function h(oe,_e){var me=oe&&oe._intersection;return me&&me._overlap&&me._path===_e}var p=!1,x=!1,E=this.getIntersections(null,function(oe){return oe.hasOverlap()&&(p=!0)||oe.isCrossing()&&(x=!0)}),y=p&&x&&[];if(E=ft.expand(E),p)for(var z=c(E,function(oe){return oe.hasOverlap()},y),F=z.length-1;F>=0;F--){var q=z[F],X=q._path,N=q._segment,Z=N.getPrevious(),J=N.getNext();h(Z,X)&&h(J,X)&&(N.remove(),Z._handleOut._set(0,0),J._handleIn._set(0,0),Z!==N&&!Z.getCurve().hasLength()&&(J._handleIn.set(Z._handleIn),Z.remove()))}x&&(c(E,p&&function(oe){var _e=oe.getCurve(),me=oe.getSegment(),ye=oe._intersection,Se=ye._curve,ce=ye._segment;if(_e&&Se&&_e._path&&Se._path)return!0;me&&(me._intersection=null),ce&&(ce._intersection=null)},y),y&&_(y),w=P(I.each(w,function(oe){I.push(this,oe._segments)},[])));var ee=w.length,te;return ee>1&&g?(w!==g&&this.setChildren(w),te=this):ee===1&&!g&&(w[0]!==this&&this.setSegments(w[0].removeSegments()),te=this),te||(te=new dt(R.NO_INSERT),te.addChildren(w),te=te.reduce(),te.copyAttributes(this),this.replaceWith(te)),te},reorient:function(g,w){var h=this._children;return h&&h.length?this.setChildren(f(this.removeChildren(),function(p){return!!(g?p:p&1)},w)):w!==M&&this.setClockwise(w),this},getInteriorPoint:function(){var g=this.getBounds(),w=g.getCenter(!0);if(!this.contains(w)){for(var h=this.getCurves(),p=w.y,x=[],E=[],y=0,z=h.length;y<z;y++){var F=h[y].getValues(),q=F[1],X=F[3],N=F[5],Z=F[7];if(p>=e(q,X,N,Z)&&p<=t(q,X,N,Z))for(var J=we.getMonoCurves(F),ee=0,te=J.length;ee<te;ee++){var oe=J[ee],_e=oe[1],me=oe[7];if(_e!==me&&(p>=_e&&p<=me||p>=me&&p<=_e)){var ye=p===_e?oe[0]:p===me?oe[6]:we.solveCubic(oe,1,p,E,0,1)===1?we.getPoint(oe,E[0]).x:(oe[0]+oe[6])/2;x.push(ye)}}}x.length>1&&(x.sort(function(Se,ce){return Se-ce}),w.x=(x[0]+x[1])/2)}return w}}});var dn=I.extend({_class:"PathFlattener",initialize:function(e,t,n,i,r){var s=[],o=[],a=0,u=1/(n||32),l=e._segments,d=l[0],_;function f(P,g){var w=we.getValues(P,g,r);s.push(w),c(w,P._index,0,1)}function c(P,g,w,h){if(h-w>u&&!(i&&we.isStraight(P))&&!we.isFlatEnough(P,t||.25)){var p=we.subdivide(P,.5),x=(w+h)/2;c(p[0],g,w,x),c(p[1],g,x,h)}else{var E=P[6]-P[0],y=P[7]-P[1],z=Math.sqrt(E*E+y*y);z>0&&(a+=z,o.push({offset:a,curve:P,index:g,time:h}))}}for(var S=1,v=l.length;S<v;S++)_=l[S],f(d,_),d=_;e._closed&&f(_||d,l[0]),this.curves=s,this.parts=o,this.length=a,this.index=0},_get:function(e){for(var t=this.parts,n=t.length,i,r=this.index;i=r,!(!r||t[--r].offset<e););for(;i<n;i++){var s=t[i];if(s.offset>=e){this.index=i;var o=t[i-1],a=o&&o.index===s.index?o.time:0,u=o?o.offset:0;return{index:s.index,time:a+(s.time-a)*(e-u)/(s.offset-u)}}}return{index:t[n-1].index,time:1}},drawPart:function(e,t,n){for(var i=this._get(t),r=this._get(n),s=i.index,o=r.index;s<=o;s++){var a=we.getPart(this.curves[s],s===i.index?i.time:0,s===r.index?r.time:1);s===i.index&&e.moveTo(a[0],a[1]),e.bezierCurveTo.apply(e,a.slice(2))}}},I.each(we._evaluateMethods,function(e){this[e+"At"]=function(t){var n=this._get(t);return we[e](this.curves[n.index],n.time)}},{})),Wi=I.extend({initialize:function(e){for(var t=this.points=[],n=e._segments,i=e._closed,r=0,s,o=n.length;r<o;r++){var a=n[r].point;(!s||!s.equals(a))&&t.push(s=a.clone())}i&&(t.unshift(t[t.length-1]),t.push(t[1])),this.closed=i},fit:function(e){var t=this.points,n=t.length,i=null;return n>0&&(i=[new Ce(t[0])],n>1&&(this.fitCubic(i,e,0,n-1,t[1].subtract(t[0]),t[n-2].subtract(t[n-1])),this.closed&&(i.shift(),i.pop()))),i},fitCubic:function(e,t,n,i,r,s){var o=this.points;if(i-n===1){var a=o[n],u=o[i],l=a.getDistance(u)/3;this.addCurve(e,[a,a.add(r.normalize(l)),u.add(s.normalize(l)),u]);return}for(var d=this.chordLengthParameterize(n,i),_=Math.max(t,t*t),f,c=!0,S=0;S<=4;S++){var v=this.generateBezier(n,i,d,r,s),P=this.findMaxError(n,i,v,d);if(P.error<t&&c){this.addCurve(e,v);return}if(f=P.index,P.error>=_)break;c=this.reparameterize(n,i,d,v),_=P.error}var g=o[f-1].subtract(o[f+1]);this.fitCubic(e,t,n,f,r,g),this.fitCubic(e,t,f,i,g.negate(),s)},addCurve:function(e,t){var n=e[e.length-1];n.setHandleOut(t[1].subtract(t[0])),e.push(new Ce(t[3],t[2].subtract(t[3])))},generateBezier:function(e,t,n,i,r){for(var s=1e-12,o=Math.abs,a=this.points,u=a[e],l=a[t],d=[[0,0],[0,0]],_=[0,0],f=0,c=t-e+1;f<c;f++){var S=n[f],v=1-S,P=3*S*v,g=v*v*v,w=P*v,h=P*S,p=S*S*S,x=i.normalize(w),E=r.normalize(h),y=a[e+f].subtract(u.multiply(g+w)).subtract(l.multiply(h+p));d[0][0]+=x.dot(x),d[0][1]+=x.dot(E),d[1][0]=d[0][1],d[1][1]+=E.dot(E),_[0]+=x.dot(y),_[1]+=E.dot(y)}var z=d[0][0]*d[1][1]-d[1][0]*d[0][1],F,q;if(o(z)>s){var X=d[0][0]*_[1]-d[1][0]*_[0],N=_[0]*d[1][1]-_[1]*d[0][1];F=N/z,q=X/z}else{var Z=d[0][0]+d[0][1],J=d[1][0]+d[1][1];F=q=o(Z)>s?_[0]/Z:o(J)>s?_[1]/J:0}var ee=l.getDistance(u),te=s*ee,oe,_e;if(F<te||q<te)F=q=ee/3;else{var me=l.subtract(u);oe=i.normalize(F),_e=r.normalize(q),oe.dot(me)-_e.dot(me)>ee*ee&&(F=q=ee/3,oe=_e=null)}return[u,u.add(oe||i.normalize(F)),l.add(_e||r.normalize(q)),l]},reparameterize:function(e,t,n,i){for(var r=e;r<=t;r++)n[r-e]=this.findRoot(i,this.points[r],n[r-e]);for(var r=1,s=n.length;r<s;r++)if(n[r]<=n[r-1])return!1;return!0},findRoot:function(e,t,n){for(var i=[],r=[],s=0;s<=2;s++)i[s]=e[s+1].subtract(e[s]).multiply(3);for(var s=0;s<=1;s++)r[s]=i[s+1].subtract(i[s]).multiply(2);var o=this.evaluate(3,e,n),a=this.evaluate(2,i,n),u=this.evaluate(1,r,n),l=o.subtract(t),d=a.dot(a)+l.dot(u);return j.isMachineZero(d)?n:n-l.dot(a)/d},evaluate:function(e,t,n){for(var i=t.slice(),r=1;r<=e;r++)for(var s=0;s<=e-r;s++)i[s]=i[s].multiply(1-n).add(i[s+1].multiply(n));return i[0]},chordLengthParameterize:function(e,t){for(var n=[0],i=e+1;i<=t;i++)n[i-e]=n[i-e-1]+this.points[i].getDistance(this.points[i-1]);for(var i=1,r=t-e;i<=r;i++)n[i]/=n[r];return n},findMaxError:function(e,t,n,i){for(var r=Math.floor((t-e+1)/2),s=0,o=e+1;o<t;o++){var a=this.evaluate(3,n,i[o-e]),u=a.subtract(this.points[o]),l=u.x*u.x+u.y*u.y;l>=s&&(s=l,r=o)}return{error:s,index:r}}}),gn=R.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var n=t&&I.isPlainObject(t)&&t.x===M&&t.y===M;this._initialize(n&&t,!n&&k.read(arguments))},_equals:function(e){return this._content===e._content},copyContent:function(e){this.setContent(e._content)},getContent:function(){return this._content},setContent:function(e){this._content=""+e,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Xi=gn.extend({_class:"PointText",initialize:function(){gn.apply(this,arguments)},getPoint:function(){var e=this._matrix.getTranslation();return new ue(e.x,e.y,this,"setPoint")},setPoint:function(){var e=k.read(arguments);this.translate(e.subtract(this._matrix.getTranslation()))},_draw:function(e,t,n){if(this._content){this._setStyles(e,t,n);var i=this._lines,r=this._style,s=r.hasFill(),o=r.hasStroke(),a=r.getLeading(),u=e.shadowColor;e.font=r.getFontStyle(),e.textAlign=r.getJustification();for(var l=0,d=i.length;l<d;l++){e.shadowColor=u;var _=i[l];s&&(e.fillText(_,0,0),e.shadowColor="rgba(0,0,0,0)"),o&&e.strokeText(_,0,0),e.translate(0,a)}}},_getBounds:function(e,t){var n=this._style,i=this._lines,r=i.length,s=n.getJustification(),o=n.getLeading(),a=this.getView().getTextWidth(n.getFontStyle(),i),u=0;s!=="left"&&(u-=a/(s==="center"?2:1));var l=new V(u,r?-.75*o:0,a,r*o);return e?e._transformBounds(l,l):l}}),tt=I.extend(new function(){var e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},t={},n={transparent:[0,0,0,0]},i;function r(a){var u=a.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||a.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),l="rgb",d;if(u){var _=u[4]?4:3;d=new Array(_);for(var f=0;f<_;f++){var c=u[f+1];d[f]=parseInt(c.length==1?c+c:c,16)/255}}else if(u=a.match(/^(rgb|hsl)a?\((.*)\)$/)){l=u[1],d=u[2].trim().split(/[,\s]+/g);for(var S=l==="hsl",f=0,v=Math.min(d.length,4);f<v;f++){var P=d[f],c=parseFloat(P);if(S)if(f===0){var g=P.match(/([a-z]*)$/)[1];c*={turn:360,rad:180/Math.PI,grad:.9}[g]||1}else f<3&&(c/=100);else f<3&&(c/=/%$/.test(P)?100:255);d[f]=c}}else{var w=n[a];if(!w)if(A){i||(i=it.getContext(1,1,{willReadFrequently:!0}),i.globalCompositeOperation="copy"),i.fillStyle="rgba(0,0,0,0)",i.fillStyle=a,i.fillRect(0,0,1,1);var h=i.getImageData(0,0,1,1).data;w=n[a]=[h[0]/255,h[1]/255,h[2]/255]}else w=[0,0,0];d=w.slice()}return[l,d]}var s=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(a,u,l){var d=Math.max(a,u,l),_=Math.min(a,u,l),f=d-_,c=f===0?0:(d==a?(u-l)/f+(u<l?6:0):d==u?(l-a)/f+2:(a-u)/f+4)*60;return[c,d===0?0:f/d,d]},"hsb-rgb":function(a,u,l){a=(a/60%6+6)%6;var _=Math.floor(a),d=a-_,_=s[_],f=[l,l*(1-u),l*(1-u*d),l*(1-u*(1-d))];return[f[_[0]],f[_[1]],f[_[2]]]},"rgb-hsl":function(a,u,l){var d=Math.max(a,u,l),_=Math.min(a,u,l),f=d-_,c=f===0,S=c?0:(d==a?(u-l)/f+(u<l?6:0):d==u?(l-a)/f+2:(a-u)/f+4)*60,v=(d+_)/2,P=c?0:v<.5?f/(d+_):f/(2-d-_);return[S,P,v]},"hsl-rgb":function(a,u,l){if(a=(a/360%1+1)%1,u===0)return[l,l,l];for(var d=[a+1/3,a,a-1/3],_=l<.5?l*(1+u):l+u-l*u,f=2*l-_,c=[],S=0;S<3;S++){var v=d[S];v<0&&(v+=1),v>1&&(v-=1),c[S]=6*v<1?f+(_-f)*6*v:2*v<1?_:3*v<2?f+(_-f)*(2/3-v)*6:f}return c},"rgb-gray":function(a,u,l){return[a*.2989+u*.587+l*.114]},"gray-rgb":function(a){return[a,a,a]},"gray-hsb":function(a){return[0,0,a]},"gray-hsl":function(a){return[0,0,a]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return I.each(e,function(a,u){t[u]=[],I.each(a,function(l,d){var _=I.capitalize(l),f=/^(hue|saturation)$/.test(l),c=t[u][d]=u==="gradient"?l==="gradient"?function(S){var v=this._components[0];return S=_n.read(Array.isArray(S)?S:arguments,0,{readNull:!0}),v!==S&&(v&&v._removeOwner(this),S&&S._addOwner(this)),S}:function(){return k.read(arguments,0,{readNull:l==="highlight",clone:!0})}:function(S){return S==null||isNaN(S)?0:+S};this["get"+_]=function(){return this._type===u||f&&/^hs[bl]$/.test(this._type)?this._components[d]:this._convert(u)[d]},this["set"+_]=function(S){this._type!==u&&!(f&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(u),this._properties=e[u],this._type=u),this._components[d]=c.call(this,S),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function a(u){var l=arguments,d=this.__read,_=0,f,c,S,v;Array.isArray(u)&&(l=u,u=l[0]);var P=u!=null&&typeof u;if(P==="string"&&u in e&&(f=u,u=l[1],Array.isArray(u)?(c=u,S=l[2]):(d&&(_=1),l=I.slice(l,1),P=typeof u)),!c){if(v=P==="number"?l:P==="object"&&u.length!=null?u:null,v){f||(f=v.length>=3?"rgb":"gray");var g=e[f].length;S=v[g],d&&(_+=v===arguments?g+(S!=null?1:0):1),v.length>g&&(v=I.slice(v,0,g))}else if(P==="string"){var w=r(u);f=w[0],c=w[1],c.length===4&&(S=c[3],c.length--)}else if(P==="object")if(u.constructor===a){if(f=u._type,c=u._components.slice(),S=u._alpha,f==="gradient")for(var h=1,p=c.length;h<p;h++){var x=c[h];x&&(c[h]=x.clone())}}else if(u.constructor===_n)f="gradient",v=l;else{f="hue"in u?"lightness"in u?"hsl":"hsb":"gradient"in u||"stops"in u||"radial"in u?"gradient":"gray"in u?"gray":"rgb";var E=e[f],y=t[f];this._components=c=[];for(var h=0,p=E.length;h<p;h++){var z=u[E[h]];z==null&&!h&&f==="gradient"&&"stops"in u&&(z={stops:u.stops,radial:u.radial}),z=y[h].call(this,z),z!=null&&(c[h]=z)}S=u.alpha}d&&f&&(_=1)}if(this._type=f||"rgb",!c){this._components=c=[];for(var y=t[this._type],h=0,p=y.length;h<p;h++){var z=y[h].call(this,v&&v[h]);z!=null&&(c[h]=z)}}return this._components=c,this._properties=e[this._type],this._alpha=S,d&&(this.__read=_),this},set:"#initialize",_serialize:function(a,u){var l=this.getComponents();return I.serialize(/^(gray|rgb)$/.test(this._type)?l:[this._type].concat(l),a,!0,u)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(a){var u;return this._type===a?this._components.slice():(u=o[this._type+"-"+a])?u.apply(this,this._components):o["rgb-"+a].apply(this,o[this._type+"-rgb"].apply(this,this._components))},convert:function(a){return new tt(a,this._convert(a),this._alpha)},getType:function(){return this._type},setType:function(a){this._components=this._convert(a),this._properties=e[a],this._type=a},getComponents:function(){var a=this._components.slice();return this._alpha!=null&&a.push(this._alpha),a},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(a){this._alpha=a==null?null:Math.min(Math.max(a,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(a){var u=I.isPlainValue(a,!0)?tt.read(arguments):a;return u===this||u&&this._class===u._class&&this._type===u._type&&this.getAlpha()===u.getAlpha()&&I.equals(this._components,u._components)||!1},toString:function(){for(var a=this._properties,u=[],l=this._type==="gradient",d=G.instance,_=0,f=a.length;_<f;_++){var c=this._components[_];c!=null&&u.push(a[_]+": "+(l?c:d.number(c)))}return this._alpha!=null&&u.push("alpha: "+d.number(this._alpha)),"{ "+u.join(", ")+" }"},toCSS:function(a){var u=this._convert("rgb"),l=a||this._alpha==null?1:this._alpha;function d(_){return Math.round((_<0?0:_>1?1:_)*255)}return u=[d(u[0]),d(u[1]),d(u[2])],l<1&&u.push(l<0?0:l),a?"#"+((1<<24)+(u[0]<<16)+(u[1]<<8)+u[2]).toString(16).slice(1):(u.length==4?"rgba(":"rgb(")+u.join(",")+")"},toCanvasStyle:function(a,u){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var l=this._components,d=l[0],_=d._stops,f=l[1],c=l[2],S=l[3],v=u&&u.inverted(),P;if(v&&(f=v._transformPoint(f),c=v._transformPoint(c),S&&(S=v._transformPoint(S))),d._radial){var g=c.getDistance(f);if(S){var w=S.subtract(f);w.getLength()>g&&(S=f.add(w.normalize(g-.1)))}var h=S||f;P=a.createRadialGradient(h.x,h.y,0,f.x,f.y,g)}else P=a.createLinearGradient(f.x,f.y,c.x,c.y);for(var p=0,x=_.length;p<x;p++){var E=_[p],y=E._offset;P.addColorStop(y??p/(x-1),E._color.toCanvasStyle())}return this._canvasStyle=P},transform:function(a){if(this._type==="gradient"){for(var u=this._components,l=1,d=u.length;l<d;l++){var _=u[l];a._transformPoint(_,_,!0)}this._changed()}},statics:{_types:e,random:function(){var a=Math.random;return new tt(a(),a(),a())},_setOwner:function(a,u,l){return a&&(a._owner&&u&&a._owner!==u&&(a=a.clone()),!a._owner^!u&&(a._owner=u||null,a._setter=l||null)),a}}})},new function(){var e={add:function(t,n){return t+n},subtract:function(t,n){return t-n},multiply:function(t,n){return t*n},divide:function(t,n){return t/n}};return I.each(e,function(t,n){this[n]=function(i){i=tt.read(arguments);for(var r=this._type,s=this._components,o=i._convert(r),a=0,u=s.length;a<u;a++)o[a]=t(s[a],o[a]);return new tt(r,o,this._alpha!=null?t(this._alpha,i.getAlpha()):null)}},{})}),_n=I.extend({_class:"Gradient",initialize:function(t,n){this._id=ie.get(),t&&I.isPlainObject(t)&&(this.set(t),t=n=null),this._stops==null&&this.setStops(t||["white","black"]),this._radial==null&&this.setRadial(typeof n=="string"&&n==="radial"||n||!1)},_serialize:function(e,t){return t.add(this,function(){return I.serialize([this._stops,this._radial],e,!0,t)})},_changed:function(){for(var e=0,t=this._owners&&this._owners.length;e<t;e++)this._owners[e]._changed()},_addOwner:function(e){this._owners||(this._owners=[]),this._owners.push(e)},_removeOwner:function(e){var t=this._owners?this._owners.indexOf(e):-1;t!=-1&&(this._owners.splice(t,1),this._owners.length||(this._owners=M))},clone:function(){for(var e=[],t=0,n=this._stops.length;t<n;t++)e[t]=this._stops[t].clone();return new _n(e,this._radial)},getStops:function(){return this._stops},setStops:function(e){if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var t=this._stops;if(t)for(var n=0,i=t.length;n<i;n++)t[n]._owner=M;t=this._stops=Ln.readList(e,0,{clone:!0});for(var n=0,i=t.length;n<i;n++)t[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(e){this._radial=e,this._changed()},equals:function(e){if(e===this)return!0;if(e&&this._class===e._class){var t=this._stops,n=e._stops,i=t.length;if(i===n.length){for(var r=0;r<i;r++)if(!t[r].equals(n[r]))return!1;return!0}}return!1}}),Ln=I.extend({_class:"GradientStop",initialize:function(t,n){var i=t,r=n;typeof t=="object"&&n===M&&(Array.isArray(t)&&typeof t[0]!="number"?(i=t[0],r=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(i=t.color,r=t.offset||t.rampPoint||0)),this.setColor(i),this.setOffset(r)},clone:function(){return new Ln(this._color.clone(),this._offset)},_serialize:function(e,t){var n=this._color,i=this._offset;return I.serialize(i==null?[n]:[n,i],e,!0,t)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(e){this._offset=e,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){tt._setOwner(this._color,null),this._color=tt._setOwner(tt.read(arguments,0),this,"setColor"),this._changed()},equals:function(e){return e===this||e&&this._class===e._class&&this._color.equals(e._color)&&this._offset==e._offset||!1}}),On=I.extend(new function(){var e={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new k,selectedColor:null},t=I.set({},e,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),n=I.set({},t,{fillColor:new tt}),i={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},r={beans:!0},s={_class:"Style",beans:!0,initialize:function(a,u,l){this._values={},this._owner=u,this._project=u&&u._project||l||De.project,this._defaults=!u||u instanceof ne?t:u instanceof gn?n:e,a&&this.set(a)}};return I.each(t,function(o,a){var u=/Color$/.test(a),l=a==="shadowOffset",d=I.capitalize(a),_=i[a],f="set"+d,c="get"+d;s[f]=function(S){var v=this._owner,P=v&&v._children,g=P&&P.length>0&&!(v instanceof dt);if(g)for(var w=0,h=P.length;w<h;w++)P[w]._style[f](S);if((a==="selectedColor"||!g)&&a in this._defaults){var p=this._values[a];p!==S&&(u&&(p&&(tt._setOwner(p,null),p._canvasStyle=null),S&&S.constructor===tt&&(S=tt._setOwner(S,v,g&&f))),this._values[a]=S,v&&v._changed(_||129))}},s[c]=function(S){var v=this._owner,P=v&&v._children,g=P&&P.length>0&&!(v instanceof dt),w;if(g&&!S)for(var h=0,p=P.length;h<p;h++){var x=P[h]._style[c]();if(!h)w=x;else if(!I.equals(w,x))return M}else if(a in this._defaults){var w=this._values[a];if(w===M)w=this._defaults[a],w&&w.clone&&(w=w.clone());else{var E=u?tt:l?k:null;E&&!(w&&w.constructor===E)&&(this._values[a]=w=E.read([w],0,{readNull:!0,clone:!0}))}}return w&&u&&(w=tt._setOwner(w,v,g&&f)),w},r[c]=function(S){return this._style[c](S)},r[f]=function(S){this._style[f](S)}}),I.each({Font:"FontFamily",WindingRule:"FillRule"},function(o,a){var u="get"+a,l="set"+a;s[u]=r[u]="#get"+o,s[l]=r[l]="#set"+o}),R.inject(r),s},{set:function(e){var t=e instanceof On,n=t?e._values:e;if(n){for(var i in n)if(i in this._defaults){var r=n[i];this[i]=r&&t&&r.clone?r.clone():r}}},equals:function(e){function t(n,i,r){var s=n._values,o=i._values,a=i._defaults;for(var u in s){var l=s[u],d=o[u];if(!(r&&u in o)&&!I.equals(l,d===M?a[u]:d))return!1}return!0}return e===this||e&&this._class===e._class&&t(this,e)&&t(e,this,!0)||!1},_dispose:function(){var e;e=this.getFillColor(),e&&(e._canvasStyle=null),e=this.getStrokeColor(),e&&(e._canvasStyle=null),e=this.getShadowColor(),e&&(e._canvasStyle=null)},hasFill:function(){var e=this.getFillColor();return!!e&&e.alpha>0},hasStroke:function(){var e=this.getStrokeColor();return!!e&&e.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var e=this.getShadowColor();return!!e&&e.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var e=this.getFontSize();return this.getFontWeight()+" "+e+(/[a-z]/i.test(e+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function e(){var t=e.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),t??n*1.2}}),Ye=new function(){function e(t,n,i,r){for(var s=["","webkit","moz","Moz","ms","o"],o=n[0].toUpperCase()+n.substring(1),a=0;a<6;a++){var u=s[a],l=u?u+o:n;if(l in t){if(i)t[l]=r;else return t[l];break}}}return{getStyles:function(t){var n=t&&t.nodeType!==9?t.ownerDocument:t,i=n&&n.defaultView;return i&&i.getComputedStyle(t,"")},getBounds:function(t,n){var i=t.ownerDocument,r=i.body,s=i.documentElement,o;try{o=t.getBoundingClientRect()}catch{o={left:0,top:0,width:0,height:0}}var a=o.left-(s.clientLeft||r.clientLeft||0),u=o.top-(s.clientTop||r.clientTop||0);if(!n){var l=i.defaultView;a+=l.pageXOffset||s.scrollLeft||r.scrollLeft,u+=l.pageYOffset||s.scrollTop||r.scrollTop}return new V(a,u,o.width,o.height)},getViewportBounds:function(t){var n=t.ownerDocument,i=n.defaultView,r=n.documentElement;return new V(0,0,i.innerWidth||r.clientWidth,i.innerHeight||r.clientHeight)},getOffset:function(t,n){return Ye.getBounds(t,n).getPoint()},getSize:function(t){return Ye.getBounds(t,!0).getSize()},isInvisible:function(t){return Ye.getSize(t).equals(new se(0,0))},isInView:function(t){return!Ye.isInvisible(t)&&Ye.getViewportBounds(t).intersects(Ye.getBounds(t,!0))},isInserted:function(t){return C.body.contains(t)},getPrefixed:function(t,n){return t&&e(t,n)},setPrefixed:function(t,n,i){if(typeof n=="object")for(var r in n)e(t,r,!0,n[r]);else e(t,n,!0,i)}}},nt={add:function(e,t){if(e)for(var n in t)for(var i=t[n],r=n.split(/[\s,]+/g),s=0,o=r.length;s<o;s++){var a=r[s],u=e===C&&(a==="touchstart"||a==="touchmove")?{passive:!1}:!1;e.addEventListener(a,i,u)}},remove:function(e,t){if(e)for(var n in t)for(var i=t[n],r=n.split(/[\s,]+/g),s=0,o=r.length;s<o;s++)e.removeEventListener(r[s],i,!1)},getPoint:function(e){var t=e.targetTouches?e.targetTouches.length?e.targetTouches[0]:e.changedTouches[0]:e;return new k(t.pageX||t.clientX+C.documentElement.scrollLeft,t.pageY||t.clientY+C.documentElement.scrollTop)},getTarget:function(e){return e.target||e.srcElement},getRelatedTarget:function(e){return e.relatedTarget||e.toElement},getOffset:function(e,t){return nt.getPoint(e).subtract(Ye.getOffset(t||nt.getTarget(e)))}};nt.requestAnimationFrame=new function(){var e=Ye.getPrefixed(A,"requestAnimationFrame"),t=!1,n=[],i;function r(){var s=n;n=[];for(var o=0,a=s.length;o<a;o++)s[o]();t=e&&n.length,t&&e(r)}return function(s){n.push(s),e?t||(e(r),t=!0):i||(i=setInterval(r,1e3/60))}};var Xe=I.extend(O,{_class:"View",initialize:function e(t,n){function i(_){return n[_]||parseInt(n.getAttribute(_),10)}function r(){var _=Ye.getSize(n);return _.isNaN()||_.isZero()?new se(i("width"),i("height")):_}var s;if(A&&n){this._id=n.getAttribute("id"),this._id==null&&n.setAttribute("id",this._id="paper-view-"+e._id++),nt.add(n,this._viewEvents);var o="none";if(Ye.setPrefixed(n.style,{userDrag:o,userSelect:o,touchCallout:o,contentZooming:o,tapHighlightColor:"rgba(0,0,0,0)"}),D.hasAttribute(n,"resize")){var a=this;nt.add(A,this._windowEvents={resize:function(){a.setViewSize(r())}})}if(s=r(),D.hasAttribute(n,"stats")&&typeof Stats<"u"){this._stats=new Stats;var u=this._stats.domElement,l=u.style,d=Ye.getOffset(n);l.position="absolute",l.left=d.x+"px",l.top=d.y+"px",C.body.appendChild(u)}}else s=new se(n),n=null;this._project=t,this._scope=t._scope,this._element=n,this._pixelRatio||(this._pixelRatio=A&&A.devicePixelRatio||1),this._setElementSize(s.width,s.height),this._viewSize=s,e._views.push(this),e._viewsById[this._id]=this,(this._matrix=new Q)._owner=this,e._focused||(e._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!De.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Xe._focused===this&&(Xe._focused=null),Xe._views.splice(Xe._views.indexOf(this),1),delete Xe._viewsById[this._id];var e=this._project;return e._view===this&&(e._view=null),nt.remove(this._element,this._viewEvents),nt.remove(A,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:I.each(R._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(e){this[e]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(e){this._autoUpdate=e,e&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var e=this;nt.requestAnimationFrame(function(){if(e._requested=!1,e._animate){e.requestUpdate();var t=e._element;(!Ye.getPrefixed(C,"hidden")||D.getAttribute(t,"keepalive")==="true")&&Ye.isInView(t)&&e._handleFrame()}e._autoUpdate&&e.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){De=this._scope;var e=Date.now()/1e3,t=this._last?e-this._last:0;this._last=e,this.emit("frame",new I({delta:t,time:this._time+=t,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(e,t){var n=this._frameItems;t?(n[e._id]={item:e,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete n[e._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(e){for(var t in this._frameItems){var n=this._frameItems[t];n.item.emit("frame",new I(e,{time:n.time+=e.delta,count:n.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=M},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var e=this._viewSize;return new ae(e.width,e.height,this,"setViewSize")},setViewSize:function(){var e=se.read(arguments),t=e.subtract(this._viewSize);t.isZero()||(this._setElementSize(e.width,e.height),this._viewSize.set(e),this._changed(),this.emit("resize",{size:e,delta:t}),this._autoUpdate&&this.update())},_setElementSize:function(e,t){var n=this._element;n&&(n.width!==e&&(n.width=e),n.height!==t&&(n.height=t))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new V(new k,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ye.isInView(this._element)},isInserted:function(){return Ye.isInserted(this._element)},getPixelSize:function(e){var t=this._element,n;if(t){var i=t.parentNode,r=C.createElement("div");r.style.fontSize=e,i.appendChild(r),n=parseFloat(Ye.getStyles(r).fontSize),i.removeChild(r)}else n=parseFloat(n);return n},getTextWidth:function(e,t){return 0}},I.each(["rotate","scale","shear","skew"],function(e){var t=e==="rotate";this[e]=function(){var n=arguments,i=(t?I:k).read(n),r=k.read(n,0,{readNull:!0});return this.transform(new Q()[e](i,r||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var e=new Q;return this.transform(e.translate.apply(e,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var e=k.read(arguments);this.translate(this.getCenter().subtract(e))},getZoom:function(){var e=this._decompose().scaling;return(e.x+e.y)/2},setZoom:function(e){this.transform(new Q().scale(e/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(e){var t=this.getRotation();t!=null&&e!=null&&this.rotate(e-t)},getScaling:function(){var e=this._decompose().scaling;return new ue(e.x,e.y,this,"setScaling")},setScaling:function(){var e=this.getScaling(),t=k.read(arguments,0,{clone:!0,readNull:!0});e&&t&&this.scale(t.x/e.x,t.y/e.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var e=this._matrix;e.set.apply(e,arguments)},transform:function(e){this._matrix.append(e)},scrollBy:function(){this.translate(k.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(k.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(k.read(arguments))},getEventPoint:function(e){return this.viewToProject(nt.getOffset(e,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(e,t){C&&typeof t=="string"&&(t=C.getElementById(t));var n=A?Ji:Xe;return new n(e,t)}}},new function(){if(!A)return;var e,t,n=!1,i=!1;function r(N){var Z=nt.getTarget(N);return Z.getAttribute&&Xe._viewsById[Z.getAttribute("id")]}function s(){var N=Xe._focused;if(!N||!N.isVisible()){for(var Z=0,J=Xe._views.length;Z<J;Z++)if((N=Xe._views[Z]).isVisible()){Xe._focused=t=N;break}}}function o(N,Z,J){N._handleMouseEvent("mousemove",Z,J)}var a=A.navigator,u,l,d;a.pointerEnabled||a.msPointerEnabled?(u="pointerdown MSPointerDown",l="pointermove MSPointerMove",d="pointerup pointercancel MSPointerUp MSPointerCancel"):(u="touchstart",l="touchmove",d="touchend touchcancel","ontouchstart"in A&&a.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(u+=" mousedown",l+=" mousemove",d+=" mouseup"));var _={},f={mouseout:function(N){var Z=Xe._focused,J=nt.getRelatedTarget(N);if(Z&&(!J||J.nodeName==="HTML")){var ee=nt.getOffset(N,Z._element),te=ee.x,oe=Math.abs,_e=oe(te),me=1<<25,ye=_e-me;ee.x=oe(ye)<_e?ye*(te<0?-1:1):te,o(Z,N,Z.viewToProject(ee))}},scroll:s};_[u]=function(N){var Z=Xe._focused=r(N);n||(n=!0,Z._handleMouseEvent("mousedown",N))},f[l]=function(N){var Z=Xe._focused;if(!i){var J=r(N);J?Z!==J&&(Z&&o(Z,N),e||(e=Z),Z=Xe._focused=t=J):t&&t===Z&&(e&&!e.isInserted()&&(e=null),Z=Xe._focused=e,e=null,s())}Z&&o(Z,N)},f[u]=function(){i=!0},f[d]=function(N){var Z=Xe._focused;Z&&n&&Z._handleMouseEvent("mouseup",N),i=n=!1},nt.add(C,f),nt.add(A,{load:s});var c=!1,S=!1,v={doubleclick:"click",mousedrag:"mousemove"},P=!1,g,w,h,p,x,E,y,z;function F(N,Z,J,ee,te,oe,_e){var me=!1,ye;function Se(ce,de){if(ce.responds(de)){if(ye||(ye=new Ki(de,ee,te,Z||ce,oe?te.subtract(oe):null)),ce.emit(de,ye)&&(c=!0,ye.prevented&&(S=!0),ye.stopped))return me=!0}else{var be=v[de];if(be)return Se(ce,be)}}for(;N&&N!==_e&&!Se(N,J);)N=N._parent;return me}function q(N,Z,J,ee,te,oe){return N._project.removeOn(J),S=c=!1,x&&F(x,null,J,ee,te,oe)||Z&&Z!==x&&!Z.isDescendant(x)&&F(Z,null,J==="mousedrag"?"mousemove":J,ee,te,oe,x)||F(N,x||Z||N,J,ee,te,oe)}var X={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:_,_handleMouseEvent:function(N,Z,J){var ee=this._itemEvents,te=ee.native[N],oe=N==="mousemove",_e=this._scope.tool,me=this;function ye(Te){return ee.virtual[Te]||me.responds(Te)||_e&&_e.responds(Te)}oe&&n&&ye("mousedrag")&&(N="mousedrag"),J||(J=this.getEventPoint(Z));var Se=this.getBounds().contains(J),ce=te&&Se&&me._project.hitTest(J,{tolerance:0,fill:!0,stroke:!0}),de=ce&&ce.item||null,be=!1,xe={};if(xe[N.substr(5)]=!0,te&&de!==p&&(p&&F(p,null,"mouseleave",Z,J),de&&F(de,null,"mouseenter",Z,J),p=de),P^Se&&(F(this,null,Se?"mouseenter":"mouseleave",Z,J),be=!0),(Se||xe.drag)&&!J.equals(w)&&(q(this,de,oe?N:"mousemove",Z,J,w),be=!0),P=Se,xe.down&&Se||xe.up&&g){if(q(this,de,N,Z,J,g),xe.down){if(z=de===E&&Date.now()-y<300,h=E=de,!S&&de){for(var Pe=de;Pe&&!Pe.responds("mousedrag");)Pe=Pe._parent;Pe&&(x=de)}g=J}else xe.up&&(!S&&de===h&&(y=Date.now(),q(this,de,z?"doubleclick":"click",Z,J,g),z=!1),h=x=null);P=!1,be=!0}w=J,be&&_e&&(c=_e._handleMouseEvent(N,Z,J,xe)||c),Z.cancelable!==!1&&(c&&!xe.move||xe.down&&ye("mouseup"))&&Z.preventDefault()},_handleKeyEvent:function(N,Z,J,ee){var te=this._scope,oe=te.tool,_e;function me(ye){ye.responds(N)&&(De=te,ye.emit(N,_e=_e||new Yi(N,Z,J,ee)))}this.isVisible()&&(me(this),oe&&oe.responds(N)&&me(oe))},_countItemEvent:function(N,Z){var J=this._itemEvents,ee=J.native,te=J.virtual;for(var oe in X)ee[oe]=(ee[oe]||0)+(X[oe][N]||0)*Z;te[N]=(te[N]||0)+Z},statics:{updateFocus:s,_resetState:function(){n=i=c=P=!1,e=t=g=w=h=p=x=E=y=z=null}}}}),Ji=Xe.extend({_class:"CanvasView",initialize:function(t,n){if(!(n instanceof A.HTMLCanvasElement)){var i=se.read(arguments,1);if(i.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+I.slice(arguments,1));n=it.getCanvas(i)}var r=this._context=n.getContext("2d");if(r.save(),this._pixelRatio=1,!/^off|false$/.test(D.getAttribute(n,"hidpi"))){var s=A.devicePixelRatio||1,o=Ye.getPrefixed(r,"backingStorePixelRatio")||1;this._pixelRatio=s/o}Xe.call(this,t,n),this._needsUpdate=!0},remove:function e(){return this._context.restore(),e.base.call(this)},_setElementSize:function e(t,n){var i=this._pixelRatio;if(e.base.call(this,t*i,n*i),i!==1){var r=this._element,s=this._context;if(!D.hasAttribute(r,"resize")){var o=r.style;o.width=t+"px",o.height=n+"px"}s.restore(),s.save(),s.scale(i,i)}},getContext:function(){return this._context},getPixelSize:function e(t){var n=De.agent,i;if(n&&n.firefox)i=e.base.call(this,t);else{var r=this._context,s=r.font;r.font=t+" serif",i=parseFloat(r.font),r.font=s}return i},getTextWidth:function(e,t){var n=this._context,i=n.font,r=0;n.font=e;for(var s=0,o=t.length;s<o;s++)r=Math.max(r,n.measureText(t[s]).width);return n.font=i,r},update:function(){if(!this._needsUpdate)return!1;var e=this._project,t=this._context,n=this._viewSize;return t.clearRect(0,0,n.width+1,n.height+1),e&&e.draw(t,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),vn=I.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return ri.modifiers}}),Yi=vn.extend({_class:"KeyEvent",initialize:function(t,n,i,r){this.type=t,this.event=n,this.key=i,this.character=r},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),ri=new function(){var e={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},t={tab:"	",space:" ",enter:"\r"},n={},i={},r,s,o=new I({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var l=De&&De.agent;return l&&l.mac?this.meta:this.control}}});function a(l){var d=l.key||l.keyIdentifier;return d=/^U\+/.test(d)?String.fromCharCode(parseInt(d.substr(2),16)):/^Arrow[A-Z]/.test(d)?d.substr(5):d==="Unidentified"||d===M?String.fromCharCode(l.keyCode):d,e[d]||(d.length>1?I.hyphenate(d):d.toLowerCase())}function u(l,d,_,f){var c=Xe._focused,S;if(n[d]=l,l?i[d]=_:delete i[d],d.length>1&&(S=I.camelize(d))in o){o[S]=l;var v=De&&De.agent;if(S==="meta"&&v&&v.mac)if(l)r={};else{for(var P in r)P in i&&u(!1,P,r[P],f);r=null}}else l&&r&&(r[d]=_);c&&c._handleKeyEvent(l?"keydown":"keyup",f,d,_)}return nt.add(C,{keydown:function(l){var d=a(l),_=De&&De.agent;d.length>1||_&&_.chrome&&(l.altKey||_.mac&&l.metaKey||!_.mac&&l.ctrlKey)?u(!0,d,t[d]||(d.length>1?"":d),l):s=d},keypress:function(l){if(s){var d=a(l),_=l.charCode,f=_>=32?String.fromCharCode(_):d.length>1?"":d;d!==s&&(d=f.toLowerCase()),u(!0,d,f,l),s=null}},keyup:function(l){var d=a(l);d in i&&u(!1,d,i[d],l)}}),nt.add(A,{blur:function(l){for(var d in i)u(!1,d,i[d],l)}}),{modifiers:o,isDown:function(l){return!!n[l]}}},Ki=vn.extend({_class:"MouseEvent",initialize:function(t,n,i,r,s){this.type=t,this.event=n,this.point=i,this.target=r,this.delta=s},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Qi=vn.extend({_class:"ToolEvent",_item:null,initialize:function(t,n,i){this.tool=t,this.type=n,this.event=i},_choosePoint:function(e,t){return e||(t?t.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(e){this._point=e},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(e){this._lastPoint=e},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(e){this._downPoint=e},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(e){this._middlePoint=e},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(e){this._delta=e},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(e){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=e},getItem:function(){if(!this._item){var e=this.tool._scope.project.hitTest(this.getPoint());if(e){for(var t=e.item,n=t._parent;/^(Group|CompoundPath)$/.test(n._class);)t=n,n=n._parent;this._item=t}}return this._item},setItem:function(e){this._item=e},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),$i=U.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){U.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(e){this._minDistance=e,e!=null&&this._maxDistance!=null&&e>this._maxDistance&&(this._maxDistance=e)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(e){this._maxDistance=e,this._minDistance!=null&&e!=null&&e<this._minDistance&&(this._minDistance=e)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(e){this._minDistance=this._maxDistance=e},_handleMouseEvent:function(e,t,n,i){De=this._scope,i.drag&&!this.responds(e)&&(e="mousemove");var r=i.move||i.drag,s=this.responds(e),o=!1,a=this;function u(d,_){var f=n,c=r?a._point:a._downPoint||f;if(r){if(a._moveCount>=0&&f.equals(c))return!1;if(c&&(d!=null||_!=null)){var S=f.subtract(c),v=S.getLength();if(v<(d||0))return!1;_&&(f=c.add(S.normalize(Math.min(v,_))))}a._moveCount++}return a._point=f,a._lastPoint=c||f,i.down&&(a._moveCount=-1,a._downPoint=f,a._downCount++),!0}function l(){s&&(o=a.emit(e,new Qi(a,e,t))||o)}if(i.down)u(),l();else if(i.up)u(null,this._maxDistance),l();else if(s)for(;u(this._minDistance,this._maxDistance);)l();return o}}),er=I.extend(O,{_class:"Tween",statics:{easings:new I({linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:-1+2*(2-e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}})},initialize:function e(t,n,i,r,s,o){this.object=t;var a=typeof s,u=a==="function";this.type=u?a:a==="string"?s:"linear",this.easing=u?s:e.easings[this.type],this.duration=r,this.running=!1,this._then=null,this._startTime=null;var l=n||i;this._keys=l?Object.keys(l):[],this._parsedKeys=this._parseKeys(this._keys),this._from=l&&this._getState(n),this._to=l&&this._getState(i),o!==!1&&this.start()},then:function(e){return this._then=e,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(e){if(this.running){e>=1&&(e=1,this.running=!1);for(var t=this.easing(e),n=this._keys,i=function(d){return typeof d=="function"?d(t,e):d},r=0,s=n&&n.length;r<s;r++){var o=n[r],a=i(this._from[o]),u=i(this._to[o]),l=a&&u&&a.__add&&u.__add?u.__subtract(a).__multiply(t).__add(a):(u-a)*t+a;this._setProperty(this._parsedKeys[o],l)}this.responds("update")&&this.emit("update",new I({progress:e,factor:t})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(e){var t=this._startTime,n=t?(e-t)/this.duration:0;t||(this._startTime=e),this.update(n)},_getState:function(e){for(var t=this._keys,n={},i=0,r=t.length;i<r;i++){var s=t[i],o=this._parsedKeys[s],a=this._getProperty(o),u;if(e){var l=this._resolveValue(a,e[s]);this._setProperty(o,l),u=this._getProperty(o),u=u&&u.clone?u.clone():u,this._setProperty(o,a)}else u=a&&a.clone?a.clone():a;n[s]=u}return n},_resolveValue:function(e,t){if(t){if(Array.isArray(t)&&t.length===2){var n=t[0];return n&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(e,n[0],t[1]):t}else if(typeof t=="string"){var i=t.match(/^[+\-*/]=(.*)/);if(i){var r=JSON.parse(i[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(e,t[0],r)}}}return t},_calculate:function(e,t,n){return De.PaperScript.calculateBinary(e,t,n)},_parseKeys:function(e){for(var t={},n=0,i=e.length;n<i;n++){var r=e[n],s=r.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");t[r]=s.split("/")}return t},_getProperty:function(e,t){for(var n=this.object,i=0,r=e.length-(t||0);i<r&&n;i++)n=n[e[i]];return n},_setProperty:function(e,t){var n=this._getProperty(e,1);n&&(n[e[e.length-1]]=t)}}),si={request:function(e){var t=new T.XMLHttpRequest;return t.open((e.method||"get").toUpperCase(),e.url,I.pick(e.async,!0)),e.mimeType&&t.overrideMimeType(e.mimeType),t.onload=function(){var n=t.status;n===0||n===200?e.onLoad&&e.onLoad.call(t,t.responseText):t.onerror()},t.onerror=function(){var n=t.status,i='Could not load "'+e.url+'" (Status: '+n+")";if(e.onError)e.onError(i,n);else throw new Error(i)},t.send(null)}},it=I.exports.CanvasProvider={canvases:[],getCanvas:function(e,t,n){if(!A)return null;var i,r=!0;typeof e=="object"&&(t=e.height,e=e.width),this.canvases.length?i=this.canvases.pop():(i=C.createElement("canvas"),r=!1);var s=i.getContext("2d",n||{});if(!s)throw new Error("Canvas "+i+" is unable to provide a 2D context.");return i.width===e&&i.height===t?r&&s.clearRect(0,0,e+1,t+1):(i.width=e,i.height=t),s.save(),i},getContext:function(e,t,n){var i=this.getCanvas(e,t,n);return i?i.getContext("2d",n||{}):null},release:function(e){var t=e&&e.canvas?e.canvas:e;t&&t.getContext&&(t.getContext("2d").restore(),this.canvases.push(t))}},zn=new function(){var e=Math.min,t=Math.max,n=Math.abs,i,r,s,o,a,u,l,d,_,f,c;function S(x,E,y){return .2989*x+.587*E+.114*y}function v(x,E,y,q){var F=q-S(x,E,y);_=x+F,f=E+F,c=y+F;var q=S(_,f,c),X=e(_,f,c),N=t(_,f,c);if(X<0){var Z=q-X;_=q+(_-q)*q/Z,f=q+(f-q)*q/Z,c=q+(c-q)*q/Z}if(N>255){var J=255-q,ee=N-q;_=q+(_-q)*J/ee,f=q+(f-q)*J/ee,c=q+(c-q)*J/ee}}function P(x,E,y){return t(x,E,y)-e(x,E,y)}function g(x,E,y,z){var F=[x,E,y],q=t(x,E,y),X=e(x,E,y),N;X=X===x?0:X===E?1:2,q=q===x?0:q===E?1:2,N=e(X,q)===0?t(X,q)===1?2:1:0,F[q]>F[X]?(F[N]=(F[N]-F[X])*z/(F[q]-F[X]),F[q]=z):F[N]=F[q]=0,F[X]=0,_=F[0],f=F[1],c=F[2]}var w={multiply:function(){_=a*i/255,f=u*r/255,c=l*s/255},screen:function(){_=a+i-a*i/255,f=u+r-u*r/255,c=l+s-l*s/255},overlay:function(){_=a<128?2*a*i/255:255-2*(255-a)*(255-i)/255,f=u<128?2*u*r/255:255-2*(255-u)*(255-r)/255,c=l<128?2*l*s/255:255-2*(255-l)*(255-s)/255},"soft-light":function(){var x=i*a/255;_=x+a*(255-(255-a)*(255-i)/255-x)/255,x=r*u/255,f=x+u*(255-(255-u)*(255-r)/255-x)/255,x=s*l/255,c=x+l*(255-(255-l)*(255-s)/255-x)/255},"hard-light":function(){_=i<128?2*i*a/255:255-2*(255-i)*(255-a)/255,f=r<128?2*r*u/255:255-2*(255-r)*(255-u)/255,c=s<128?2*s*l/255:255-2*(255-s)*(255-l)/255},"color-dodge":function(){_=a===0?0:i===255?255:e(255,255*a/(255-i)),f=u===0?0:r===255?255:e(255,255*u/(255-r)),c=l===0?0:s===255?255:e(255,255*l/(255-s))},"color-burn":function(){_=a===255?255:i===0?0:t(0,255-(255-a)*255/i),f=u===255?255:r===0?0:t(0,255-(255-u)*255/r),c=l===255?255:s===0?0:t(0,255-(255-l)*255/s)},darken:function(){_=a<i?a:i,f=u<r?u:r,c=l<s?l:s},lighten:function(){_=a>i?a:i,f=u>r?u:r,c=l>s?l:s},difference:function(){_=a-i,_<0&&(_=-_),f=u-r,f<0&&(f=-f),c=l-s,c<0&&(c=-c)},exclusion:function(){_=a+i*(255-a-a)/255,f=u+r*(255-u-u)/255,c=l+s*(255-l-l)/255},hue:function(){g(i,r,s,P(a,u,l)),v(_,f,c,S(a,u,l))},saturation:function(){g(a,u,l,P(i,r,s)),v(_,f,c,S(a,u,l))},luminosity:function(){v(a,u,l,S(i,r,s))},color:function(){v(i,r,s,S(a,u,l))},add:function(){_=e(a+i,255),f=e(u+r,255),c=e(l+s,255)},subtract:function(){_=t(a-i,0),f=t(u-r,0),c=t(l-s,0)},average:function(){_=(a+i)/2,f=(u+r)/2,c=(l+s)/2},negation:function(){_=255-n(255-i-a),f=255-n(255-r-u),c=255-n(255-s-l)}},h=this.nativeModes=I.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(x){this[x]=!0},{}),p=it.getContext(1,1,{willReadFrequently:!0});p&&(I.each(w,function(x,E){var y=E==="darken",z=!1;p.save();try{p.fillStyle=y?"#300":"#a00",p.fillRect(0,0,1,1),p.globalCompositeOperation=E,p.globalCompositeOperation===E&&(p.fillStyle=y?"#a00":"#300",p.fillRect(0,0,1,1),z=p.getImageData(0,0,1,1).data[0]!==y?170:51)}catch{}p.restore(),h[E]=z}),it.release(p)),this.process=function(x,E,y,z,F){var q=E.canvas,X=x==="normal";if(X||h[x])y.save(),y.setTransform(1,0,0,1,0,0),y.globalAlpha=z,X||(y.globalCompositeOperation=x),y.drawImage(q,F.x,F.y),y.restore();else{var N=w[x];if(!N)return;for(var Z=y.getImageData(F.x,F.y,q.width,q.height),J=Z.data,ee=E.getImageData(0,0,q.width,q.height).data,te=0,oe=J.length;te<oe;te+=4){i=ee[te],a=J[te],r=ee[te+1],u=J[te+1],s=ee[te+2],l=J[te+2],o=ee[te+3],d=J[te+3],N();var _e=o*z/255,me=1-_e;J[te]=_e*_+me*a,J[te+1]=_e*f+me*u,J[te+2]=_e*c+me*l,J[te+3]=o*z+me*d}y.putImageData(Z,F.x,F.y)}}},Ke=new function(){var e="http://www.w3.org/2000/svg",t="http://www.w3.org/2000/xmlns",n="http://www.w3.org/1999/xlink",i={href:n,xlink:t,xmlns:t+"/","xmlns:xlink":t+"/"};function r(a,u,l){return o(C.createElementNS(e,a),u,l)}function s(a,u){var l=i[u],d=l?a.getAttributeNS(l,u):a.getAttribute(u);return d==="null"?null:d}function o(a,u,l){for(var d in u){var _=u[d],f=i[d];typeof _=="number"&&l&&(_=l.number(_)),f?a.setAttributeNS(f,d,_):a.setAttribute(d,_)}return a}return{svg:e,xmlns:t,xlink:n,create:r,get:s,set:o}},ai=I.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(e,t){return!t&&(e instanceof vt||e instanceof he||e instanceof gn)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(e,t){var n=I.capitalize(t),i=e[2];this[t]={type:e[1],property:t,attribute:e[0],toSVG:i,fromSVG:i&&I.each(i,function(r,s){this[r]=s},{}),exportFilter:e[3],get:"get"+n,set:"set"+n}},{});new function(){var e;function t(w,h,p){var x=new I,E=w.getTranslation();if(h){var y;w.isInvertible()?(w=w._shiftless(),y=w._inverseTransform(E),E=null):y=new k,x[p?"cx":"x"]=y.x,x[p?"cy":"y"]=y.y}if(!w.isIdentity()){var z=w.decompose();if(z){var F=[],q=z.rotation,X=z.scaling,N=z.skewing;E&&!E.isZero()&&F.push("translate("+e.point(E)+")"),q&&F.push("rotate("+e.number(q)+")"),(!j.isZero(X.x-1)||!j.isZero(X.y-1))&&F.push("scale("+e.point(X)+")"),N.x&&F.push("skewX("+e.number(N.x)+")"),N.y&&F.push("skewY("+e.number(N.y)+")"),x.transform=F.join(" ")}else x.transform="matrix("+w.getValues().join(",")+")"}return x}function n(w,h){for(var p=t(w._matrix),x=w._children,E=Ke.create("g",p,e),y=0,z=x.length;y<z;y++){var F=x[y],q=P(F,h);if(q)if(F.isClipMask()){var X=Ke.create("clipPath");X.appendChild(q),S(F,X,"clip"),Ke.set(E,{"clip-path":"url(#"+X.id+")"})}else E.appendChild(q)}return E}function i(w,h){var p=t(w._matrix,!0),x=w.getSize(),E=w.getImage();return p.x-=x.width/2,p.y-=x.height/2,p.width=x.width,p.height=x.height,p.href=h.embedImages==!1&&E&&E.src||w.toDataURL(),Ke.create("image",p,e)}function r(w,h){var p=h.matchShapes;if(p){var x=w.toShape(!1);if(x)return s(x)}var E=w._segments,y=E.length,z,F=t(w._matrix);if(p&&y>=2&&!w.hasHandles())if(y>2){z=w._closed?"polygon":"polyline";for(var q=[],X=0;X<y;X++)q.push(e.point(E[X]._point));F.points=q.join(" ")}else{z="line";var N=E[0]._point,Z=E[1]._point;F.set({x1:N.x,y1:N.y,x2:Z.x,y2:Z.y})}else z="path",F.d=w.getPathData(null,h.precision);return Ke.create(z,F,e)}function s(w){var h=w._type,p=w._radius,x=t(w._matrix,!0,h!=="rectangle");if(h==="rectangle"){h="rect";var E=w._size,y=E.width,z=E.height;x.x-=y/2,x.y-=z/2,x.width=y,x.height=z,p.isZero()&&(p=null)}return p&&(h==="circle"?x.r=p:(x.rx=p.width,x.ry=p.height)),Ke.create(h,x,e)}function o(w,h){var p=t(w._matrix),x=w.getPathData(null,h.precision);return x&&(p.d=x),Ke.create("path",p,e)}function a(w,h){var p=t(w._matrix,!0),x=w._definition,E=c(x,"symbol"),y=x._item,z=y.getStrokeBounds();return E||(E=Ke.create("symbol",{viewBox:e.rectangle(z)}),E.appendChild(P(y,h)),S(x,E,"symbol")),p.href="#"+E.id,p.x+=z.x,p.y+=z.y,p.width=z.width,p.height=z.height,p.overflow="visible",Ke.create("use",p,e)}function u(w){var h=c(w,"color");if(!h){var p=w.getGradient(),x=p._radial,E=w.getOrigin(),y=w.getDestination(),z;if(x){z={cx:E.x,cy:E.y,r:E.getDistance(y)};var F=w.getHighlight();F&&(z.fx=F.x,z.fy=F.y)}else z={x1:E.x,y1:E.y,x2:y.x,y2:y.y};z.gradientUnits="userSpaceOnUse",h=Ke.create((x?"radial":"linear")+"Gradient",z,e);for(var q=p._stops,X=0,N=q.length;X<N;X++){var Z=q[X],J=Z._color,ee=J.getAlpha(),te=Z._offset;z={offset:te??X/(N-1)},J&&(z["stop-color"]=J.toCSS(!0)),ee<1&&(z["stop-opacity"]=ee),h.appendChild(Ke.create("stop",z,e))}S(w,h,"color")}return"url(#"+h.id+")"}function l(w){var h=Ke.create("text",t(w._matrix,!0),e);return h.textContent=w._content,h}var d={Group:n,Layer:n,Raster:i,Path:r,Shape:s,CompoundPath:o,SymbolItem:a,PointText:l};function _(w,h,p,x){var E={},y=!x&&w.getParent(),z=[];return w._name!=null&&(E.id=w._name),I.each(ai,function(F){var q=F.get,X=F.type,N=w[q]();if(F.exportFilter?F.exportFilter(w,N):p.reduceAttributes==!1||!y||!I.equals(y[q](),N)){if(X==="color"&&N!=null){var Z=N.getAlpha();Z<1&&(E[F.attribute+"-opacity"]=Z)}X==="style"?z.push(F.attribute+": "+N):E[F.attribute]=N==null?"none":X==="color"?N.gradient?u(N):N.toCSS(!0):X==="array"?N.join(","):X==="lookup"?F.toSVG[N]:N}}),z.length&&(E.style=z.join(";")),E.opacity===1&&delete E.opacity,w._visible||(E.visibility="hidden"),Ke.set(h,E,e)}var f;function c(w,h){return f||(f={ids:{},svgs:{}}),w&&f.svgs[h+"-"+(w._id||w.__id||(w.__id=ie.get("svg")))]}function S(w,h,p){f||c();var x=f.ids[p]=(f.ids[p]||0)+1;h.id=p+"-"+x,f.svgs[p+"-"+(w._id||w.__id)]=h}function v(w,h){var p=w,x=null;if(f){p=w.nodeName.toLowerCase()==="svg"&&w;for(var E in f.svgs)x||(p||(p=Ke.create("svg"),p.appendChild(w)),x=p.insertBefore(Ke.create("defs"),p.firstChild)),x.appendChild(f.svgs[E]);f=null}return h.asString?new T.XMLSerializer().serializeToString(p):p}function P(w,h,p){var x=d[w._class],E=x&&x(w,h);if(E){var y=h.onExport;y&&(E=y(w,E,h)||E);var z=JSON.stringify(w._data);z&&z!=="{}"&&z!=="null"&&E.setAttribute("data-paper-data",z)}return E&&_(w,E,h,p)}function g(w){return w||(w={}),e=new G(w.precision),w}R.inject({exportSVG:function(w){return w=g(w),v(P(this,w,!0),w)}}),W.inject({exportSVG:function(w){w=g(w);var h=this._children,p=this.getView(),x=I.pick(w.bounds,"view"),E=w.matrix||x==="view"&&p._matrix,y=E&&Q.read([E]),z=x==="view"?new V([0,0],p.getViewSize()):x==="content"?R._getBounds(h,y,{stroke:!0}).rect:V.read([x],0,{readNull:!0}),F={version:"1.1",xmlns:Ke.svg,"xmlns:xlink":Ke.xlink};z&&(F.width=z.width,F.height=z.height,(z.x||z.x===0||z.y||z.y===0)&&(F.viewBox=e.rectangle(z)));var q=Ke.create("svg",F,e),X=q;y&&!y.isIdentity()&&(X=q.appendChild(Ke.create("g",t(y),e)));for(var N=0,Z=h.length;N<Z;N++)X.appendChild(P(h[N],w,!0));return v(q,w)}})},new function(){var e={},t;function n(h,p,x,E,y,z){var F=Ke.get(h,p)||z,q=F==null?E?null:x?"":0:x?F:parseFloat(F);return/%\s*$/.test(F)?q/100*(y?1:t[/x|^width/.test(p)?"width":"height"]):q}function i(h,p,x,E,y,z,F){return p=n(h,p||"x",!1,E,y,z),x=n(h,x||"y",!1,E,y,F),E&&(p==null||x==null)?null:new k(p,x)}function r(h,p,x,E,y){return p=n(h,p||"width",!1,E,y),x=n(h,x||"height",!1,E,y),E&&(p==null||x==null)?null:new se(p,x)}function s(h,p,x){return h==="none"?null:p==="number"?parseFloat(h):p==="array"?h?h.split(/[\s,]+/g).map(parseFloat):[]:p==="color"?P(h)||h:p==="lookup"?x[h]:h}function o(h,p,x,E){var y=h.childNodes,z=p==="clippath",F=p==="defs",q=new ne,X=q._project,N=X._currentStyle,Z=[];if(!z&&!F&&(q=v(q,h,E),X._currentStyle=q._style.clone()),E)for(var J=h.querySelectorAll("defs"),ee=0,te=J.length;ee<te;ee++)g(J[ee],x,!1);for(var ee=0,te=y.length;ee<te;ee++){var oe=y[ee],_e;oe.nodeType===1&&!/^defs$/i.test(oe.nodeName)&&(_e=g(oe,x,!1))&&!(_e instanceof Be)&&Z.push(_e)}return q.addChildren(Z),z&&(q=v(q.reduce(),h,E)),X._currentStyle=N,(z||F)&&(q.remove(),q=null),q}function a(h,p){for(var x=h.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),E=[],y=0,z=x.length;y<z;y+=2)E.push(new k(parseFloat(x[y]),parseFloat(x[y+1])));var F=new Fe(E);return p==="polygon"&&F.closePath(),F}function u(h){return vt.create(h.getAttribute("d"))}function l(h,p){var x=(n(h,"href",!0)||"").substring(1),E=p==="radialgradient",y;if(x)y=e[x].getGradient(),y._radial^E&&(y=y.clone(),y._radial=E);else{for(var z=h.childNodes,F=[],q=0,X=z.length;q<X;q++){var N=z[q];N.nodeType===1&&F.push(v(new Ln,N))}y=new _n(F,E)}var Z,J,ee,te=n(h,"gradientUnits",!0)!=="userSpaceOnUse";E?(Z=i(h,"cx","cy",!1,te,"50%","50%"),J=Z.add(n(h,"r",!1,!1,te,"50%"),0),ee=i(h,"fx","fy",!0,te)):(Z=i(h,"x1","y1",!1,te,"0%","0%"),J=i(h,"x2","y2",!1,te,"100%","0%"));var oe=v(new tt(y,Z,J,ee),h);return oe._scaleToBounds=te,null}var d={"#document":function(h,p,x,E){for(var y=h.childNodes,z=0,F=y.length;z<F;z++){var q=y[z];if(q.nodeType===1)return g(q,x,E)}},g:o,svg:o,clippath:o,polygon:a,polyline:a,path:u,lineargradient:l,radialgradient:l,image:function(h){var p=new ve(n(h,"href",!0));return p.on("load",function(){var x=r(h);this.setSize(x);var E=i(h).add(x.divide(2));this._matrix.append(new Q().translate(E))}),p},symbol:function(h,p,x,E){return new Be(o(h,p,x,E),!0)},defs:o,use:function(h){var p=(n(h,"href",!0)||"").substring(1),x=e[p],E=i(h);return x?x instanceof Be?x.place(E):x.clone().translate(E):null},circle:function(h){return new he.Circle(i(h,"cx","cy"),n(h,"r"))},ellipse:function(h){return new he.Ellipse({center:i(h,"cx","cy"),radius:r(h,"rx","ry")})},rect:function(h){return new he.Rectangle(new V(i(h),r(h)),r(h,"rx","ry"))},line:function(h){return new Fe.Line(i(h,"x1","y1"),i(h,"x2","y2"))},text:function(h){var p=new Xi(i(h).add(i(h,"dx","dy")));return p.setContent(h.textContent.trim()||""),p},switch:o};function _(h,p,x,E){if(h.transform){for(var y=(E.getAttribute(x)||"").split(/\)\s*/g),z=new Q,F=0,q=y.length;F<q;F++){var X=y[F];if(!X)break;for(var N=X.split(/\(\s*/),Z=N[0].trim(),J=N[1].split(/[\s,]+/g),ee=0,te=J.length;ee<te;ee++)J[ee]=parseFloat(J[ee]);switch(Z){case"matrix":z.append(new Q(J[0],J[1],J[2],J[3],J[4],J[5]));break;case"rotate":z.rotate(J[0],J[1]||0,J[2]||0);break;case"translate":z.translate(J[0],J[1]||0);break;case"scale":z.scale(J);break;case"skewX":z.skew(J[0],0);break;case"skewY":z.skew(0,J[0]);break}}h.transform(z)}}function f(h,p,x){var E=x==="fill-opacity"?"getFillColor":"getStrokeColor",y=h[E]&&h[E]();y&&y.setAlpha(parseFloat(p))}var c=I.set(I.each(ai,function(h){this[h.attribute]=function(p,x){if(p[h.set]&&(p[h.set](s(x,h.type,h.fromSVG)),h.type==="color")){var E=p[h.get]();if(E&&E._scaleToBounds){var y=p.getBounds();E.transform(new Q().translate(y.getPoint()).scale(y.getSize()))}}}},{}),{id:function(h,p){e[p]=h,h.setName&&h.setName(p)},"clip-path":function(h,p){var x=P(p);if(x)if(x=x.clone(),x.setClipMask(!0),h instanceof ne)h.insertChild(0,x);else return new ne(x,h)},gradientTransform:_,transform:_,"fill-opacity":f,"stroke-opacity":f,visibility:function(h,p){h.setVisible&&h.setVisible(p==="visible")},display:function(h,p){h.setVisible&&h.setVisible(p!==null)},"stop-color":function(h,p){h.setColor&&h.setColor(p)},"stop-opacity":function(h,p){h._color&&h._color.setAlpha(parseFloat(p))},offset:function(h,p){if(h.setOffset){var x=p.match(/(.*)%$/);h.setOffset(x?x[1]/100:parseFloat(p))}},viewBox:function(h,p,x,E,y){var z=new V(s(p,"array")),F=r(E,null,null,!0),q,X;if(h instanceof ne){var N=F?F.divide(z.getSize()):1,X=new Q().scale(N).translate(z.getPoint().negate());q=h}else h instanceof Be&&(F&&z.setSize(F),q=h._item);if(q){if(S(E,"overflow",y)!=="visible"){var Z=new he.Rectangle(z);Z.setClipMask(!0),q.addChild(Z)}X&&q.transform(X)}}});function S(h,p,x){var E=h.attributes[p],y=E&&E.value;if(!y&&h.style){var z=I.camelize(p);y=h.style[z],!y&&x.node[z]!==x.parent[z]&&(y=x.node[z])}return y?y==="none"?null:y:M}function v(h,p,x){var E=p.parentNode,y={node:Ye.getStyles(p)||{},parent:!x&&!/^defs$/i.test(E.tagName)&&Ye.getStyles(E)||{}};return I.each(c,function(z,F){var q=S(p,F,y);h=q!==M&&z(h,q,F,p,y)||h}),h}function P(h){var p=h&&h.match(/\((?:["'#]*)([^"')]+)/),x=p&&p[1],E=x&&e[A?x.replace(A.location.href.split("#")[0]+"#",""):x];return E&&E._scaleToBounds&&(E=E.clone(),E._scaleToBounds=!0),E}function g(h,p,x){var E=h.nodeName.toLowerCase(),y=E!=="#document",z=C.body,F,q,X;x&&y&&(t=De.getView().getSize(),t=r(h,null,null,!0)||t,F=Ke.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),q=h.parentNode,X=h.nextSibling,F.appendChild(h),z.appendChild(F));var N=De.settings,Z=N.applyMatrix,J=N.insertItems;N.applyMatrix=!1,N.insertItems=!1;var ee=d[E],te=ee&&ee(h,E,p,x)||null;if(N.insertItems=J,N.applyMatrix=Z,te){y&&!(te instanceof ne)&&(te=v(te,h,x));var oe=p.onImport,_e=y&&h.getAttribute("data-paper-data");oe&&(te=oe(h,te,p)||te),p.expandShapes&&te instanceof he&&(te.remove(),te=te.toPath()),_e&&(te._data=JSON.parse(_e))}return F&&(z.removeChild(F),q&&(X?q.insertBefore(h,X):q.appendChild(h))),x&&(e={},te&&I.pick(p.applyMatrix,Z)&&te.matrix.apply(!0,!0)),te}function w(h,p,x){if(!h)return null;p=typeof p=="function"?{onLoad:p}:p||{};var E=De,y=null;function z(N){try{var Z=typeof N=="object"?N:new T.DOMParser().parseFromString(N.trim(),"image/svg+xml");if(!Z.nodeName)throw Z=null,new Error("Unsupported SVG source: "+h);De=E,y=g(Z,p,!0),(!p||p.insert!==!1)&&x._insertItem(M,y);var J=p.onLoad;J&&J(y,N)}catch(ee){F(ee)}}function F(N,Z){var J=p.onError;if(J)J(N,Z);else throw new Error(N)}if(typeof h=="string"&&!/^[\s\S]*</.test(h)){var q=C.getElementById(h);q?z(q):si.request({url:h,async:!0,onLoad:z,onError:F})}else if(typeof File<"u"&&h instanceof File){var X=new FileReader;return X.onload=function(){z(X.result)},X.onerror=function(){F(X.error)},X.readAsText(h)}else z(h);return y}R.inject({importSVG:function(h,p){return w(h,p,this)}}),W.inject({importSVG:function(h,p){return this.activate(),w(h,p,this)}})},I.exports.PaperScript=(function(){var e=this,t=e.acorn;if(!t&&typeof Nr<"u")try{t=require("acorn")}catch{}if(!t){var n,i;t=n=i={},(function(v,P){if(typeof n=="object"&&typeof i=="object")return P(n);if(typeof M=="function"&&M.amd)return M(["exports"],P);P(v.acorn||(v.acorn={}))})(this,function(v){v.version="0.5.0";var P,g,w,h;v.parse=function(H,K){return g=String(H),w=g.length,x(K),yi(),Er(P.program)};var p=v.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function x(H){P=H||{};for(var K in p)Object.prototype.hasOwnProperty.call(P,K)||(P[K]=p[K]);h=P.sourceFile||null}var E=v.getLineInfo=function(H,K){for(var le=1,ge=0;;){Yt.lastIndex=ge;var ke=Yt.exec(H);if(ke&&ke.index<K)++le,ge=ke.index+ke[0].length;else break}return{line:le,column:K-ge}};v.tokenize=function(H,K){g=String(H),w=g.length,x(K),yi();var le={};function ge(ke){return _e=F,Zt(ke),le.start=z,le.end=F,le.startLoc=q,le.endLoc=X,le.type=N,le.value=Z,le}return ge.jumpTo=function(ke,Ae){if(y=ke,P.locations){ee=1,te=Yt.lastIndex=0;for(var ze;(ze=Yt.exec(g))&&ze.index<ke;)++ee,te=ze.index+ze[0].length}J=Ae,Kt()},ge};var y,z,F,q,X,N,Z,J,ee,te,oe,_e,me,ye,Se,ce;function de(H,K){var le=E(g,H);K+=" ("+le.line+":"+le.column+")";var ge=new SyntaxError(K);throw ge.pos=H,ge.loc=le,ge.raisedAt=y,ge}var be=[],xe={type:"num"},Pe={type:"regexp"},Te={type:"string"},Ee={type:"name"},Oe={type:"eof"},Re={keyword:"break"},Le={keyword:"case",beforeExpr:!0},rt={keyword:"catch"},st={keyword:"continue"},lt={keyword:"debugger"},Qe={keyword:"default"},He={keyword:"do",isLoop:!0},$e={keyword:"else",beforeExpr:!0},gt={keyword:"finally"},at={keyword:"for",isLoop:!0},mt={keyword:"function"},Ot={keyword:"if"},wt={keyword:"return",beforeExpr:!0},yt={keyword:"switch"},_t={keyword:"throw",beforeExpr:!0},pt={keyword:"try"},zt={keyword:"var"},bt={keyword:"while",isLoop:!0},pn={keyword:"with"},oi={keyword:"new",beforeExpr:!0},ui={keyword:"this"},li={keyword:"null",atomValue:null},hi={keyword:"true",atomValue:!0},ci={keyword:"false",atomValue:!1},mn={keyword:"in",binop:7,beforeExpr:!0},Rn={break:Re,case:Le,catch:rt,continue:st,debugger:lt,default:Qe,do:He,else:$e,finally:gt,for:at,function:mt,if:Ot,return:wt,switch:yt,throw:_t,try:pt,var:zt,while:bt,with:pn,null:li,true:hi,false:ci,new:oi,in:mn,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:ui,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},wn={type:"[",beforeExpr:!0},yn={type:"]"},Xt={type:"{",beforeExpr:!0},Ut={type:"}"},xt={type:"(",beforeExpr:!0},Ct={type:")"},kt={type:",",beforeExpr:!0},Mt={type:";",beforeExpr:!0},Jt={type:":",beforeExpr:!0},Bn={type:"."},Nn={type:"?",beforeExpr:!0},Fn={binop:10,beforeExpr:!0},Dn={isAssign:!0,beforeExpr:!0},Ht={isAssign:!0,beforeExpr:!0},tr={postfix:!0,prefix:!0,isUpdate:!0},fi={prefix:!0,beforeExpr:!0},di={binop:1,beforeExpr:!0},gi={binop:2,beforeExpr:!0},nr={binop:3,beforeExpr:!0},ir={binop:4,beforeExpr:!0},rr={binop:5,beforeExpr:!0},sr={binop:6,beforeExpr:!0},ar={binop:7,beforeExpr:!0},or={binop:8,beforeExpr:!0},ur={binop:9,prefix:!0,beforeExpr:!0},lr={binop:10,beforeExpr:!0};v.tokTypes={bracketL:wn,bracketR:yn,braceL:Xt,braceR:Ut,parenL:xt,parenR:Ct,comma:kt,semi:Mt,colon:Jt,dot:Bn,question:Nn,slash:Fn,eq:Dn,name:Ee,eof:Oe,num:xe,regexp:Pe,string:Te};for(var _i in Rn)v.tokTypes["_"+_i]=Rn[_i];function rn(H){H=H.split(" ");var K="",le=[];e:for(var ge=0;ge<H.length;++ge){for(var ke=0;ke<le.length;++ke)if(le[ke][0].length==H[ge].length){le[ke].push(H[ge]);continue e}le.push([H[ge]])}function Ae(Ue){if(Ue.length==1)return K+="return str === "+JSON.stringify(Ue[0])+";";K+="switch(str){";for(var Pt=0;Pt<Ue.length;++Pt)K+="case "+JSON.stringify(Ue[Pt])+":";K+="return true}return false;"}if(le.length>3){le.sort(function(Ue,Pt){return Pt.length-Ue.length}),K+="switch(str.length){";for(var ge=0;ge<le.length;++ge){var ze=le[ge];K+="case "+ze[0].length+":",Ae(ze)}K+="}"}else Ae(H);return new Function("str",K)}var hr=rn("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),cr=rn("class enum extends super const export import"),vi=rn("implements interface let package private protected public static yield"),bn=rn("eval arguments"),fr=rn("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),dr=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,pi="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",gr="------------------------------------------------------------------------------------------------------------------------------------------",mi=new RegExp("["+pi+"]"),_r=new RegExp("["+pi+gr+"]"),Cn=/[\n\r\u2028\u2029]/,Yt=/\r\n|[\n\r\u2028\u2029]/g,Sn=v.isIdentifierStart=function(H){return H<65?H===36:H<91?!0:H<97?H===95:H<123?!0:H>=170&&mi.test(String.fromCharCode(H))},wi=v.isIdentifierChar=function(H){return H<48?H===36:H<58?!0:H<65?!1:H<91?!0:H<97?H===95:H<123?!0:H>=170&&_r.test(String.fromCharCode(H))};function jt(){this.line=ee,this.column=y-te}function yi(){ee=1,y=te=0,J=!0,Kt()}function ot(H,K){F=y,P.locations&&(X=new jt),N=H,Kt(),Z=K,J=H.beforeExpr}function vr(){var H=P.onComment&&P.locations&&new jt,K=y,le=g.indexOf("*/",y+=2);if(le===-1&&de(y-2,"Unterminated comment"),y=le+2,P.locations){Yt.lastIndex=K;for(var ge;(ge=Yt.exec(g))&&ge.index<y;)++ee,te=ge.index+ge[0].length}P.onComment&&P.onComment(!0,g.slice(K+2,le),K,y,H,P.locations&&new jt)}function qn(){for(var H=y,K=P.onComment&&P.locations&&new jt,le=g.charCodeAt(y+=2);y<w&&le!==10&&le!==13&&le!==8232&&le!==8233;)++y,le=g.charCodeAt(y);P.onComment&&P.onComment(!1,g.slice(H+2,y),H,y,K,P.locations&&new jt)}function Kt(){for(;y<w;){var H=g.charCodeAt(y);if(H===32)++y;else if(H===13){++y;var K=g.charCodeAt(y);K===10&&++y,P.locations&&(++ee,te=y)}else if(H===10||H===8232||H===8233)++y,P.locations&&(++ee,te=y);else if(H>8&&H<14)++y;else if(H===47){var K=g.charCodeAt(y+1);if(K===42)vr();else if(K===47)qn();else break}else if(H===160)++y;else if(H>=5760&&dr.test(String.fromCharCode(H)))++y;else break}}function pr(){var H=g.charCodeAt(y+1);return H>=48&&H<=57?Ci(!0):(++y,ot(Bn))}function mr(){var H=g.charCodeAt(y+1);return J?(++y,bi()):H===61?ut(Ht,2):ut(Fn,1)}function wr(){var H=g.charCodeAt(y+1);return H===61?ut(Ht,2):ut(lr,1)}function yr(H){var K=g.charCodeAt(y+1);return K===H?ut(H===124?di:gi,2):K===61?ut(Ht,2):ut(H===124?nr:rr,1)}function br(){var H=g.charCodeAt(y+1);return H===61?ut(Ht,2):ut(ir,1)}function Cr(H){var K=g.charCodeAt(y+1);return K===H?K==45&&g.charCodeAt(y+2)==62&&Cn.test(g.slice(_e,y))?(y+=3,qn(),Kt(),Zt()):ut(tr,2):K===61?ut(Ht,2):ut(ur,1)}function Sr(H){var K=g.charCodeAt(y+1),le=1;return K===H?(le=H===62&&g.charCodeAt(y+2)===62?3:2,g.charCodeAt(y+le)===61?ut(Ht,le+1):ut(or,le)):K==33&&H==60&&g.charCodeAt(y+2)==45&&g.charCodeAt(y+3)==45?(y+=4,qn(),Kt(),Zt()):(K===61&&(le=g.charCodeAt(y+2)===61?3:2),ut(ar,le))}function Pr(H){var K=g.charCodeAt(y+1);return K===61?ut(sr,g.charCodeAt(y+2)===61?3:2):ut(H===61?Dn:fi,1)}function xr(H){switch(H){case 46:return pr();case 40:return++y,ot(xt);case 41:return++y,ot(Ct);case 59:return++y,ot(Mt);case 44:return++y,ot(kt);case 91:return++y,ot(wn);case 93:return++y,ot(yn);case 123:return++y,ot(Xt);case 125:return++y,ot(Ut);case 58:return++y,ot(Jt);case 63:return++y,ot(Nn);case 48:var K=g.charCodeAt(y+1);if(K===120||K===88)return Mr();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Ci(!1);case 34:case 39:return Ir(H);case 47:return mr();case 37:case 42:return wr();case 124:case 38:return yr(H);case 94:return br();case 43:case 45:return Cr(H);case 60:case 62:return Sr(H);case 61:case 33:return Pr(H);case 126:return ut(fi,1)}return!1}function Zt(H){if(H?y=z+1:z=y,P.locations&&(q=new jt),H)return bi();if(y>=w)return ot(Oe);var K=g.charCodeAt(y);if(Sn(K)||K===92)return Pi();var le=xr(K);if(le===!1){var ge=String.fromCharCode(K);if(ge==="\\"||mi.test(ge))return Pi();de(y,"Unexpected character '"+ge+"'")}return le}function ut(H,K){var le=g.slice(y,y+K);y+=K,ot(H,le)}function bi(){for(var ke="",H,K,le=y;;){y>=w&&de(le,"Unterminated regular expression");var ge=g.charAt(y);if(Cn.test(ge)&&de(le,"Unterminated regular expression"),H)H=!1;else{if(ge==="[")K=!0;else if(ge==="]"&&K)K=!1;else if(ge==="/"&&!K)break;H=ge==="\\"}++y}var ke=g.slice(le,y);++y;var Ae=Si();Ae&&!/^[gmsiy]*$/.test(Ae)&&de(le,"Invalid regexp flag");try{var ze=new RegExp(ke,Ae)}catch(Ue){Ue instanceof SyntaxError&&de(le,Ue.message),de(Ue)}return ot(Pe,ze)}function sn(H,K){for(var le=y,ge=0,ke=0,Ae=K??1/0;ke<Ae;++ke){var ze=g.charCodeAt(y),Ue;if(ze>=97?Ue=ze-97+10:ze>=65?Ue=ze-65+10:ze>=48&&ze<=57?Ue=ze-48:Ue=1/0,Ue>=H)break;++y,ge=ge*H+Ue}return y===le||K!=null&&y-le!==K?null:ge}function Mr(){y+=2;var H=sn(16);return H==null&&de(z+2,"Expected hexadecimal number"),Sn(g.charCodeAt(y))&&de(y,"Identifier directly after number"),ot(xe,H)}function Ci(H){var K=y,le=!1,ge=g.charCodeAt(y)===48;!H&&sn(10)===null&&de(K,"Invalid number"),g.charCodeAt(y)===46&&(++y,sn(10),le=!0);var ke=g.charCodeAt(y);(ke===69||ke===101)&&(ke=g.charCodeAt(++y),(ke===43||ke===45)&&++y,sn(10)===null&&de(K,"Invalid number"),le=!0),Sn(g.charCodeAt(y))&&de(y,"Identifier directly after number");var Ae=g.slice(K,y),ze;return le?ze=parseFloat(Ae):!ge||Ae.length===1?ze=parseInt(Ae,10):/[89]/.test(Ae)||ce?de(K,"Invalid number"):ze=parseInt(Ae,8),ot(xe,ze)}function Ir(H){y++;for(var K="";;){y>=w&&de(z,"Unterminated string constant");var le=g.charCodeAt(y);if(le===H)return++y,ot(Te,K);if(le===92){le=g.charCodeAt(++y);var ge=/^[0-7]+/.exec(g.slice(y,y+3));for(ge&&(ge=ge[0]);ge&&parseInt(ge,8)>255;)ge=ge.slice(0,-1);if(ge==="0"&&(ge=null),++y,ge)ce&&de(y-2,"Octal literal in strict mode"),K+=String.fromCharCode(parseInt(ge,8)),y+=ge.length-1;else switch(le){case 110:K+=`
`;break;case 114:K+="\r";break;case 120:K+=String.fromCharCode(Pn(2));break;case 117:K+=String.fromCharCode(Pn(4));break;case 85:K+=String.fromCharCode(Pn(8));break;case 116:K+="	";break;case 98:K+="\b";break;case 118:K+="\v";break;case 102:K+="\f";break;case 48:K+="\0";break;case 13:g.charCodeAt(y)===10&&++y;case 10:P.locations&&(te=y,++ee);break;default:K+=String.fromCharCode(le);break}}else(le===13||le===10||le===8232||le===8233)&&de(z,"Unterminated string constant"),K+=String.fromCharCode(le),++y}}function Pn(H){var K=sn(16,H);return K===null&&de(z,"Bad character escape sequence"),K}var Qt;function Si(){Qt=!1;for(var H,K=!0,le=y;;){var ge=g.charCodeAt(y);if(wi(ge))Qt&&(H+=g.charAt(y)),++y;else if(ge===92){Qt||(H=g.slice(le,y)),Qt=!0,g.charCodeAt(++y)!=117&&de(y,"Expecting Unicode escape sequence \\uXXXX"),++y;var ke=Pn(4),Ae=String.fromCharCode(ke);Ae||de(y-1,"Invalid Unicode escape"),(K?Sn(ke):wi(ke))||de(y-4,"Invalid Unicode escape"),H+=Ae}else break;K=!1}return Qt?H:g.slice(le,y)}function Pi(){var H=Si(),K=Ee;return!Qt&&fr(H)&&(K=Rn[H]),ot(K,H)}function qe(){oe=z,_e=F,me=X,Zt()}function Vn(H){if(ce=H,y=z,P.locations)for(;y<te;)te=g.lastIndexOf(`
`,te-2)+1,--ee;Kt(),Zt()}function xi(){this.type=null,this.start=z,this.end=null}function Mi(){this.start=q,this.end=null,h!==null&&(this.source=h)}function ht(){var H=new xi;return P.locations&&(H.loc=new Mi),P.directSourceFile&&(H.sourceFile=P.directSourceFile),P.ranges&&(H.range=[z,0]),H}function Rt(H){var K=new xi;return K.start=H.start,P.locations&&(K.loc=new Mi,K.loc.start=H.loc.start),P.ranges&&(K.range=[H.range[0],0]),K}function Ne(H,K){return H.type=K,H.end=_e,P.locations&&(H.loc.end=me),P.ranges&&(H.range[1]=_e),H}function Un(H){return P.ecmaVersion>=5&&H.type==="ExpressionStatement"&&H.expression.type==="Literal"&&H.expression.value==="use strict"}function We(H){if(N===H)return qe(),!0}function xn(){return!P.strictSemicolons&&(N===Oe||N===Ut||Cn.test(g.slice(_e,z)))}function Gt(){!We(Mt)&&!xn()&&At()}function et(H){N===H?qe():At()}function At(){de(z,"Unexpected token")}function Mn(H){H.type!=="Identifier"&&H.type!=="MemberExpression"&&de(H.start,"Assigning to rvalue"),ce&&H.type==="Identifier"&&bn(H.name)&&de(H.start,"Assigning to "+H.name+" in strict mode")}function Er(H){oe=_e=y,P.locations&&(me=new jt),ye=ce=null,Se=[],Zt();var K=H||ht(),le=!0;for(H||(K.body=[]);N!==Oe;){var ge=St();K.body.push(ge),le&&Un(ge)&&Vn(!0),le=!1}return Ne(K,"Program")}var Hn={kind:"loop"},Tr={kind:"switch"};function St(){(N===Fn||N===Ht&&Z=="/=")&&Zt(!0);var H=N,K=ht();switch(H){case Re:case st:qe();var le=H===Re;We(Mt)||xn()?K.label=null:N!==Ee?At():(K.label=Bt(),Gt());for(var ge=0;ge<Se.length;++ge){var ke=Se[ge];if((K.label==null||ke.name===K.label.name)&&(ke.kind!=null&&(le||ke.kind==="loop")||K.label&&le))break}return ge===Se.length&&de(K.start,"Unsyntactic "+H.keyword),Ne(K,le?"BreakStatement":"ContinueStatement");case lt:return qe(),Gt(),Ne(K,"DebuggerStatement");case He:return qe(),Se.push(Hn),K.body=St(),Se.pop(),et(bt),K.test=an(),Gt(),Ne(K,"DoWhileStatement");case at:if(qe(),Se.push(Hn),et(xt),N===Mt)return jn(K,null);if(N===zt){var Ae=ht();return qe(),Ei(Ae,!0),Ne(Ae,"VariableDeclaration"),Ae.declarations.length===1&&We(mn)?Ii(K,Ae):jn(K,Ae)}var Ae=ct(!1,!0);return We(mn)?(Mn(Ae),Ii(K,Ae)):jn(K,Ae);case mt:return qe(),Jn(K,!0);case Ot:return qe(),K.test=an(),K.consequent=St(),K.alternate=We($e)?St():null,Ne(K,"IfStatement");case wt:return!ye&&!P.allowReturnOutsideFunction&&de(z,"'return' outside of function"),qe(),We(Mt)||xn()?K.argument=null:(K.argument=ct(),Gt()),Ne(K,"ReturnStatement");case yt:qe(),K.discriminant=an(),K.cases=[],et(Xt),Se.push(Tr);for(var ze,Ue;N!=Ut;)if(N===Le||N===Qe){var Pt=N===Le;ze&&Ne(ze,"SwitchCase"),K.cases.push(ze=ht()),ze.consequent=[],qe(),Pt?ze.test=ct():(Ue&&de(oe,"Multiple default clauses"),Ue=!0,ze.test=null),et(Jt)}else ze||At(),ze.consequent.push(St());return ze&&Ne(ze,"SwitchCase"),qe(),Se.pop(),Ne(K,"SwitchStatement");case _t:return qe(),Cn.test(g.slice(_e,z))&&de(_e,"Illegal newline after throw"),K.argument=ct(),Gt(),Ne(K,"ThrowStatement");case pt:if(qe(),K.block=on(),K.handler=null,N===rt){var Wt=ht();qe(),et(xt),Wt.param=Bt(),ce&&bn(Wt.param.name)&&de(Wt.param.start,"Binding "+Wt.param.name+" in strict mode"),et(Ct),Wt.guard=null,Wt.body=on(),K.handler=Ne(Wt,"CatchClause")}return K.guardedHandlers=be,K.finalizer=We(gt)?on():null,!K.handler&&!K.finalizer&&de(K.start,"Missing catch or finally clause"),Ne(K,"TryStatement");case zt:return qe(),Ei(K),Gt(),Ne(K,"VariableDeclaration");case bt:return qe(),K.test=an(),Se.push(Hn),K.body=St(),Se.pop(),Ne(K,"WhileStatement");case pn:return ce&&de(z,"'with' in strict mode"),qe(),K.object=an(),K.body=St(),Ne(K,"WithStatement");case Xt:return on();case Mt:return qe(),Ne(K,"EmptyStatement");default:var Kn=Z,In=ct();if(H===Ee&&In.type==="Identifier"&&We(Jt)){for(var ge=0;ge<Se.length;++ge)Se[ge].name===Kn&&de(In.start,"Label '"+Kn+"' is already declared");var Rr=N.isLoop?"loop":N===yt?"switch":null;return Se.push({name:Kn,kind:Rr}),K.body=St(),Se.pop(),K.label=In,Ne(K,"LabeledStatement")}else return K.expression=In,Gt(),Ne(K,"ExpressionStatement")}}function an(){et(xt);var H=ct();return et(Ct),H}function on(H){var K=ht(),le=!0,ge=!1,ke;for(K.body=[],et(Xt);!We(Ut);){var Ae=St();K.body.push(Ae),le&&H&&Un(Ae)&&(ke=ge,Vn(ge=!0)),le=!1}return ge&&!ke&&Vn(!1),Ne(K,"BlockStatement")}function jn(H,K){return H.init=K,et(Mt),H.test=N===Mt?null:ct(),et(Mt),H.update=N===Ct?null:ct(),et(Ct),H.body=St(),Se.pop(),Ne(H,"ForStatement")}function Ii(H,K){return H.left=K,H.right=ct(),et(Ct),H.body=St(),Se.pop(),Ne(H,"ForInStatement")}function Ei(H,K){for(H.declarations=[],H.kind="var";;){var le=ht();if(le.id=Bt(),ce&&bn(le.id.name)&&de(le.id.start,"Binding "+le.id.name+" in strict mode"),le.init=We(Dn)?ct(!0,K):null,H.declarations.push(Ne(le,"VariableDeclarator")),!We(kt))break}return H}function ct(H,K){var le=Zn(K);if(!H&&N===kt){var ge=Rt(le);for(ge.expressions=[le];We(kt);)ge.expressions.push(Zn(K));return Ne(ge,"SequenceExpression")}return le}function Zn(H){var K=kr(H);if(N.isAssign){var le=Rt(K);return le.operator=Z,le.left=K,qe(),le.right=Zn(H),Mn(K),Ne(le,"AssignmentExpression")}return K}function kr(H){var K=Ar(H);if(We(Nn)){var le=Rt(K);return le.test=K,le.consequent=ct(!0),et(Jt),le.alternate=ct(!0,H),Ne(le,"ConditionalExpression")}return K}function Ar(H){return Gn(Wn(),-1,H)}function Gn(H,K,le){var ge=N.binop;if(ge!=null&&(!le||N!==mn)&&ge>K){var ke=Rt(H);ke.left=H,ke.operator=Z;var Ae=N;qe(),ke.right=Gn(Wn(),ge,le);var ze=Ne(ke,Ae===di||Ae===gi?"LogicalExpression":"BinaryExpression");return Gn(ze,K,le)}return H}function Wn(){if(N.prefix){var H=ht(),K=N.isUpdate;return H.operator=Z,H.prefix=!0,J=!0,qe(),H.argument=Wn(),K?Mn(H.argument):ce&&H.operator==="delete"&&H.argument.type==="Identifier"&&de(H.start,"Deleting local variable in strict mode"),Ne(H,K?"UpdateExpression":"UnaryExpression")}for(var le=Lr();N.postfix&&!xn();){var H=Rt(le);H.operator=Z,H.prefix=!1,H.argument=le,Mn(le),qe(),le=Ne(H,"UpdateExpression")}return le}function Lr(){return un(Xn())}function un(H,K){if(We(Bn)){var le=Rt(H);return le.object=H,le.property=Bt(!0),le.computed=!1,un(Ne(le,"MemberExpression"),K)}else if(We(wn)){var le=Rt(H);return le.object=H,le.property=ct(),le.computed=!0,et(yn),un(Ne(le,"MemberExpression"),K)}else if(!K&&We(xt)){var le=Rt(H);return le.callee=H,le.arguments=Yn(Ct,!1),un(Ne(le,"CallExpression"),K)}else return H}function Xn(){switch(N){case ui:var ge=ht();return qe(),Ne(ge,"ThisExpression");case Ee:return Bt();case xe:case Te:case Pe:var ge=ht();return ge.value=Z,ge.raw=g.slice(z,F),qe(),Ne(ge,"Literal");case li:case hi:case ci:var ge=ht();return ge.value=N.atomValue,ge.raw=N.keyword,qe(),Ne(ge,"Literal");case xt:var H=q,K=z;qe();var le=ct();return le.start=K,le.end=F,P.locations&&(le.loc.start=H,le.loc.end=X),P.ranges&&(le.range=[K,F]),et(Ct),le;case wn:var ge=ht();return qe(),ge.elements=Yn(yn,!0,!0),Ne(ge,"ArrayExpression");case Xt:return zr();case mt:var ge=ht();return qe(),Jn(ge,!1);case oi:return Or();default:At()}}function Or(){var H=ht();return qe(),H.callee=un(Xn(),!0),We(xt)?H.arguments=Yn(Ct,!1):H.arguments=be,Ne(H,"NewExpression")}function zr(){var H=ht(),K=!0,le=!1;for(H.properties=[],qe();!We(Ut);){if(K)K=!1;else if(et(kt),P.allowTrailingCommas&&We(Ut))break;var ge={key:Ti()},ke=!1,Ae;if(We(Jt)?(ge.value=ct(!0),Ae=ge.kind="init"):P.ecmaVersion>=5&&ge.key.type==="Identifier"&&(ge.key.name==="get"||ge.key.name==="set")?(ke=le=!0,Ae=ge.kind=ge.key.name,ge.key=Ti(),N!==xt&&At(),ge.value=Jn(ht(),!1)):At(),ge.key.type==="Identifier"&&(ce||le))for(var ze=0;ze<H.properties.length;++ze){var Ue=H.properties[ze];if(Ue.key.name===ge.key.name){var Pt=Ae==Ue.kind||ke&&Ue.kind==="init"||Ae==="init"&&(Ue.kind==="get"||Ue.kind==="set");Pt&&!ce&&Ae==="init"&&Ue.kind==="init"&&(Pt=!1),Pt&&de(ge.key.start,"Redefinition of property")}}H.properties.push(ge)}return Ne(H,"ObjectExpression")}function Ti(){return N===xe||N===Te?Xn():Bt(!0)}function Jn(H,K){N===Ee?H.id=Bt():K?At():H.id=null,H.params=[];var le=!0;for(et(xt);!We(Ct);)le?le=!1:et(kt),H.params.push(Bt());var ge=ye,ke=Se;if(ye=!0,Se=[],H.body=on(!0),ye=ge,Se=ke,ce||H.body.body.length&&Un(H.body.body[0]))for(var Ae=H.id?-1:0;Ae<H.params.length;++Ae){var ze=Ae<0?H.id:H.params[Ae];if((vi(ze.name)||bn(ze.name))&&de(ze.start,"Defining '"+ze.name+"' in strict mode"),Ae>=0)for(var Ue=0;Ue<Ae;++Ue)ze.name===H.params[Ue].name&&de(ze.start,"Argument name clash in strict mode")}return Ne(H,K?"FunctionDeclaration":"FunctionExpression")}function Yn(H,K,le){for(var ge=[],ke=!0;!We(H);){if(ke)ke=!1;else if(et(kt),K&&P.allowTrailingCommas&&We(H))break;le&&N===kt?ge.push(null):ge.push(ct(!0))}return ge}function Bt(H){var K=ht();return H&&P.forbidReserved=="everywhere"&&(H=!1),N===Ee?(!H&&(P.forbidReserved&&(P.ecmaVersion===3?hr:cr)(Z)||ce&&vi(Z))&&g.slice(z,F).indexOf("\\")==-1&&de(z,"The keyword '"+Z+"' is reserved"),K.name=Z):H&&N.keyword?K.name=N.keyword:At(),J=!1,qe(),Ne(K,"Identifier")}}),t.version||(t=null)}function r(v,P){return(e.acorn||t).parse(v,P)}var s={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},o={"-":"__negate","+":"__self"},a=I.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(v){this["__"+v]="#"+v},{__self:function(){return this}});k.inject(a),se.inject(a),tt.inject(a);function u(v,P,g){var w=s[P];if(v&&v[w]){var h=v[w](g);return P==="!="?!h:h}switch(P){case"+":return v+g;case"-":return v-g;case"*":return v*g;case"/":return v/g;case"%":return v%g;case"==":return v==g;case"!=":return v!=g}}function l(v,P){var g=o[v];if(P&&P[g])return P[g]();switch(v){case"+":return+P;case"-":return-P}}function d(v,P){if(!v)return"";P=P||{};var g=[];function w(ce){for(var de=0,be=g.length;de<be;de++){var xe=g[de];if(xe[0]>=ce)break;ce+=xe[1]}return ce}function h(ce){return v.substring(w(ce.range[0]),w(ce.range[1]))}function p(ce,de){return v.substring(w(ce.range[1]),w(de.range[0]))}function x(ce,de){for(var be=w(ce.range[0]),xe=w(ce.range[1]),Pe=0,Te=g.length-1;Te>=0;Te--)if(be>g[Te][0]){Pe=Te+1;break}g.splice(Pe,0,[be,de.length-xe+be]),v=v.substring(0,be)+de+v.substring(xe)}function E(ce,de){switch(ce.type){case"UnaryExpression":if(ce.operator in o&&ce.argument.type!=="Literal"){var be=h(ce.argument);x(ce,'$__("'+ce.operator+'", '+be+")")}break;case"BinaryExpression":if(ce.operator in s&&ce.left.type!=="Literal"){var xe=h(ce.left),Pe=h(ce.right),Te=p(ce.left,ce.right),Ee=ce.operator;x(ce,"__$__("+xe+","+Te.replace(new RegExp("\\"+Ee),'"'+Ee+'"')+", "+Pe+")")}break;case"UpdateExpression":case"AssignmentExpression":var Oe=de&&de.type;if(!(Oe==="ForStatement"||Oe==="BinaryExpression"&&/^[=!<>]/.test(de.operator)||Oe==="MemberExpression"&&de.computed)){if(ce.type==="UpdateExpression"){var be=h(ce.argument),Re="__$__("+be+', "'+ce.operator[0]+'", 1)',Le=be+" = "+Re;ce.prefix?Le="("+Le+")":(Oe==="AssignmentExpression"||Oe==="VariableDeclarator"||Oe==="BinaryExpression")&&(h(de.left||de.id)===be&&(Le=Re),Le=be+"; "+Le),x(ce,Le)}else if(/^.=$/.test(ce.operator)&&ce.left.type!=="Literal"){var xe=h(ce.left),Pe=h(ce.right),Re=xe+" = __$__("+xe+', "'+ce.operator[0]+'", '+Pe+")";x(ce,/^\(.*\)$/.test(h(ce))?"("+Re+")":Re)}}break}}function y(ce){switch(ce.type){case"ExportDefaultDeclaration":x({range:[ce.start,ce.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var de=ce.declaration,be=ce.specifiers;if(de){var xe=de.declarations;xe&&(xe.forEach(function(Te){x(Te,"module.exports."+h(Te))}),x({range:[ce.start,de.start+de.kind.length]},""))}else if(be){var Pe=be.map(function(Te){var Ee=h(Te);return"module.exports."+Ee+" = "+Ee+"; "}).join("");Pe&&x(ce,Pe)}break}}function z(ce,de,be){if(ce){for(var xe in ce)if(xe!=="range"&&xe!=="loc"){var Pe=ce[xe];if(Array.isArray(Pe))for(var Te=0,Ee=Pe.length;Te<Ee;Te++)z(Pe[Te],ce,be);else Pe&&typeof Pe=="object"&&z(Pe,ce,be)}be.operatorOverloading!==!1&&E(ce,de),be.moduleExports!==!1&&y(ce)}}function F(ce){var de="",be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ce=(Math.abs(ce)<<1)+(ce<0?1:0);ce||!de;){var xe=ce&31;ce>>=5,ce&&(xe|=32),de+=be[xe]}return de}var q=P.url||"",X=P.sourceMaps,N=P.paperFeatures||{},Z=P.source||v,J=P.offset||0,ee=De.agent,te=ee.versionNumber,oe=!1,_e=/\r\n|\n|\r/mg,me;if(X&&(ee.chrome&&te>=30||ee.webkit&&te>=537.76||ee.firefox&&te>=23||ee.node)){if(ee.node)J-=2;else if(A&&q&&!A.location.href.indexOf(q)){var ye=C.getElementsByTagName("html")[0].innerHTML;J=ye.substr(0,ye.indexOf(v)+1).match(_e).length+1}oe=J>0&&!(ee.chrome&&te>=36||ee.safari&&te>=600||ee.firefox&&te>=40||ee.node);var Se=["AA"+F(oe?0:J)+"A"];Se.length=(v.match(_e)||[]).length+1+(oe?J:0),me={version:3,file:q,names:[],mappings:Se.join(";AACA"),sourceRoot:"",sources:[q],sourcesContent:[Z]}}return(N.operatorOverloading!==!1||N.moduleExports!==!1)&&z(r(v,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,N),me&&(oe&&(v=new Array(J+1).join(`
`)+v),/^(inline|both)$/.test(X)&&(v+=`
//# sourceMappingURL=data:application/json;base64,`+T.btoa(unescape(encodeURIComponent(JSON.stringify(me))))),v+=`
//# sourceURL=`+(q||"paperscript")),{url:q,source:Z,code:v,map:me}}function _(v,P,g){De=P;var w=P.getView(),h=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(v)&&!/\bnew\s+Tool\b/.test(v)?new $i:null,p=h?h._events:[],x=["onFrame","onResize"].concat(p),E=[],y=[],z,F=typeof v=="object"?v:d(v,g);v=F.code;function q(te,oe){for(var _e in te)(oe||!/^_/.test(_e))&&new RegExp("([\\b\\s\\W]|^)"+_e.replace(/\$/g,"\\$")+"\\b").test(v)&&(E.push(_e),y.push(te[_e]))}q({__$__:u,$__:l,paper:P,tool:h},!0),q(P),v="var module = { exports: {} }; "+v;var J=I.each(x,function(te){new RegExp("\\s+"+te+"\\b").test(v)&&(E.push(te),this.push("module.exports."+te+" = "+te+";"))},[]).join(`
`);J&&(v+=`
`+J),v+=`
return module.exports;`;var X=De.agent;if(C&&(X.chrome||X.firefox&&X.versionNumber<40)){var N=C.createElement("script"),Z=C.head||C.getElementsByTagName("head")[0];X.firefox&&(v=`
`+v),N.appendChild(C.createTextNode("document.__paperscript__ = function("+E+") {"+v+`
}`)),Z.appendChild(N),z=C.__paperscript__,delete C.__paperscript__,Z.removeChild(N)}else z=Function(E,v);var J=z&&z.apply(P,y),ee=J||{};return I.each(p,function(te){var oe=ee[te];oe&&(h[te]=oe)}),w&&(ee.onResize&&w.setOnResize(ee.onResize),w.emit("resize",{size:w.size,delta:new k}),ee.onFrame&&w.setOnFrame(ee.onFrame),w.requestUpdate()),J}function f(v){if(/^text\/(?:x-|)paperscript$/.test(v.type)&&D.getAttribute(v,"ignore")!=="true"){var P=D.getAttribute(v,"canvas"),g=C.getElementById(P),w=v.src||v.getAttribute("data-src"),h=D.hasAttribute(v,"async"),p="data-paper-scope";if(!g)throw new Error('Unable to find canvas with id "'+P+'"');var x=D.get(g.getAttribute(p))||new D().setup(g);return g.setAttribute(p,x._id),w?si.request({url:w,async:h,mimeType:"text/plain",onLoad:function(E){_(E,x,w)}}):_(v.innerHTML,x,v.baseURI),v.setAttribute("data-paper-ignore","true"),x}}function c(){I.each(C&&C.getElementsByTagName("script"),f)}function S(v){return v?f(v):c()}return A&&(C.readyState==="complete"?setTimeout(c):nt.add(A,{load:c})),{compile:d,execute:_,load:S,parse:r,calculateBinary:u,calculateUnary:l}}).call(this);var De=new(D.inject(I.exports,{Base:I,Numerical:j,Key:ri,DomEvent:nt,DomElement:Ye,document:C,window:A,Symbol:Be,PlacedSymbol:Ie}));return De.agent.node&&ki(De),typeof M=="function"&&M.amd?M("paper",De):b&&(b.exports=De),De}).call(qr,typeof self=="object"?self:null)})(En)),En.exports}var Ur=Vr();const m=Di(Ur),fe=800,It="#2a2a3a",Et=1.5,ni={Default:["#e07a5f","#3d405b","#81b29a","#f2cc8f","#264653","#2a9d8f","#e9c46a","#f4a261","#e76f51","#606c38","#283618","#dda15e","#bc6c25","#6d6875","#b5838d","#e5989b","#ffb4a2","#6930c3","#5390d9","#48bfe3","#72efdd","#c77dff","#f72585","#4cc9f0","#7209b7"],"Spring Bloom":["#f4a7bb","#fbc4d4","#ffe0ec","#ffd6e0","#f9e4c8","#fff1c1","#e8f5b0","#c8e6a2","#8ecf6d","#5bb450","#a0d8b3","#6ec5a8","#b5ead7","#81d4c2","#a3d9e8","#7ec8e3","#b6ccfe","#c3b1e1","#d5a6e6","#e6c2f7","#f2d0e0","#ffb6b9","#f7c6a3","#eadbc8","#c9e4de"],"Autumn Warmth":["#8b2500","#a63c06","#c45d1a","#d4753e","#e8915a","#c97b3a","#d4a24e","#e5b75f","#daa520","#b8860b","#8b6914","#6b4423","#5c3317","#7a4e2d","#a0522d","#8b4513","#704214","#5e3a1a","#556b2f","#6b7339","#8a7f4b","#9b8e5e","#c9b37f","#705044","#3e2723"],"Winter Frost":["#e8f0fe","#d4e4f7","#b0cde8","#89b4d6","#6699cc","#4a7fb5","#3a6591","#2b4c6f","#1b3a5c","#0f2744","#708090","#8f9baa","#b0bec5","#cfd8dc","#e0e5ec","#a8b8c8","#c5cad3","#7e9aac","#5c8a9e","#467f8b","#3d8b8a","#6eb5b0","#96cbc7","#bfdce0","#d5c6e0"]};let Lt=[...ni.Default];function Hr(b){Lt.length=0,b.forEach(function(T){Lt.push(T)})}const jr=["Mandala","Floral","Geometric","Zentangle","Ocean","Elephant","Butterfly","Celestial","Garden","Mosaic","Kente","Sashiko","Paisley","Space","Zodiac"],qi=["Chimes","Wind","Birds","Ocean","Rain","Crystal","Harp","Zen Bowl"],pe={tool:"fill",color:null,theme:"Default",gc1:null,gc2:null,gradType:"linear",brushSz:5,brushOp:1,pat:0,snd:0,vol:.5,panning:!1,panPt:null,gradItem:null,gradPt:null,brushPath:null,gcSel:1},Ge={patLayer:null,brushLayer:null};function Zr(){const b=document.getElementById("canvas");return m.setup(b),Ge.patLayer=m.project.activeLayer,Ge.brushLayer=new m.Layer,Ge.patLayer.activate(),b}function Vi(){const b=document.getElementById("canvas-wrap"),T=b.clientWidth,M=b.clientHeight;m.view.viewSize=new m.Size(T,M)}function nn(){m.view.center=new m.Point(fe/2,fe/2);const b=Math.min((m.view.viewSize.width-40)/fe,(m.view.viewSize.height-40)/fe);m.view.zoom=Math.max(.2,b),qt()}function qt(){document.getElementById("zoom-pct").textContent=Math.round(m.view.zoom*100)+"%"}function Gr(b,T){var M=document.getElementById("canvas-wrap");M.addEventListener("wheel",function(D){D.preventDefault();var U=new m.Point(D.offsetX,D.offsetY),L=m.view.viewToProject(U),G=D.deltaY<0?1.12:1/1.12;m.view.zoom=Math.max(.2,Math.min(12,m.view.zoom*G));var j=m.view.viewToProject(U);m.view.center=m.view.center.add(L.subtract(j)),qt()},{passive:!1});var A={active:!1,startDist:0,startZoom:1,startCenter:null,lastMid:null};function C(D,U){var L=D.clientX-U.clientX,G=D.clientY-U.clientY;return Math.sqrt(L*L+G*G)}function I(D,U){return new m.Point((D.clientX+U.clientX)/2,(D.clientY+U.clientY)/2)}function O(D,U){var L=b.getBoundingClientRect();return new m.Point(D-L.left,U-L.top)}M.addEventListener("touchstart",function(D){D.touches.length===2&&(D.preventDefault(),A.active=!0,A.startDist=C(D.touches[0],D.touches[1]),A.startZoom=m.view.zoom,A.startCenter=m.view.center.clone(),A.lastMid=I(D.touches[0],D.touches[1]))},{passive:!1}),M.addEventListener("touchmove",function(D){if(D.preventDefault(),A.active&&D.touches.length===2){var U=C(D.touches[0],D.touches[1]),L=U/A.startDist;m.view.zoom=Math.max(.2,Math.min(12,A.startZoom*L));var G=I(D.touches[0],D.touches[1]),j=O(A.lastMid.x,A.lastMid.y),ie=O(G.x,G.y),k=m.view.viewToProject(j).subtract(m.view.viewToProject(ie));m.view.center=m.view.center.add(k),A.lastMid=G,qt()}},{passive:!1}),M.addEventListener("touchend",function(D){D.touches.length<2&&(A.active=!1)}),document.getElementById("zoom-in").onclick=function(){m.view.zoom=Math.min(12,m.view.zoom*1.3),qt()},document.getElementById("zoom-out").onclick=function(){m.view.zoom=Math.max(.2,m.view.zoom/1.3),qt()},document.getElementById("zoom-fit").onclick=nn}const Vt=[],tn=[],Wr=50;function ln(b){Vt.push(b),Vt.length>Wr&&Vt.shift(),tn.length=0,cn()}function Ui(){if(!Vt.length)return;const b=Vt.pop();b.undo(),tn.push(b),cn()}function Hi(){if(!tn.length)return;const b=tn.pop();b.redo(),Vt.push(b),cn()}function cn(){document.getElementById("undo-btn").style.opacity=Vt.length?1:.4,document.getElementById("redo-btn").style.opacity=tn.length?1:.4}class Qn{constructor(T,M,A){this.item=T,this.old=M,this.new_=A}undo(){this.item.fillColor=this.old}redo(){this.item.fillColor=this.new_}}class Li{constructor(T,M){this.p=T,this.layer=M,this.removed=!1}undo(){this.p.remove(),this.removed=!0}redo(){this.layer.addChild(this.p),this.removed=!1}}function B(b){return b.fillColor="white",b.strokeColor=It,b.strokeWidth=Et,b.data.fillable=!0,b}function je(b,T,M,A,C,I){const O=Math.PI/180,D=new m.Path,U=Math.max(8,Math.ceil(Math.abs(I-C)/3));for(let L=0;L<=U;L++){const G=(C+(I-C)*L/U)*O;D.add([b+A*Math.cos(G),T+A*Math.sin(G)])}for(let L=U;L>=0;L--){const G=(C+(I-C)*L/U)*O;D.add([b+M*Math.cos(G),T+M*Math.sin(G)])}return D.closed=!0,B(D)}function Ve(b,T,M,A,C,I){const O=Math.PI/180,D=A*O,U=Math.cos(D),L=Math.sin(D),G=-L,j=U,ie=new m.Path({segments:[[b+M*U,T+M*L],[b+(M+I*.45)*U+G*C,T+(M+I*.45)*L+j*C],[b+(M+I)*U,T+(M+I)*L],[b+(M+I*.45)*U-G*C,T+(M+I*.45)*L-j*C]],closed:!0});return ie.smooth({type:"catmull-rom",factor:.5}),B(ie)}function Dt(b,T,M,A,C,I){const O=Math.PI/180,D=A*O,U=Math.cos(D),L=Math.sin(D),G=-L,j=U,ie=M+I/2,k=new m.Path({segments:[[b+M*U,T+M*L],[b+ie*U+G*C,T+ie*L+j*C],[b+(M+I)*U,T+(M+I)*L],[b+ie*U-G*C,T+ie*L-j*C]],closed:!0});return B(k)}function Tt(b,T,M,A,C,I){const O=Math.PI/180,D=A*O,U=Math.cos(D),L=Math.sin(D),G=-L,j=U,ie=new m.Path({segments:[[b+M*U,T+M*L],[b+(M+I*.3)*U+G*C*.5,T+(M+I*.3)*L+j*C*.5],[b+(M+I*.65)*U+G*C*.3,T+(M+I*.65)*L+j*C*.3],[b+(M+I)*U,T+(M+I)*L],[b+(M+I*.65)*U-G*C*.3,T+(M+I*.65)*L-j*C*.3],[b+(M+I*.3)*U-G*C*.5,T+(M+I*.3)*L-j*C*.5]],closed:!0});return ie.smooth({type:"catmull-rom",factor:.5}),B(ie)}function Xr(){const b=fe/2,T=fe/2,M=12,A=360/M;B(new m.Path.Circle([b,T],380));for(let C=0;C<M*2;C++)je(b,T,345,378,C*A/2,(C+1)*A/2);for(let C=0;C<M;C++)je(b,T,275,345,C*A,(C+1)*A);for(let C=0;C<M;C++)Tt(b,T,280,C*A+A/2,24,52);for(let C=0;C<M;C++){const I=C*A*Math.PI/180;B(new m.Path.Circle([b+310*Math.cos(I),T+310*Math.sin(I)],9))}for(let C=0;C<M;C++)je(b,T,195,275,C*A,(C+1)*A);for(let C=0;C<M;C++)Dt(b,T,200,C*A,20,68);for(let C=0;C<M;C++)Dt(b,T,215,C*A+A/2,12,38);for(let C=0;C<M;C++)je(b,T,125,195,C*A,(C+1)*A);for(let C=0;C<M;C++)Ve(b,T,130,C*A+A/2,17,58);for(let C=0;C<M;C++)je(b,T,58,125,C*A,(C+1)*A);for(let C=0;C<M;C++)Ve(b,T,62,C*A,11,52);for(let C=0;C<M;C++){const I=(C*A+A/2)*Math.PI/180;B(new m.Path.Circle([b+88*Math.cos(I),T+88*Math.sin(I)],6))}for(let C=0;C<M;C++)je(b,T,28,58,C*A,(C+1)*A);B(new m.Path.Circle([b,T],28)),B(new m.Path.Circle([b,T],12))}function Jr(){const b=fe/2,T=fe/2;B(new m.Path.Rectangle([8,8],[fe-16,fe-16]));for(let C=0;C<10;C++)Ve(b,T,30,C*36,30,130);for(let C=0;C<10;C++)Ve(b,T,25,C*36+18,20,85);B(new m.Path.Circle([b,T],30)),B(new m.Path.Circle([b,T],14)),[[150,150],[650,150],[150,650],[650,650]].forEach(function(C){for(let I=0;I<7;I++)Ve(C[0],C[1],12,I*360/7,16,50);B(new m.Path.Circle(C,12))}),[[400,95],[400,705],[95,400],[705,400]].forEach(function(C){for(let I=0;I<5;I++)Ve(C[0],C[1],8,I*72,12,38);B(new m.Path.Circle(C,8))});var M=[[260,260,45],[540,260,135],[260,540,-45],[540,540,-135],[310,170,20],[490,170,-20],[310,630,-20],[490,630,20],[170,310,70],[170,490,-70],[630,310,-70],[630,490,70]];M.forEach(function(C){var I=new m.Path.Ellipse({center:[C[0],C[1]],size:[55,18]});I.rotate(C[2]),B(I)});function A(C,I,O,D){var U=new m.Path.Ellipse({center:[C-D*.5,I],size:[D,D*.65]});U.rotate(O+15,[C,I]),B(U);var L=new m.Path.Ellipse({center:[C+D*.5,I],size:[D,D*.65]});L.rotate(O-15,[C,I]),B(L);var G=new m.Path.Ellipse({center:[C,I],size:[5,D*.7]});G.rotate(O,[C,I]),B(G)}A(200,340,10,32),A(600,310,-15,28),A(340,590,5,24),[[200,200,280,160,320,200],[600,200,520,160,480,200],[200,600,280,640,320,600],[600,600,520,640,480,600]].forEach(function(C){var I=new m.Path({segments:[[C[0],C[1]],[C[2],C[3]],[C[4],C[5]]]});I.smooth(),I.strokeColor=It,I.strokeWidth=Et})}function Yr(){var b=78,T=b*Math.sqrt(3)/2;B(new m.Path.Rectangle([0,0],[fe,fe]));for(var M=-1;M<fe/T+1;M++)for(var A=-1;A<fe/b+1;A++){var C=A*b+(M%2?b/2:0),I=M*T;if(!(C<-b||C>fe+b||I<-T||I>fe+T)){var O=new m.Path.RegularPolygon([C,I],6,b*.46);B(O);var D=new m.Path.Star([C,I],6,b*.14,b*.33);B(D),B(new m.Path.Circle([C,I],b*.1))}}}function Kr(){var b=4,T=4,M=(fe-40)/b,A=(fe-40)/T,C=20,I=20;B(new m.Path.Rectangle([8,8],[fe-16,fe-16]));for(var O=[function(ie,k,ue,se){for(var ae=Math.min(ue,se)/2-8;ae>8;ae-=14)B(new m.Path.Circle([ie+ue/2,k+se/2],ae))},function(ie,k,ue,se){for(var ae=ie+ue/2,V=k+se/2,Y=0;Y<6;Y++)Ve(ae,V,6,Y*60,10,ue/2-18);B(new m.Path.Circle([ae,V],8))},function(ie,k,ue,se){for(var ae=0;ae<4;ae++)for(var V=0;V<3;V++){var Y=ie+8+V*(ue-16)/3+(ae%2?(ue-16)/6:0),Q=k+12+ae*(se-16)/4;B(new m.Path.Ellipse({center:[Y+(ue-16)/6,Q],size:[(ue-16)/3-3,(se-16)/4-3]}))}},function(ie,k,ue,se){for(var ae=5,V=(ue-8)/ae,Y=(se-8)/ae,Q=0;Q<ae;Q++)for(var re=0;re<ae;re++)B(new m.Path.Rectangle([ie+4+re*V,k+4+Q*Y],[V-1,Y-1])),(Q+re)%2===0&&B(new m.Path.Circle([ie+4+re*V+V/2,k+4+Q*Y+Y/2],Math.min(V,Y)/3))},function(ie,k,ue,se){for(var ae=ie+ue/2,V=k+se/2,Y=Math.min(ue,se)/2-8;Y>12;Y-=18)B(new m.Path({segments:[[ae,V-Y],[ae+Y,V],[ae,V+Y],[ae-Y,V]],closed:!0}))},function(ie,k,ue,se){for(var ae=ie+ue/2,V=k+se/2,Y=1;Y<=4;Y++)for(var Q=Y*Math.min(ue,se)/10,re=0;re<6;re++)je(ae,V,Math.max(2,Q-6),Q+6,re*60,(re+1)*60)},function(ie,k,ue,se){var ae=ie+ue/2,V=k+se/2,Y=Math.min(ue,se)/2-10;B(new m.Path.RegularPolygon([ae,V],3,Y)),B(new m.Path.RegularPolygon([ae,V],3,Y*.6)),B(new m.Path.RegularPolygon([ae,V],3,Y*.3)),B(new m.Path.Circle([ae,V],8))},function(ie,k,ue,se){for(var ae=0;ae<5;ae++)for(var V=k+10+ae*(se-16)/5,Y=0;Y<3;Y++){var Q=ie+8+Y*(ue-16)/3,re=(ue-16)/3,W=(se-16)/5,R=new m.Path({segments:[[Q,V+W/2],[Q+re*.25,V],[Q+re*.5,V+W/2],[Q+re*.75,V+W],[Q+re,V+W/2]],closed:!0});R.smooth(),B(R)}}],D=0;D<T;D++)for(var U=0;U<b;U++){var L=C+U*M,G=I+D*A,j=new m.Path.Rectangle([L,G],[M,A]);j.strokeColor=It,j.strokeWidth=Et*1.5,j.fillColor="white",j.data.fillable=!0,O[(D*b+U)%O.length](L,G,M,A)}}function Qr(){B(new m.Path.Rectangle([0,0],[fe,fe])),B(new m.Path.Rectangle([0,0],[fe,80])),B(new m.Path.Circle([680,45],30)),B(new m.Path.Circle([680,45],18));for(var b=0;b<10;b++){var T=b*36*Math.PI/180,M=680+42*Math.cos(T),A=45+42*Math.sin(T);B(new m.Path.Ellipse({center:[M,A],size:[8,3]}).rotate(b*36))}function C(V,Y){B(new m.Path.Ellipse({center:[V,Y],size:[50,22]})),B(new m.Path.Ellipse({center:[V-18,Y+2],size:[30,18]})),B(new m.Path.Ellipse({center:[V+20,Y+2],size:[35,16]}))}C(150,35),C(420,50);var I=[85,145,215,290,370,445,520,590];I.forEach(function(V,Y){for(var Q=12+Y%3*5,re=35+Y%2*15,W=32+Y%3*8,R=new m.Path,ne=0;ne<=fe;ne+=14)R.add([ne,V+Q*Math.sin(ne/W+Y*.7)]);for(var ne=fe;ne>=0;ne-=14)R.add([ne,V+re+Q*.6*Math.sin(ne/W+Y*.7+1.2)]);R.closed=!0,B(R)});function O(V,Y,Q,re){var W=new m.Path.Ellipse({center:[V,Y],size:[Q,Q*.5]});B(W),B(new m.Path({segments:[[V+re*Q*.4,Y],[V+re*Q*.72,Y-Q*.28],[V+re*Q*.55,Y],[V+re*Q*.72,Y+Q*.28]],closed:!0})),B(new m.Path({segments:[[V-re*Q*.05,Y-Q*.22],[V+re*Q*.12,Y-Q*.42],[V+re*Q*.25,Y-Q*.22]],closed:!0})),B(new m.Path.Circle([V-re*Q*.2,Y-Q*.05],Q*.08)),B(new m.Path.Circle([V-re*Q*.2,Y-Q*.05],Q*.03));for(var R=0;R<3;R++){var ne=V-re*Q*.05+re*R*Q*.14;B(new m.Path.Ellipse({center:[ne,Y],size:[4,Q*.28]}))}var $=new m.Path.Ellipse({center:[V+re*Q*.05,Y+Q*.15],size:[Q*.22,Q*.12]});$.rotate(re*20),B($)}O(190,170,90,-1),O(580,310,80,1),O(320,440,70,-1),O(650,500,65,1),O(140,560,60,1);function D(V,Y,Q,re){B(new m.Path.Ellipse({center:[V,Y],size:[Q,Q*.45]})),B(new m.Path({segments:[[V+re*Q*.38,Y],[V+re*Q*.62,Y-Q*.2],[V+re*Q*.62,Y+Q*.2]],closed:!0})),B(new m.Path.Circle([V-re*Q*.15,Y-1],Q*.06))}D(450,130,40,1),D(720,240,35,-1),D(100,350,38,1),D(500,250,32,-1);function U(V,Y,Q,re){B(new m.Path.Ellipse({center:[V,Y-Q/2],size:[5,Q]}));for(var W=0;W<re;W++){var R=Y-W*(Q/re)-Q*.1,ne=W%2===0?1:-1,$=new m.Path.Ellipse({center:[V+ne*14,R],size:[22,8]});$.rotate(ne*25,[V,R]),B($)}}U(60,720,120,5),U(250,740,100,4),U(740,720,110,5);function L(V,Y,Q){B(new m.Path.Ellipse({center:[V,Y+5],size:[12,20]}));for(var re=0;re<Q;re++){var W=-30+re/(Q-1)*60,R=W*Math.PI/180,ne=25+re%2*12,$=V+ne*Math.sin(R),he=Y-ne*Math.cos(R);B(new m.Path.Ellipse({center:[(V+$)/2,(Y+he)/2],size:[6,ne]}).rotate(W)),B(new m.Path.Circle([$,he],6))}}L(440,710,4),L(580,725,3),L(160,730,3);function G(V,Y,Q){for(var re=0;re<7;re++){var W=-80+re*22.857142857142858,R=W+160/7,ne=Q*.15,$=Q*.5,he=Math.PI/180,ve=new m.Path({segments:[[V+ne*Math.cos(W*he),Y+ne*Math.sin(W*he)],[V+$*Math.cos(W*he),Y+$*Math.sin(W*he)],[V+$*Math.cos(R*he),Y+$*Math.sin(R*he)],[V+ne*Math.cos(R*he),Y+ne*Math.sin(R*he)]],closed:!0});B(ve)}B(new m.Path.Circle([V,Y],Q*.12))}G(100,750,42),G(350,755,36),G(680,745,40);function j(V,Y,Q){B(new m.Path.Star([V,Y],5,Q*.38,Q)),B(new m.Path.Circle([V,Y],Q*.18));for(var re=0;re<5;re++){var W=(re*72-90)*Math.PI/180;B(new m.Path.Circle([V+Q*.6*Math.cos(W),Y+Q*.6*Math.sin(W)],3))}}j(480,720,35),j(220,710,28);var ie=[[80,120,8],[220,100,6],[460,115,10],[650,180,7],[120,280,5],[700,380,9],[350,200,7],[550,460,8],[80,480,6],[680,560,7],[400,360,5],[520,160,6],[300,330,4],[760,450,5],[420,540,6],[180,430,4]];ie.forEach(function(V){B(new m.Path.Circle([V[0],V[1]],V[2])),B(new m.Path.Circle([V[0]-V[2]*.3,V[1]-V[2]*.3],V[2]*.25))});var k=700,ue=130,se=new m.Path.Arc(new m.Point(k-28,ue+5),new m.Point(k,ue-25),new m.Point(k+28,ue+5));se.lineTo(new m.Point(k-28,ue+5)),se.closed=!0,B(se),B(new m.Path.Ellipse({center:[k,ue+8],size:[56,10]}));for(var ae=-2;ae<=2;ae++)B(new m.Path.Ellipse({center:[k+ae*10,ue+32],size:[4,30]}))}function $r(){var b=fe/2,T=fe/2+10;B(new m.Path.Rectangle([0,0],[fe,fe]));for(var M=0;M<4;M++)for(var A=0;A<12;A++){var C,I,O=fe/12,D=18;M===0?(C=A*O,I=5):M===1?(C=A*O,I=fe-23):M===2?(C=5,I=A*O,O=18,D=fe/12):(C=fe-23,I=A*O,O=18,D=fe/12),B(new m.Path.Rectangle([C,I],[O,D]))}B(new m.Path.Circle([b,T-40],160));for(var A=1;A<=3;A++){var U=40+A*22;je(b,T-40,U-10,U,200,250),je(b,T-40,U-10,U,290,340)}var L=200,G=T-10,j=new m.Path.Ellipse({center:[b-L,G],size:[160,210]});j.rotate(-8),B(j);var ie=new m.Path.Ellipse({center:[b-L,G],size:[120,165]});ie.rotate(-8),B(ie);for(var A=1;A<=4;A++)B(new m.Path.Circle([b-L,G],12+A*14));for(var A=0;A<8;A++)Ve(b-L,G,16,A*45,6,25);B(new m.Path.Circle([b-L,G],12));for(var A=0;A<6;A++){var k=A*60*Math.PI/180;B(new m.Path.Circle([b-L+58*Math.cos(k),G+68*Math.sin(k)],6))}var ue=new m.Path.Ellipse({center:[b+L,G],size:[160,210]});ue.rotate(8),B(ue);var se=new m.Path.Ellipse({center:[b+L,G],size:[120,165]});se.rotate(8),B(se);for(var A=1;A<=4;A++)B(new m.Path.Circle([b+L,G],12+A*14));for(var A=0;A<8;A++)Ve(b+L,G,16,A*45,6,25);B(new m.Path.Circle([b+L,G],12));for(var A=0;A<6;A++){var k=A*60*Math.PI/180;B(new m.Path.Circle([b+L+58*Math.cos(k),G+68*Math.sin(k)],6))}var ae=62,V=T-72;[-1,1].forEach(function($){var he=b+$*ae;B(new m.Path.Circle([he,V],22)),B(new m.Path.Circle([he,V],10)),B(new m.Path.Circle([he,V],4));var ve=new m.Path.Arc(new m.Point(he-22,V),new m.Point(he,V-28),new m.Point(he+22,V));ve.lineTo(new m.Point(he-22,V)),ve.closed=!0,B(ve)});var Y=T-42;B(new m.Path.Circle([b,Y],8)),B(new m.Path.Circle([b,Y],18));for(var A=0;A<10;A++)Ve(b,Y,20,A*36,10,42);for(var A=0;A<10;A++)Ve(b,Y,52,A*36+18,6,24);for(var A=0;A<10;A++){var Q=(A*36+18)*Math.PI/180;B(new m.Path.Circle([b+80*Math.cos(Q),Y+80*Math.sin(Q)],4))}for(var A=0;A<7;A++)Tt(b,T-40,130,-155+A*22,12,35);var re=new m.Path({segments:[[b-34,T+95],[b-40,T+180],[b-52,T+275],[b-44,T+350],[b-14,T+385],[b+14,T+385],[b+44,T+350],[b+52,T+275],[b+40,T+180],[b+34,T+95]],closed:!0});re.smooth(),B(re);for(var A=0;A<8;A++){var W=T+115+A*32,R=28-A*1.8;R>6&&(B(new m.Path.Rectangle({center:[b,W],size:[R*2,14],radius:4})),B(new m.Path.Circle([b-R-4,W],3)),B(new m.Path.Circle([b+R+4,W],3)))}B(new m.Path.Circle([b,T+382],8)),[-1,1].forEach(function($){var he=b+$*48,ve=new m.Path({segments:[[he,T+75],[he+$*35,T+145],[he+$*52,T+210],[he+$*45,T+195],[he+$*22,T+135],[he+$*5,T+80]],closed:!0});ve.smooth(),B(ve),B(new m.Path.Ellipse({center:[he+$*30,T+140],size:[18,8]})),B(new m.Path.Ellipse({center:[he+$*42,T+180],size:[14,6]}))}),[-1,1].forEach(function($){for(var he=0;he<3;he++){var ve=b+$*145+$*he*35,Ie=T+120+he*55;Tt(ve,Ie,0,$>0?-90:90,10,28)}});for(var A=0;A<16;A++){var ne=(A*22.5+180)*Math.PI/180;ne>Math.PI*.8&&ne<Math.PI*2.2&&B(new m.Path.Circle([b+145*Math.cos(ne),T-40+145*Math.sin(ne)],4))}[[65,65],[fe-65,65],[65,fe-65],[fe-65,fe-65]].forEach(function($){for(var he=0;he<6;he++)Ve($[0],$[1],6,he*60,7,25);B(new m.Path.Circle($,10)),B(new m.Path.Circle($,5));for(var he=0;he<6;he++){var ve=he*60*Math.PI/180;B(new m.Path.Circle([$[0]+35*Math.cos(ve),$[1]+35*Math.sin(ve)],3))}}),[[fe/2,35],[fe/2,fe-35],[35,fe/2],[fe-35,fe/2]].forEach(function($){for(var he=0;he<4;he++)Ve($[0],$[1],4,he*90+45,5,16);B(new m.Path.Circle($,4))})}function es(){var b=fe/2;B(new m.Path.Rectangle([0,0],[fe,fe]));function T(j){var ie=new m.Path({segments:j,closed:!0});return ie.smooth({type:"catmull-rom",factor:.5}),B(ie)}function M(j){T(j),T(j.map(function(ie){return[2*b-ie[0],ie[1]]}))}function A(j,ie,k){B(new m.Path.Circle([j,ie],k)),B(new m.Path.Circle([2*b-j,ie],k))}for(var C=[[[420,295],[490,220],[570,160],[660,118],[730,100]],[[420,332],[498,268],[578,215],[662,170],[730,148]],[[420,370],[510,325],[588,278],[665,232],[730,200]]],I=0;I<2;I++)for(var O=0;O<4;O++)M([C[I][O],C[I][O+1],C[I+1][O+1],C[I+1][O]]);for(var D=[[[420,388],[495,415],[575,465],[640,535]],[[418,425],[488,460],[558,525],[615,590]],[[416,465],[475,515],[535,582],[580,640]]],I=0;I<2;I++)for(var O=0;O<3;O++)M([D[I][O],D[I][O+1],D[I+1][O+1],D[I+1][O]]);A(615,170,20),A(615,170,11),A(615,170,4),A(545,520,16),A(545,520,7),[[455,258,4],[520,192,4],[580,155,4],[640,128,4],[695,110,3.5],[730,100,3],[505,162,3.5],[660,112,3]].forEach(function(j){A(j[0],j[1],j[2])}),[[465,348,4],[548,302,4],[625,260,4],[695,220,3.5],[730,198,3],[585,280,3]].forEach(function(j){A(j[0],j[1],j[2])}),[[460,405,4],[530,435,4],[600,490,4],[645,545,3.5],[450,495,4],[515,548,4],[565,610,3.5],[590,645,3]].forEach(function(j){A(j[0],j[1],j[2])}),B(new m.Path.Ellipse({center:[b,330],size:[30,55]})),B(new m.Path.Circle([b,316],4)),B(new m.Path.Circle([b,342],4));for(var U=0;U<5;U++)B(new m.Path.Ellipse({center:[b,368+U*22],size:[24-U*2.5,18]}));B(new m.Path.Circle([b,282],18)),B(new m.Path.Circle([b-9,277],5)),B(new m.Path.Circle([b+9,277],5));var L=new m.Path({segments:[[b+4,266],[b+35,215],[b+72,165],[b+95,132],[b+100,115],[b+106,119],[b+101,138],[b+78,170],[b+40,220],[b+8,270]],closed:!0});L.smooth({type:"catmull-rom",factor:.5}),B(L);var G=new m.Path({segments:[[b-4,266],[b-35,215],[b-72,165],[b-95,132],[b-100,115],[b-106,119],[b-101,138],[b-78,170],[b-40,220],[b-8,270]],closed:!0});G.smooth({type:"catmull-rom",factor:.5}),B(G),B(new m.Path.Circle([b+103,117],9)),B(new m.Path.Circle([b+103,117],4)),B(new m.Path.Circle([b-103,117],9)),B(new m.Path.Circle([b-103,117],4)),[[75,75],[fe-75,75],[75,fe-75],[fe-75,fe-75]].forEach(function(j){B(new m.Path.Circle(j,8));for(var ie=0;ie<4;ie++)Ve(j[0],j[1],10,ie*90,12,28)}),[[120,190,5],[680,190,5],[160,500,4],[640,500,4],[200,100,4],[600,100,4],[110,650,4],[690,650,4],[250,710,3.5],[550,710,3.5],[300,75,3],[500,75,3],[760,400,4],[40,400,4],[760,300,3],[40,300,3],[760,500,3],[40,500,3],[200,400,3],[600,400,3],[180,620,3],[620,620,3],[300,620,3],[500,620,3],[350,150,3],[450,150,3],[220,280,3],[580,280,3],[280,520,3],[520,520,3]].forEach(function(j){B(new m.Path.Circle([j[0],j[1]],j[2]))})}function ts(){const b=Math.PI/180;B(new m.Path.Rectangle([0,0],[fe,fe])),new m.Path({segments:[[0,0],[fe,fe]],closed:!1}),new m.Path({segments:[[fe,0],[0,fe]],closed:!1}),B(new m.Path({segments:[[0,0],[fe/2,fe/2],[fe,0]],closed:!0})),B(new m.Path({segments:[[fe,0],[fe/2,fe/2],[fe,fe]],closed:!0})),B(new m.Path({segments:[[fe,fe],[fe/2,fe/2],[0,fe]],closed:!0})),B(new m.Path({segments:[[0,fe],[fe/2,fe/2],[0,0]],closed:!0}));var T=260,M=340,A=60;B(new m.Path.Circle([T,M],A*.35)),B(new m.Path.Circle([T,M],A*.6)),B(new m.Path.Circle([T,M],A));for(var C=0;C<12;C++)je(T,M,A,A+14,C*30+2,C*30+28);for(var C=0;C<24;C++){var I=C*15,O=C%2===0?55:32,D=C%2===0?7:5;Tt(T,M,A+14,I,D*2,O)}var U=620,L=140,G=55;B(new m.Path.Circle([U,L],G)),B(new m.Path.Circle([U+22,L-10],G*.85));for(var C=1;C<=3;C++){var j=G*(.35+C*.15),ie=new m.Path.Arc([U-j*Math.cos(40*b),L-j*Math.sin(40*b)],[U-j,L],[U-j*Math.cos(40*b),L+j*Math.sin(40*b)]),k=new m.Path({segments:ie.segments.map(function(Ce){return Ce.point}),closed:!0});ie.remove(),B(k)}var ue=[[-18,-12,5],[-28,6,4],[-12,16,3.5],[-30,-16,3],[-8,-2,4]];ue.forEach(function(Me){B(new m.Path.Circle([U+Me[0],L+Me[1]],Me[2]))});function se(Me,Ce,Ze,we,ft){B(new m.Path.Circle([Me,Ce],Ze));for(var vt=1;vt<=we;vt++){var Fe=Ce-Ze+2*Ze/(we+1)*vt,dt=Math.sqrt(Math.max(0,Ze*Ze-(Fe-Ce)*(Fe-Ce))),dn=new m.Path({segments:[[Me-dt,Fe-3],[Me+dt,Fe-3],[Me+dt,Fe+3],[Me-dt,Fe+3]],closed:!0});B(dn)}ft&&(je(Me,Ce,Ze+6,Ze+14,160,380),je(Me,Ce,Ze+15,Ze+21,165,375))}se(130,160,35,3,!0),se(680,400,42,4,!0),se(480,600,30,2,!1),se(100,550,25,2,!0),se(550,170,22,2,!1),se(350,720,28,3,!1);function ae(Me,Ce,Ze){B(new m.Path.Star([Me,Ce],5,Ze*.4,Ze))}var V=[[70,60],[140,30],[160,90],[110,110],[50,100]];V.forEach(function(Me){ae(Me[0],Me[1],6)});for(var C=0;C<V.length-1;C++)B(new m.Path({segments:[[V[C][0],V[C][1]-1],[V[C+1][0],V[C+1][1]-1],[V[C+1][0],V[C+1][1]+1],[V[C][0],V[C][1]+1]],closed:!0}));var Y=[[600,650],[650,620],[690,660],[740,630],[770,670]];Y.forEach(function(Me){ae(Me[0],Me[1],5)});for(var C=0;C<Y.length-1;C++)B(new m.Path({segments:[[Y[C][0],Y[C][1]-1],[Y[C+1][0],Y[C+1][1]-1],[Y[C+1][0],Y[C+1][1]+1],[Y[C][0],Y[C][1]+1]],closed:!0}));var Q=[[40,300],[80,340],[60,380],[100,420],[80,460]];Q.forEach(function(Me){ae(Me[0],Me[1],5.5)});for(var C=0;C<Q.length-1;C++)B(new m.Path({segments:[[Q[C][0],Q[C][1]-1],[Q[C+1][0],Q[C+1][1]-1],[Q[C+1][0],Q[C+1][1]+1],[Q[C][0],Q[C][1]+1]],closed:!0}));var re=[[300,50],[350,35],[400,30],[450,40],[490,60]];re.forEach(function(Me){ae(Me[0],Me[1],5)});for(var C=0;C<re.length-1;C++)B(new m.Path({segments:[[re[C][0],re[C][1]-1],[re[C+1][0],re[C+1][1]-1],[re[C+1][0],re[C+1][1]+1],[re[C][0],re[C][1]+1]],closed:!0}));var W=[[200,90,8],[420,120,6],[710,80,7],[760,250,5],[720,530,6],[340,560,5],[180,450,7],[560,460,5],[250,250,4],[470,270,5],[640,280,4],[320,400,5],[150,700,6],[500,750,5],[700,750,7],[770,150,4],[30,200,5],[40,650,4],[230,600,5],[440,490,4],[580,90,4],[760,470,5],[610,540,4],[280,150,5]];W.forEach(function(Me){ae(Me[0],Me[1],Me[2])});var R=720,ne=720,$=12;B(new m.Path.Circle([R,ne],$)),B(new m.Path.Circle([R,ne],$*.45)),B(new m.Path({segments:[[R-$*.7,ne-$*.7],[R-120,ne-110],[R-130,ne-95],[R-$*.5,ne+$*.1]],closed:!0})),B(new m.Path({segments:[[R-$*.3,ne-$*.8],[R-70,ne-120],[R-80,ne-110],[R+$*.1,ne-$*.5]],closed:!0}));for(var C=0;C<5;C++){var he=30+C*14,ve=200+C*8,Ie=330-C*8;je(160,680,he,he+10,ve,Ie)}var Be=[[130,100,3],[170,160,3],[90,190,3],[720,360,3],[640,430,3],[710,440,3],[510,570,3],[450,620,3],[120,510,3],[70,570,3],[570,140,3],[530,200,3],[380,690,3],[320,750,3]];Be.forEach(function(Me){B(new m.Path.Circle([Me[0],Me[1]],Me[2]))})}function ns(){B(new m.Path.Rectangle([8,8],[fe-16,fe-16])),B(new m.Path.Rectangle([8,520],[fe-16,272])),B(new m.Path.Rectangle([40,230],[720,14])),B(new m.Path.Rectangle([40,170],[720,14]));for(let W=0;W<13;W++){const R=60+W*56;B(new m.Path({segments:[[R-10,250],[R-10,155],[R,140],[R+10,155],[R+10,250]],closed:!0}))}[[380,480,50,30,5],[410,420,45,28,-8],[385,365,42,26,12],[415,310,48,30,-5],[390,260,40,25,8],[420,205,38,24,-10],[395,155,35,22,3]].forEach(function(W){var R=new m.Path.Ellipse({center:[W[0],W[1]],size:[W[2],W[3]]});R.rotate(W[4]),B(R)});function b(W,R,ne,$){B(new m.Path({segments:[[W-ne/2-8,R],[W+ne/2+8,R],[W+ne/2-5,R+$],[W-ne/2+5,R+$]],closed:!0})),B(new m.Path.Rectangle([W-ne/2-12,R-10],[ne+24,12]));var he=new m.Path.Ellipse({center:[W,R+$+6],size:[ne+10,12]});B(he)}b(160,610,60,70),b(400,620,55,65),b(640,600,65,75);var T=new m.Path({segments:[[160,610],[155,540],[150,470]]});T.smooth(),T.strokeColor=It,T.strokeWidth=Et;for(let W=0;W<8;W++)Ve(150,470,12,W*45,10,35);B(new m.Path.Circle([150,470],12));var M=new m.Path.Ellipse({center:[138,545],size:[30,12]});M.rotate(-30),B(M),M=new m.Path.Ellipse({center:[172,560],size:[28,11]}),M.rotate(25),B(M);var A=new m.Path({segments:[[400,620],[398,560],[395,500]]});A.smooth(),A.strokeColor=It,A.strokeWidth=Et;for(let W=0;W<5;W++)Ve(395,500,8,-90+(W-2)*25,14,45);B(new m.Path.Circle([395,500],8));var C=new m.Path.Ellipse({center:[378,570],size:[35,10]});C.rotate(-40),B(C),C=new m.Path.Ellipse({center:[416,575],size:[32,10]}),C.rotate(35),B(C);var I=new m.Path({segments:[[640,600],[638,520],[635,430]]});I.smooth(),I.strokeColor=It,I.strokeWidth=Et;for(let W=0;W<12;W++)Ve(635,430,18,W*30,12,45);for(let W=0;W<12;W++)Ve(635,430,14,W*30+15,8,30);B(new m.Path.Circle([635,430],18)),B(new m.Path.Circle([635,430],9));var O=new m.Path.Ellipse({center:[613,520],size:[40,14]});O.rotate(-35),B(O),O=new m.Path.Ellipse({center:[662,540],size:[38,13]}),O.rotate(30),B(O);var D=new m.Path({segments:[[100,530],[95,440],[100,340]]});D.smooth(),D.strokeColor=It,D.strokeWidth=Et;for(let W=0;W<8;W++)Ve(100,340,20,W*45,18,55);for(let W=0;W<8;W++)Ve(100,340,14,W*45+22,12,35);B(new m.Path.Circle([100,340],20)),B(new m.Path.Circle([100,340],10));var U=new m.Path({segments:[[700,530],[705,420],[700,320]]});U.smooth(),U.strokeColor=It,U.strokeWidth=Et;for(let W=0;W<7;W++)Ve(700,320,16,W*360/7,16,50);B(new m.Path.Circle([700,320],16));var L=new m.Path({segments:[[300,530],[295,400],[300,280]]});L.smooth(),L.strokeColor=It,L.strokeWidth=Et;for(let W=0;W<6;W++)Ve(300,280,14,W*60,14,45);for(let W=0;W<6;W++)Ve(300,280,10,W*60+30,10,28);B(new m.Path.Circle([300,280],14));var G=new m.Path({segments:[[30,700],[35,600],[28,500],[40,400],[32,300],[45,200],[38,100]]});G.smooth(),G.strokeColor=It,G.strokeWidth=Et,[[45,650,30],[25,580,-25],[50,510,35],[22,440,-30],[48,370,25],[26,300,-35],[52,240,30],[28,170,-25],[55,120,35],[30,80,-20]].forEach(function(W){var R=new m.Path.Ellipse({center:[W[0],W[1]],size:[26,12]});R.rotate(W[2]),B(R)});function j(W,R,ne,$){var he=ne*Math.PI/180,ve=Math.cos(he),Ie=Math.sin(he),Be=-Ie,Me=ve,Ce=new m.Path.Ellipse({center:[W,R],size:[$,$*.55]});Ce.rotate(ne),B(Ce),B(new m.Path.Circle([W+ve*$*.55,R+Ie*$*.55],$*.2));var Ze=new m.Path.Ellipse({center:[W-ve*$*.1,R-Ie*$*.1],size:[$*.15,$*.45]});Ze.rotate(ne),B(Ze);var we=new m.Path.Ellipse({center:[W-ve*$*.3,R-Ie*$*.3],size:[$*.15,$*.45]});we.rotate(ne),B(we);var ft=new m.Path.Ellipse({center:[W+Be*$*.35+ve*$*.15,R+Me*$*.35+Ie*$*.15],size:[$*.45,$*.25]});ft.rotate(ne+20),B(ft);var vt=new m.Path.Ellipse({center:[W-Be*$*.35+ve*$*.15,R-Me*$*.35+Ie*$*.15],size:[$*.45,$*.25]});vt.rotate(ne-20),B(vt)}j(250,150,15,30),j(550,380,-20,26);var ie=520,k=560,ue=new m.Path({segments:[[ie-25,k-30],[ie+25,k-30],[ie+30,k+25],[ie-30,k+25]],closed:!0});ue.smooth({type:"catmull-rom",factor:.3}),B(ue),B(new m.Path({segments:[[ie+25,k-25],[ie+55,k-55],[ie+62,k-50],[ie+30,k-20]],closed:!0})),B(new m.Path.Ellipse({center:[ie+62,k-55],size:[18,10]})),B(new m.Path({segments:[[ie-15,k-30],[ie-25,k-55],[ie+5,k-60],[ie+15,k-30]],closed:!0}));function se(W,R,ne,$){var he=new m.Path.Ellipse({center:[W-$*.5,R],size:[$,$*.65]});he.rotate(ne+15,[W,R]),B(he);var ve=new m.Path.Ellipse({center:[W+$*.5,R],size:[$,$*.65]});ve.rotate(ne-15,[W,R]),B(ve);var Ie=new m.Path.Ellipse({center:[W-$*.45,R],size:[$*.45,$*.3]});Ie.rotate(ne+15,[W,R]),B(Ie);var Be=new m.Path.Ellipse({center:[W+$*.45,R],size:[$*.45,$*.3]});Be.rotate(ne-15,[W,R]),B(Be),B(new m.Path.Ellipse({center:[W,R],size:[4,$*.6]}))}se(480,120,10,24),se(180,260,-12,20),se(620,180,8,22);function ae(W,R){[[-8,-20,-15],[0,-25,0],[8,-18,12]].forEach(function(ne){var $=new m.Path({segments:[[W+ne[0]-2,R],[W+ne[0]+ne[2]*.3,R+ne[1]*.5],[W+ne[0]+ne[2]*.5,R+ne[1]],[W+ne[0]+3,R]],closed:!0});$.smooth({type:"catmull-rom",factor:.4}),B($)})}ae(80,540),ae(200,550),ae(310,545),ae(460,550),ae(570,540),ae(680,548),ae(130,560),ae(350,555),ae(510,558),ae(620,555),ae(740,545),ae(270,560);var V=450,Y=155,Q=new m.Path.Ellipse({center:[V,Y],size:[28,18]});Q.rotate(-10),B(Q),B(new m.Path.Circle([V+16,Y-8],8)),B(new m.Path({segments:[[V+24,Y-9],[V+34,Y-8],[V+24,Y-5]],closed:!0}));var re=new m.Path.Ellipse({center:[V-3,Y-2],size:[18,10]});re.rotate(-15),B(re),B(new m.Path({segments:[[V-14,Y],[V-28,Y-12],[V-25,Y-2],[V-14,Y+4]],closed:!0})),B(new m.Path.Circle([V+18,Y-10],2))}function is(){const A=(fe-720)/2,C=(fe-720)/2,I=46,O=20,D=8,U=14,L=16,G=10,j=120/2-I;B(new m.Path.Rectangle([0,0],[fe,fe]));for(let k=0;k<7;k++)for(let ue=0;ue<7;ue++){const se=A+ue*120,ae=C+k*120;B(new m.Path.Star([se,ae],8,O,I)),B(new m.Path.Circle([se,ae],D))}for(let k=0;k<7;k++)for(let ue=0;ue<6;ue++){const se=A+ue*120+60,ae=C+k*120;B(new m.Path({segments:[[se-j,ae],[se,ae-L],[se+j,ae],[se,ae+L]],closed:!0}))}for(let k=0;k<6;k++)for(let ue=0;ue<7;ue++){const se=A+ue*120,ae=C+k*120+120/2;B(new m.Path({segments:[[se,ae-j],[se-L,ae],[se,ae+j],[se+L,ae]],closed:!0}))}for(let k=0;k<6;k++)for(let ue=0;ue<6;ue++){const se=A+ue*120+60,ae=C+k*120+120/2;B(new m.Path.RegularPolygon([se,ae],4,U)),B(new m.Path.Circle([se,ae],5))}const ie=120/2;for(let k=A;k<=A+720;k+=ie)B(new m.Path.RegularPolygon([k,C/2],4,G)),B(new m.Path.RegularPolygon([k,fe-C/2],4,G));for(let k=C;k<=C+720;k+=ie)B(new m.Path.RegularPolygon([A/2,k],4,G)),B(new m.Path.RegularPolygon([fe-A/2,k],4,G));for(const k of[[A/2,C/2],[fe-A/2,C/2],[A/2,fe-C/2],[fe-A/2,fe-C/2]])B(new m.Path.RegularPolygon(k,4,G))}function rs(){B(new m.Path.Rectangle([0,0],[fe,fe]));const b=20,T=fe-b*2,M=7,A=6,C=(T-(M-1)*A)/M;function I(k,ue,se,ae,V,Y){const Q=se/V,re=ae/Y;for(let W=0;W<Y;W++)for(let R=0;R<V;R++)B(new m.Path.Rectangle([k+R*Q,ue+W*re],[Q,re]))}function O(k,ue,se,ae){const Y=se/4,Q=ae;for(let re=0;re<4;re++){const W=k+re*Y;B(new m.Path({segments:[[W,ue+Q],[W+Y/2,ue],[W+Y,ue+Q]],closed:!0})),re<3&&B(new m.Path({segments:[[W+Y/2,ue],[W+Y,ue+Q],[W+Y*1.5,ue]],closed:!0}))}}function D(k,ue,se,ae,V,Y){const Q=se/V,re=ae/Y;for(let W=0;W<Y;W++)for(let R=0;R<V;R++){const ne=k+R*Q+Q/2,$=ue+W*re+re/2,he=Q*.45,ve=re*.45;B(new m.Path({segments:[[ne,$-ve],[ne+he,$],[ne,$+ve],[ne-he,$]],closed:!0}))}}function U(k,ue,se,ae,V){const Y=se/V;for(let Q=0;Q<V;Q++)B(new m.Path.Rectangle([k+Q*Y,ue],[Y,ae]))}function L(k,ue,se,ae){const V=k+se/2,Y=ue+ae/2;for(let Q=0;Q<3;Q++){const re=Q*Math.min(se,ae)*.12,W=se-re*2,R=ae-re*2;W>4&&R>4&&B(new m.Path.Rectangle([V-W/2,Y-R/2],[W,R]))}}function G(k,ue,se,ae){const Y=ae/3;for(let Q=0;Q<3;Q++){const re=ue+Q*Y;B(new m.Path({segments:[[k,re+Y],[k,re],[k+se/2,re+Y*.5]],closed:!0})),B(new m.Path({segments:[[k+se,re+Y],[k+se,re],[k+se/2,re+Y*.5]],closed:!0}))}}function j(k,ue,se,ae,V){const Y=se/V,Q=ae/V;for(let re=0;re<V;re++)for(let W=0;W<V;W++){const R=k+W*Y,ne=ue+re*Q;(re+W)%2===0?B(new m.Path.Rectangle([R,ne],[Y,Q])):B(new m.Path({segments:[[R+Y/2,ne],[R+Y,ne+Q/2],[R+Y/2,ne+Q],[R,ne+Q/2]],closed:!0}))}}const ie=[[I,5,3],[O],[D,4,2],[U,8],[G],[j,4],[L]];for(let k=0;k<M;k++){const ue=b+k*(C+A);if(k>0){const V=ue-A;for(let Y=0;Y<16;Y++)B(new m.Path.Rectangle([b+Y*(T/16),V],[T/16,A]))}const se=4+k%3,ae=T/se;for(let V=0;V<se;V++){const Y=b+V*ae;B(new m.Path.Rectangle([Y,ue],[ae,C]));const Q=(k*3+V)%ie.length,[re,...W]=ie[Q],R=3;re===I?I(Y+R,ue+R,ae-R*2,C-R*2,W[0]||4,W[1]||3):re===O?O(Y+R,ue+R,ae-R*2,C-R*2):re===D?D(Y+R,ue+R,ae-R*2,C-R*2,W[0]||3,W[1]||2):re===U?U(Y+R,ue+R,ae-R*2,C-R*2,W[0]||6):re===G?G(Y+R,ue+R,ae-R*2,C-R*2):re===j?j(Y+R,ue+R,ae-R*2,C-R*2,W[0]||4):re===L&&L(Y+R,ue+R,ae-R*2,C-R*2)}}for(let k=0;k<4;k++){const ue=k*5,se=new m.Path.Rectangle([b-15+ue,b-15+ue],[T+30-ue*2,T+30-ue*2]);se.strokeColor=SK,se.strokeWidth=SW,k===0&&(se.fillColor="white",se.data.fillable=!0)}}function ss(){B(new m.Path.Rectangle([0,0],[fe,fe]));const b=15,T=3,M=(fe-b*2)/T,A=M,C=4;for(let ae=0;ae<T;ae++)for(let V=0;V<T;V++){const Y=b+V*M,Q=b+ae*A;B(new m.Path.Rectangle([Y,Q],[M,A]))}function I(ae,V,Y,Q){const re=Y/4;for(let W=0;W<4;W++)for(let R=0;R<4;R++){const ne=ae+R*re+re/2,$=V+W*re+re/2,he=re*.42;for(let ve=0;ve<6;ve++){const Ie=ve*60*Math.PI/180,Be=(ve+1)*60*Math.PI/180;B(new m.Path({segments:[[ne,$],[ne+he*Math.cos(Ie),$+he*Math.sin(Ie)],[ne+he*Math.cos(Be),$+he*Math.sin(Be)]],closed:!0}))}}}function O(ae,V,Y,Q){const R=Y/16,ne=Q/10;for(let $=0;$<11;$++)for(let he=0;he<=8;he++){const ve=ae+he*R*2-R+($%2?R:0),Ie=V+$*ne;if(!(ve<ae-R*.5||ve>ae+Y+R*.5))for(let Be=2;Be>=0;Be--){const Me=R*(.25+Be*.2),Ce=new m.Path.Arc(new m.Point(ve-Me,Ie),new m.Point(ve,Ie-Me),new m.Point(ve+Me,Ie));Ce.lineTo(new m.Point(ve-Me,Ie)),Ce.closed=!0,B(Ce)}}}function D(ae,V,Y,Q){const W=Y/5;for(let R=0;R<5;R++)for(let ne=0;ne<5;ne++){const $=ae+ne*W+W/2,he=V+R*W+W/2;if(ne<4&&R<4){const ve=$+W/2,Ie=he+W/2,Be=new m.Path.Ellipse({center:[ve,Ie],size:[W*.5,W*.8]});B(Be);const Me=new m.Path.Ellipse({center:[ve,Ie],size:[W*.8,W*.5]});B(Me)}B(new m.Path.Circle([$,he],W*.15))}}function U(ae,V,Y,Q){const W=Q/6;for(let R=0;R<6;R++){const ne=V+R*W,$=4,he=Y/$;for(let ve=0;ve<$;ve++){const Ie=ae+ve*he;(R+ve)%2===0?(B(new m.Path({segments:[[Ie,ne],[Ie+he,ne+W/2],[Ie,ne+W]],closed:!0})),B(new m.Path({segments:[[Ie+he,ne],[Ie+he,ne+W],[Ie,ne+W/2]],closed:!0}))):(B(new m.Path({segments:[[Ie+he,ne],[Ie,ne+W/2],[Ie+he,ne+W]],closed:!0})),B(new m.Path({segments:[[Ie,ne],[Ie,ne+W],[Ie+he,ne+W/2]],closed:!0})))}}}function L(ae,V,Y,Q){const re=ae+Y/2,W=V+Q/2;B(new m.Path.Circle([re,W],Y*.06));for(let he=0;he<5;he++){const ve=Y*.06+he*Y*.075,Ie=ve+Y*.07;for(let Be=0;Be<12;Be++){const Me=Be*30*Math.PI/180,Ce=(Be+1)*30*Math.PI/180,Ze=(Be+.5)*30*Math.PI/180;B(new m.Path({segments:[[re+ve*Math.cos(Me),W+ve*Math.sin(Me)],[re+Ie*Math.cos(Ze),W+Ie*Math.sin(Ze)],[re+ve*Math.cos(Ce),W+ve*Math.sin(Ce)]],closed:!0}))}}const R=Y*.13;[[ae+R,V+R],[ae+Y-R,V+R],[ae+R,V+Q-R],[ae+Y-R,V+Q-R]].forEach(function(he){for(let ve=0;ve<6;ve++){const Ie=ve*60*Math.PI/180,Be=(ve+1)*60*Math.PI/180,Me=Y*.07;B(new m.Path({segments:[[he[0],he[1]],[he[0]+Me*Math.cos(Ie),he[1]+Me*Math.sin(Ie)],[he[0]+Me*Math.cos(Be),he[1]+Me*Math.sin(Be)]],closed:!0}))}B(new m.Path.Circle(he,Y*.025))}),[[re,V+R],[re,V+Q-R],[ae+R,W],[ae+Y-R,W]].forEach(function(he){const ve=Y*.055;B(new m.Path({segments:[[he[0],he[1]-ve],[he[0]+ve,he[1]],[he[0],he[1]+ve],[he[0]-ve,he[1]]],closed:!0}))})}function G(ae,V,Y,Q){const W=Y/8;for(let R=0;R<8;R++){const ne=ae+R*W+W/2,$=V+Q,he=R%2===0?1:-1,ve=new m.Path.Ellipse({center:[ne+he*4,V+Q*.5],size:[4,Q*.85]});ve.rotate(he*6,[ne,$]),B(ve);const Ie=3+R%2;for(let Be=0;Be<Ie;Be++){const Me=V+Q*.15+Be*(Q*.65/Ie),Ce=ne+he*(4+Be*2),Ze=Be%2===0?1:-1,we=new m.Path.Ellipse({center:[Ce+Ze*W*.22,Me],size:[W*.38,10]});we.rotate(Ze*he*25+he*8,[Ce,Me]),B(we)}B(new m.Path.Ellipse({center:[ne+he*6,V+Q*.06],size:[8,14]}))}}function j(ae,V,Y,Q){const W=Y/4;for(let R=0;R<4;R++)for(let ne=0;ne<4;ne++){const $=ae+ne*W+W/2,he=V+R*W+W/2,ve=W*.35;B(new m.Path.Rectangle([$-ve/3,he-ve/3],[ve*.66,ve*.66])),B(new m.Path.Rectangle([$-ve,he-ve/6],[ve*.6,ve/3])),B(new m.Path.Rectangle([$+ve*.4,he-ve/6],[ve*.6,ve/3])),B(new m.Path.Rectangle([$-ve/6,he-ve],[ve/3,ve*.6])),B(new m.Path.Rectangle([$-ve/6,he+ve*.4],[ve/3,ve*.6]))}}function ie(ae,V,Y,Q){const R=Y/6,ne=Q/6;for(let $=0;$<6;$++)for(let he=0;he<6;he++){const ve=ae+he*R,Ie=V+$*ne;B(new m.Path({segments:[[ve,Ie],[ve+R,Ie],[ve+R/2,Ie+ne]],closed:!0})),B(new m.Path({segments:[[ve,Ie+ne],[ve+R,Ie+ne],[ve+R/2,Ie]],closed:!0}))}}function k(ae,V,Y,Q){const R=Y/8,ne=R*Math.sqrt(3)/2;for(let $=-1;$<=5;$++)for(let he=-1;he<=5;he++){const ve=ae+he*R*1.5+R*.75,Ie=V+$*ne*2+(he%2===0?0:ne)+ne;ve>=ae+R*.5&&ve<=ae+Y-R*.5&&Ie>=V+R*.5&&Ie<=V+Q-R*.5&&(B(new m.Path.RegularPolygon([ve,Ie],6,R*.52)),B(new m.Path.RegularPolygon([ve,Ie],6,R*.3)),B(new m.Path.Circle([ve,Ie],R*.12)))}}const ue=[I,O,D,U,L,G,j,ie,k],se=C+2;for(let ae=0;ae<T;ae++)for(let V=0;V<T;V++){const Y=b+V*M+se,Q=b+ae*A+se,re=M-se*2,W=A-se*2;ue[ae*T+V](Y,Q,re,W)}}function as(){B(new m.Path.Rectangle([0,0],[fe,fe]));function b(L,G,j,ie,k){const ue=new m.Path({segments:[[L,G-ie/2],[L+j/2,G-ie*.1],[L+j*.35,G+ie*.25],[L+j*.1,G+ie*.42],[L,G+ie/2],[L-j*.1,G+ie*.42],[L-j*.35,G+ie*.25],[L-j/2,G-ie*.1]],closed:!0});return ue.smooth({type:"catmull-rom",factor:.5}),ue.rotate(k,[L,G]),B(ue)}function T(L,G,j,ie,k,ue){return b(L,G,j*ue,ie*ue,k)}function M(L,G,j,ie,k){for(let ue=0;ue<ie;ue++){const se=ue/ie*Math.PI*2;B(new m.Path.Circle([L+j*Math.cos(se),G+j*Math.sin(se)],k))}}function A(L,G,j,ie){for(let k=0;k<ie;k++)Ve(L,G,3,k*(360/ie),j*.4,j);B(new m.Path.Circle([L,G],3))}function C(L,G,j,ie,k){const ue=new m.Path.Ellipse({center:[L,G],size:[j,ie]});ue.rotate(k,[L,G]),B(ue)}[{cx:250,cy:200,w:180,h:280,angle:-20},{cx:560,cy:260,w:150,h:240,angle:25},{cx:400,cy:480,w:200,h:310,angle:10},{cx:160,cy:530,w:130,h:210,angle:-35},{cx:620,cy:560,w:140,h:220,angle:40},{cx:350,cy:150,w:100,h:170,angle:-45},{cx:680,cy:130,w:90,h:150,angle:15}].forEach(function(L){b(L.cx,L.cy,L.w,L.h,L.angle),T(L.cx,L.cy,L.w,L.h,L.angle,.75),T(L.cx,L.cy,L.w,L.h,L.angle,.5);const G=Math.min(L.w,L.h)*.1;for(let ue=0;ue<5;ue++)Ve(L.cx,L.cy,G*.4,ue*72+L.angle,G*.35,G);B(new m.Path.Circle([L.cx,L.cy],G*.35));const j=Math.floor(Math.min(L.w,L.h)*.08);M(L.cx,L.cy,Math.min(L.w,L.h)*.28,j,3);const ie=L.h*.3,k=L.angle*Math.PI/180;for(let ue=0;ue<3;ue++){const se=(ue-1)*L.w*.15,ae=L.cx+se*Math.cos(k)- -ie*Math.sin(k),V=L.cy+se*Math.sin(k)+-ie*Math.cos(k),Y=Math.min(L.w,L.h)*.06;B(new m.Path({segments:[[ae,V-Y],[ae+Y,V],[ae,V+Y],[ae-Y,V]],closed:!0}))}}),[[130,120],[450,50],[730,220],[80,380],[330,330],[700,400],[500,680],[180,700],[600,720],[730,650],[80,680],[450,770]].forEach(function(L){A(L[0],L[1],15,5)}),[[200,70,25],[500,120,-30],[650,50,40],[100,280,60],[750,350,-20],[300,620,35],[550,580,-45],[150,430,55],[680,480,-35],[400,740,20],[720,760,-25],[50,550,45]].forEach(function(L){C(L[0],L[1],30,12,L[2])}),[[300,80],[550,50],[100,180],[720,100],[50,450],[770,500],[250,770],[650,770],[380,400],[500,350],[150,330],[680,300]].forEach(function(L){B(new m.Path.Circle(L,4))}),[[45,45],[fe-45,45],[45,fe-45],[fe-45,fe-45]].forEach(function(L){for(let G=0;G<4;G++)Ve(L[0],L[1],5,G*90,7,22);B(new m.Path.Circle(L,5))})}function os(){const b=Math.PI/180,T=fe/2,M=fe/2,A=12,C=360/A;B(new m.Path.Rectangle([0,0],[fe,fe])),B(new m.Path.Circle([T,M],390));for(let O=0;O<A*2;O++)je(T,M,355,388,O*C/2,(O+1)*C/2);for(let O=0;O<A;O++)je(T,M,290,355,O*C,(O+1)*C);for(let O=0;O<A;O++){const D=O*C,U=295,L=45;Tt(T,M,U,D,10,L);const j=U+L*.8;for(let ie=-1;ie<=1;ie+=2){const k=D+ie*25;Dt(T,M,j-10,k,4,12)}B(new m.Path.Circle([T+(U+15)*Math.cos(D*b),M+(U+15)*Math.sin(D*b)],3))}for(let O=0;O<A;O++){const D=O*C+C/2,U=320;B(new m.Path.Star([T+U*Math.cos(D*b),M+U*Math.sin(D*b)],5,3,7))}for(let O=0;O<A;O++)je(T,M,220,290,O*C,(O+1)*C);for(let O=0;O<A;O++){const D=O*C+C/2,U=255,L=22,G=T+U*Math.cos(D*b),j=M+U*Math.sin(D*b);B(new m.Path.Circle([G,j],L));for(let ie=1;ie<=2;ie++){const k=j-L+2*L/3*ie,ue=Math.sqrt(Math.max(0,L*L-(k-j)*(k-j)));B(new m.Path({segments:[[G-ue,k-1.5],[G+ue,k-1.5],[G+ue,k+1.5],[G-ue,k+1.5]],closed:!0}))}O%2===0&&je(G,j,L+3,L+8,160,380)}for(let O=0;O<A;O++)je(T,M,150,220,O*C,(O+1)*C);for(let O=0;O<A;O++){const D=O*C,U=185,L=T+U*Math.cos(D*b),G=M+U*Math.sin(D*b);B(new m.Path.Rectangle([L-8,G-6],[16,12]));for(let j=-1;j<=1;j+=2){const ie=D+j*35;for(let k=0;k<3;k++){const ue=U+10+k*8,se=new m.Path.Rectangle([T+ue*Math.cos(ie*b)-3,M+ue*Math.sin(ie*b)-4,6,8]);se.rotate(D,[L,G]),B(se)}}B(new m.Path.Circle([L,G],3))}for(let O=0;O<A;O++)je(T,M,90,150,O*C,(O+1)*C);for(let O=0;O<A;O++){const D=O*C+C/2;Ve(T,M,95,D,18,50)}for(let O=0;O<A;O++){const D=O*C+C/2;for(let U=0;U<4;U++){const L=D+U*8,G=100+U*10,j=T+G*Math.cos(L*b),ie=M+G*Math.sin(L*b);B(new m.Path.Ellipse({center:[j,ie],size:[8-U,4-U*.5]}).rotate(L))}}for(let O=0;O<A;O++)je(T,M,50,90,O*C,(O+1)*C);for(let O=0;O<A;O++){const D=O*C,U=70,L=T+U*Math.cos(D*b),G=M+U*Math.sin(D*b);B(new m.Path.Circle([L,G],8)),B(new m.Path.Circle([L,G],5));const j=U-8,ie=T+j*Math.cos(D*b),k=M+j*Math.sin(D*b),ue=new m.Path.Rectangle([ie-5,k-6],[10,12]);ue.rotate(D,[T,M]),B(ue)}B(new m.Path.Circle([T,M],50)),B(new m.Path.Circle([T,M],35)),B(new m.Path.Circle([T,M],20)),B(new m.Path.Circle([T,M],8));for(let O=0;O<A*2;O++){const D=O*C/2,U=O%2===0?25:18;Tt(T,M,8,D,4,U)}for(let O=0;O<A*2;O++)je(T,M,20,35,O*C/2+1,(O+1)*C/2-1);[100,140,190,240,300,340].forEach(function(O){const D=Math.floor(O/20);for(let U=0;U<D;U++){const L=U/D*360+O*7%30,G=O+Math.sin(U*13)*10,j=2+U%3;B(new m.Path.Star([T+G*Math.cos(L*b),M+G*Math.sin(L*b)],4,j*.4,j))}})}function us(){const b=fe/2,T=fe/2,M=Math.PI/180;B(new m.Path.Rectangle([0,0],[fe,fe]));const A=12,C=360/A;for(let O=0;O<A;O++)je(b,T,360,385,O*C,(O+1)*C);for(let O=0;O<A;O++){const D=O*C*M;B(new m.Path.Circle([b+372*Math.cos(D),T+372*Math.sin(D)],6))}for(let O=0;O<A;O++)je(b,T,280,360,O*C,(O+1)*C);const I=[O=>{Dt(b,T,310,O-8,12,38),Dt(b,T,310,O+8,12,38)},O=>{Ve(b,T,305,O-10,10,42),Ve(b,T,305,O+10,10,42)},O=>{const D=O*M;for(let U=0;U<2;U++){const L=(U-.5)*15;B(new m.Path({segments:[[b+(295+L)*Math.cos(D-.05),T+(295+L)*Math.sin(D-.05)],[b+(335+L)*Math.cos(D-.05),T+(335+L)*Math.sin(D-.05)],[b+(335+L)*Math.cos(D+.05),T+(335+L)*Math.sin(D+.05)],[b+(295+L)*Math.cos(D+.05),T+(295+L)*Math.sin(D+.05)]],closed:!0}))}},O=>{Tt(b,T,300,O-9,16,45),Tt(b,T,300,O+9,16,45)},O=>{for(let D=-1;D<=1;D++)Ve(b,T,305,O+D*8,8,40)},O=>{const D=O*M;B(new m.Path({segments:[[b+300*Math.cos(D-.02),T+300*Math.sin(D-.02)],[b+340*Math.cos(D-.02),T+340*Math.sin(D-.02)],[b+340*Math.cos(D+.02),T+340*Math.sin(D+.02)],[b+300*Math.cos(D+.02),T+300*Math.sin(D+.02)]],closed:!0}));for(let U=0;U<3;U++){const L=310+U*12;B(new m.Path.Circle([b+L*Math.cos(D),T+L*Math.sin(D)],4))}},O=>{const D=O*M;B(new m.Path({segments:[[b+305*Math.cos(D-.08),T+305*Math.sin(D-.08)],[b+335*Math.cos(D-.08),T+335*Math.sin(D-.08)],[b+335*Math.cos(D-.06),T+335*Math.sin(D-.06)],[b+305*Math.cos(D-.06),T+305*Math.sin(D-.06)]],closed:!0})),B(new m.Path.Circle([b+310*Math.cos(D-.07),T+310*Math.sin(D-.07)],8)),B(new m.Path.Circle([b+330*Math.cos(D-.07),T+330*Math.sin(D-.07)],8))},O=>{Tt(b,T,295,O,20,50),B(new m.Path.Circle([b+325*Math.cos(O*M),T+325*Math.sin(O*M)],6))},O=>{const D=O*M;B(new m.Path({segments:[[b+295*Math.cos(D-.015),T+295*Math.sin(D-.015)],[b+340*Math.cos(D-.015),T+340*Math.sin(D-.015)],[b+340*Math.cos(D+.015),T+340*Math.sin(D+.015)],[b+295*Math.cos(D+.015),T+295*Math.sin(D+.015)]],closed:!0})),Dt(b,T,335,O,8,20)},O=>{for(let D=0;D<3;D++){const U=300+D*14,L=D*4;B(new m.Path.Circle([b+U*Math.cos((O+L)*M),T+U*Math.sin((O+L)*M)],5))}},O=>{const D=O*M;for(let U=0;U<2;U++){const L=310+U*20,G=[];for(let k=0;k<5;k++){const ue=D-.06+k*.03;G.push([b+L*Math.cos(ue),T+L*Math.sin(ue)])}const j=new m.Path({segments:G,closed:!1});j.smooth({type:"catmull-rom",factor:.5});const ie=new m.Path({segments:[...j.segments.map(k=>k.point)],closed:!0});j.remove(),B(ie)}},O=>{const D=O*M;for(let U=-1;U<=1;U+=2)B(new m.Path.Circle([b+(315+U*12)*Math.cos(D),T+(315+U*12)*Math.sin(D)],10))}];for(let O=0;O<A;O++){const D=O*C+C/2;I[O](D)}for(let O=0;O<A;O++)je(b,T,220,280,O*C,(O+1)*C);for(let O=0;O<4;O++){const D=O*90;Ve(b,T,230,D,18,42),B(new m.Path.Circle([b+250*Math.cos(D*M),T+250*Math.sin(D*M)],8))}for(let O=0;O<A;O++)Dt(b,T,235,O*C+C/2,10,32);for(let O=0;O<A;O++)je(b,T,150,220,O*C,(O+1)*C);for(let O=0;O<A;O++){const U=(O*C+C/2)*M;if(O%2===0)B(new m.Path.Star([b+185*Math.cos(U),T+185*Math.sin(U)],5,6,14));else{const L=b+185*Math.cos(U),G=T+185*Math.sin(U);B(new m.Path.Circle([L,G],10)),B(new m.Path.Circle([L+5,G-2],8))}}for(let O=0;O<A*2;O++){const D=O*(C/2)*M;B(new m.Path.Circle([b+165*Math.cos(D),T+165*Math.sin(D)],4))}for(let O=0;O<A;O++)je(b,T,90,150,O*C,(O+1)*C);for(let O=0;O<A;O++)Ve(b,T,95,O*C,12,48);for(let O=0;O<A;O++)je(b,T,50,90,O*C,(O+1)*C);for(let O=0;O<A;O++)Tt(b,T,55,O*C+C/2,14,30);B(new m.Path.Circle([b,T],50)),B(new m.Path.Star([b,T],8,20,40)),B(new m.Path.Circle([b,T],20)),B(new m.Path.Circle([b,T],8));for(let O=0;O<8;O++){const D=O*45;Dt(b,T,25,D,4,12)}}const ls=[Xr,Jr,Yr,Kr,Qr,$r,es,ts,ns,is,rs,ss,as,os,us];var $n=null;function Nt(){return $n||($n=new(window.AudioContext||window.webkitAudioContext)),$n}function Ft(b,T,M,A,C){var I=b.createGain();I.gain.value=1,T.connect(I),I.connect(b.destination);var O=[.03,.06,.11];O.forEach(function(D){var U=b.createDelay(.2);U.delayTime.value=D;var L=b.createGain();L.gain.value=.2;var G=b.createGain();G.gain.setValueAtTime(C,M),G.gain.exponentialRampToValueAtTime(.001,M+A),T.connect(U),U.connect(L),L.connect(U),U.connect(G),G.connect(b.destination)})}const hs={Chimes:function(){var b=Nt(),T=b.currentTime,M=b.createGain();M.gain.setValueAtTime(pe.vol*.14,T),M.gain.exponentialRampToValueAtTime(.001,T+.75);var A=b.createBiquadFilter();A.type="lowpass",A.frequency.value=4e3,A.Q.value=.5,A.connect(M),Ft(b,M,T,.75,.08),[523.25,659.25,783.99,1046.5].forEach(function(C,I){var O=(Math.random()-.5)*10,D=I*.07+Math.random()*.01;[0,3,-3].forEach(function(U){var L=b.createOscillator();L.type=I<2?"sine":"triangle",L.frequency.value=C,L.detune.value=O+U,L.connect(A),L.start(T+D),L.stop(T+.75)})})},Wind:function(){var b=Nt(),T=b.currentTime,M=.5;[{freq:500,Q:.6,vol:.1},{freq:900,Q:1,vol:.05}].forEach(function(A){for(var C=b.createBuffer(1,b.sampleRate*M,b.sampleRate),I=C.getChannelData(0),O=0;O<I.length;O++){var D=.7+.3*Math.sin(O/(b.sampleRate*.05));I[O]=(Math.random()*2-1)*D}var U=b.createBufferSource();U.buffer=C;var L=b.createBiquadFilter();L.type="bandpass",L.frequency.value=A.freq,L.Q.value=A.Q;var G=b.createBiquadFilter();G.type="lowpass",G.frequency.value=2e3;var j=b.createGain();j.gain.setValueAtTime(0,T),j.gain.linearRampToValueAtTime(pe.vol*A.vol,T+.06),j.gain.setValueAtTime(pe.vol*A.vol,T+.15),j.gain.exponentialRampToValueAtTime(.001,T+M),U.connect(L),L.connect(G),G.connect(j),Ft(b,j,T,M,.05),U.start(T),U.stop(T+M)})},Birds:function(){var b=Nt(),T=b.currentTime,M=b.createGain();Ft(b,M,T,.5,.06),[0,.09,.2].forEach(function(A){var C=2e3+Math.random()*1e3,I=1200+Math.random()*600,O=A+Math.random()*.015,D=.1+Math.random()*.04;["sine","triangle"].forEach(function(U,L){var G=b.createOscillator();G.type=U,G.frequency.setValueAtTime(C*(L===1?2.01:1),T+O),G.frequency.exponentialRampToValueAtTime(I*(L===1?2.01:1),T+O+D);var j=b.createGain(),ie=L===0?pe.vol*.09:pe.vol*.03;j.gain.setValueAtTime(0,T+O),j.gain.linearRampToValueAtTime(ie,T+O+.008),j.gain.exponentialRampToValueAtTime(.001,T+O+D),G.connect(j),j.connect(M),G.start(T+O),G.stop(T+O+D)})})},Ocean:function(){var b=Nt(),T=b.currentTime,M=.7;[{freq:300,Q:.4,vol:.12},{freq:800,Q:.6,vol:.04}].forEach(function(A){for(var C=b.createBuffer(1,b.sampleRate*M,b.sampleRate),I=C.getChannelData(0),O=0;O<I.length;O++){var D=Math.sin(O/I.length*Math.PI);I[O]=(Math.random()*2-1)*D}var U=b.createBufferSource();U.buffer=C;var L=b.createBiquadFilter();L.type="lowpass",L.frequency.value=A.freq,L.Q.value=A.Q;var G=b.createBiquadFilter();G.type="highpass",G.frequency.value=60;var j=b.createGain();j.gain.setValueAtTime(0,T),j.gain.linearRampToValueAtTime(pe.vol*A.vol,T+.12),j.gain.setValueAtTime(pe.vol*A.vol,T+.25),j.gain.exponentialRampToValueAtTime(.001,T+M),U.connect(L),L.connect(G),G.connect(j),Ft(b,j,T,M,.06),U.start(T),U.stop(T+M)})},Rain:function(){var b=Nt(),T=b.currentTime,M=b.createGain();Ft(b,M,T,.6,.1);for(var A=4+Math.floor(Math.random()*2),C=0;C<A;C++){for(var I=Math.random()*.15,O=3e3+Math.random()*3e3,D=.04+Math.random()*.04,U=b.createBuffer(1,Math.ceil(b.sampleRate*D),b.sampleRate),L=U.getChannelData(0),G=0;G<L.length;G++)L[G]=(Math.random()*2-1)*Math.exp(-G/(L.length*.15));var j=b.createBufferSource();j.buffer=U;var ie=b.createBiquadFilter();ie.type="bandpass",ie.frequency.value=O,ie.Q.value=8;var k=b.createGain();k.gain.setValueAtTime(pe.vol*(.08+Math.random()*.06),T+I),k.gain.exponentialRampToValueAtTime(.001,T+I+D+.1),j.connect(ie),ie.connect(k),k.connect(M),j.start(T+I),j.stop(T+I+D+.12)}},Crystal:function(){var b=Nt(),T=b.currentTime,M=.75,A=b.createGain();A.gain.setValueAtTime(pe.vol*.12,T),A.gain.exponentialRampToValueAtTime(.001,T+M),Ft(b,A,T,M,.12);var C=1200+Math.random()*200;[1,2,3,5.04].forEach(function(I,O){var D=[1,.5,.3,.15][O];[-4,0,4].forEach(function(U){var L=b.createOscillator();L.type="sine",L.frequency.value=C*I,L.detune.value=U+(Math.random()-.5)*3;var G=b.createGain();G.gain.setValueAtTime(D*.35,T),G.gain.exponentialRampToValueAtTime(.001,T+M*(1-O*.15)),L.connect(G),G.connect(A),L.start(T),L.stop(T+M)})})},Harp:function(){var b=Nt(),T=b.currentTime,M=.5,A=b.createGain(),C=b.createBiquadFilter();C.type="lowpass",C.frequency.value=5e3,C.Q.value=.3,C.connect(A),Ft(b,A,T,M,.08);var I=392+Math.random()*20;[1,2,3,4].forEach(function(O,D){var U=[1,.45,.2,.08][D],L=(Math.random()-.5)*4,G=b.createOscillator();G.type=D===0?"triangle":"sine",G.frequency.value=I*O,G.detune.value=L;var j=b.createGain();j.gain.setValueAtTime(0,T),j.gain.linearRampToValueAtTime(pe.vol*.14*U,T+.004),j.gain.exponentialRampToValueAtTime(.001,T+M*(1-D*.12)),G.connect(j),j.connect(C),G.start(T),G.stop(T+M)})},"Zen Bowl":function(){var b=Nt(),T=b.currentTime,M=.8,A=b.createGain();A.gain.setValueAtTime(pe.vol*.13,T),A.gain.setValueAtTime(pe.vol*.13,T+.2),A.gain.exponentialRampToValueAtTime(.001,T+M),Ft(b,A,T,M,.1);var C=220+Math.random()*15;[1,2.71,4.58,6.3].forEach(function(I,O){var D=[1,.4,.25,.1][O];[-2,0,2].forEach(function(U){var L=b.createOscillator();L.type="sine",L.frequency.value=C*I,L.detune.value=U+(Math.random()-.5)*2;var G=b.createGain();G.gain.setValueAtTime(0,T),G.gain.linearRampToValueAtTime(D*.35,T+.012),G.gain.exponentialRampToValueAtTime(.001,T+M*(1-O*.1)),L.connect(G),G.connect(A),L.start(T),L.stop(T+M)})})}};function $t(){try{hs[qi[pe.snd]]()}catch{}}var ei={exports:{}},Oi;function cs(){return Oi||(Oi=1,(function(b){var T=(function(){var M=String.fromCharCode,A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",I={};function O(U,L){if(!I[U]){I[U]={};for(var G=0;G<U.length;G++)I[U][U.charAt(G)]=G}return I[U][L]}var D={compressToBase64:function(U){if(U==null)return"";var L=D._compress(U,6,function(G){return A.charAt(G)});switch(L.length%4){default:case 0:return L;case 1:return L+"===";case 2:return L+"==";case 3:return L+"="}},decompressFromBase64:function(U){return U==null?"":U==""?null:D._decompress(U.length,32,function(L){return O(A,U.charAt(L))})},compressToUTF16:function(U){return U==null?"":D._compress(U,15,function(L){return M(L+32)})+" "},decompressFromUTF16:function(U){return U==null?"":U==""?null:D._decompress(U.length,16384,function(L){return U.charCodeAt(L)-32})},compressToUint8Array:function(U){for(var L=D.compress(U),G=new Uint8Array(L.length*2),j=0,ie=L.length;j<ie;j++){var k=L.charCodeAt(j);G[j*2]=k>>>8,G[j*2+1]=k%256}return G},decompressFromUint8Array:function(U){if(U==null)return D.decompress(U);for(var L=new Array(U.length/2),G=0,j=L.length;G<j;G++)L[G]=U[G*2]*256+U[G*2+1];var ie=[];return L.forEach(function(k){ie.push(M(k))}),D.decompress(ie.join(""))},compressToEncodedURIComponent:function(U){return U==null?"":D._compress(U,6,function(L){return C.charAt(L)})},decompressFromEncodedURIComponent:function(U){return U==null?"":U==""?null:(U=U.replace(/ /g,"+"),D._decompress(U.length,32,function(L){return O(C,U.charAt(L))}))},compress:function(U){return D._compress(U,16,function(L){return M(L)})},_compress:function(U,L,G){if(U==null)return"";var j,ie,k={},ue={},se="",ae="",V="",Y=2,Q=3,re=2,W=[],R=0,ne=0,$;for($=0;$<U.length;$+=1)if(se=U.charAt($),Object.prototype.hasOwnProperty.call(k,se)||(k[se]=Q++,ue[se]=!0),ae=V+se,Object.prototype.hasOwnProperty.call(k,ae))V=ae;else{if(Object.prototype.hasOwnProperty.call(ue,V)){if(V.charCodeAt(0)<256){for(j=0;j<re;j++)R=R<<1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++;for(ie=V.charCodeAt(0),j=0;j<8;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1}else{for(ie=1,j=0;j<re;j++)R=R<<1|ie,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=0;for(ie=V.charCodeAt(0),j=0;j<16;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1}Y--,Y==0&&(Y=Math.pow(2,re),re++),delete ue[V]}else for(ie=k[V],j=0;j<re;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1;Y--,Y==0&&(Y=Math.pow(2,re),re++),k[ae]=Q++,V=String(se)}if(V!==""){if(Object.prototype.hasOwnProperty.call(ue,V)){if(V.charCodeAt(0)<256){for(j=0;j<re;j++)R=R<<1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++;for(ie=V.charCodeAt(0),j=0;j<8;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1}else{for(ie=1,j=0;j<re;j++)R=R<<1|ie,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=0;for(ie=V.charCodeAt(0),j=0;j<16;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1}Y--,Y==0&&(Y=Math.pow(2,re),re++),delete ue[V]}else for(ie=k[V],j=0;j<re;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1;Y--,Y==0&&(Y=Math.pow(2,re),re++)}for(ie=2,j=0;j<re;j++)R=R<<1|ie&1,ne==L-1?(ne=0,W.push(G(R)),R=0):ne++,ie=ie>>1;for(;;)if(R=R<<1,ne==L-1){W.push(G(R));break}else ne++;return W.join("")},decompress:function(U){return U==null?"":U==""?null:D._decompress(U.length,32768,function(L){return U.charCodeAt(L)})},_decompress:function(U,L,G){var j=[],ie=4,k=4,ue=3,se="",ae=[],V,Y,Q,re,W,R,ne,$={val:G(0),position:L,index:1};for(V=0;V<3;V+=1)j[V]=V;for(Q=0,W=Math.pow(2,2),R=1;R!=W;)re=$.val&$.position,$.position>>=1,$.position==0&&($.position=L,$.val=G($.index++)),Q|=(re>0?1:0)*R,R<<=1;switch(Q){case 0:for(Q=0,W=Math.pow(2,8),R=1;R!=W;)re=$.val&$.position,$.position>>=1,$.position==0&&($.position=L,$.val=G($.index++)),Q|=(re>0?1:0)*R,R<<=1;ne=M(Q);break;case 1:for(Q=0,W=Math.pow(2,16),R=1;R!=W;)re=$.val&$.position,$.position>>=1,$.position==0&&($.position=L,$.val=G($.index++)),Q|=(re>0?1:0)*R,R<<=1;ne=M(Q);break;case 2:return""}for(j[3]=ne,Y=ne,ae.push(ne);;){if($.index>U)return"";for(Q=0,W=Math.pow(2,ue),R=1;R!=W;)re=$.val&$.position,$.position>>=1,$.position==0&&($.position=L,$.val=G($.index++)),Q|=(re>0?1:0)*R,R<<=1;switch(ne=Q){case 0:for(Q=0,W=Math.pow(2,8),R=1;R!=W;)re=$.val&$.position,$.position>>=1,$.position==0&&($.position=L,$.val=G($.index++)),Q|=(re>0?1:0)*R,R<<=1;j[k++]=M(Q),ne=k-1,ie--;break;case 1:for(Q=0,W=Math.pow(2,16),R=1;R!=W;)re=$.val&$.position,$.position>>=1,$.position==0&&($.position=L,$.val=G($.index++)),Q|=(re>0?1:0)*R,R<<=1;j[k++]=M(Q),ne=k-1,ie--;break;case 2:return ae.join("")}if(ie==0&&(ie=Math.pow(2,ue),ue++),j[ne])se=j[ne];else if(ne===k)se=Y+Y.charAt(0);else return null;ae.push(se),j[k++]=Y+se.charAt(0),ie--,Y=se,ie==0&&(ie=Math.pow(2,ue),ue++)}}};return D})();b!=null?b.exports=T:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return T})})(ei)),ei.exports}var fs=cs();const ji=Di(fs);var Zi="stillness-gallery",zi=12;function An(){try{return JSON.parse(localStorage.getItem(Zi))||[]}catch{return[]}}function Gi(b){localStorage.setItem(Zi,JSON.stringify(b))}function ds(b){var T=document.createElement("canvas");T.width=150,T.height=150;var M=T.getContext("2d"),A=m.view.zoom,C=m.view.center.clone(),I=m.view.viewSize.clone();m.view.viewSize=new m.Size(fe,fe),m.view.zoom=1,m.view.center=new m.Point(fe/2,fe/2),m.view.update(),M.fillStyle="white",M.fillRect(0,0,150,150),M.drawImage(b,0,0,150,150),m.view.viewSize=I,m.view.zoom=A,m.view.center=C,m.view.update();var O=An(),D={id:Date.now().toString(36)+Math.random().toString(36).slice(2,6),thumbnail:T.toDataURL("image/png"),projectJSON:m.project.exportJSON(),patternIndex:pe.pat,date:new Date().toISOString()};O.push(D),O.length>zi&&(O=O.slice(O.length-zi)),Gi(O),Je("Saved to gallery!")}function gs(b){var T=An(),M=T.find(function(A){return A.id===b});if(!M){Je("Gallery item not found");return}try{m.project.clear(),m.project.importJSON(M.projectJSON),Ge.patLayer=m.project.layers[0]||m.project.activeLayer,Ge.brushLayer=m.project.layers[1]||new m.Layer,Ge.patLayer.activate(),pe.pat=M.patternIndex||0,document.querySelectorAll(".pbtn").forEach(function(A,C){A.classList.toggle("active",C===pe.pat)}),nn(),Je("Loaded from gallery!")}catch{Je("Load failed")}}function _s(b){var T=An().filter(function(M){return M.id!==b});Gi(T)}function vs(b){document.getElementById("x-png").onclick=function(){var T=document.createElement("canvas");T.width=fe,T.height=fe;var M=T.getContext("2d");M.fillStyle="white",M.fillRect(0,0,fe,fe);var A=m.view.zoom,C=m.view.center.clone(),I=m.view.viewSize.clone();m.view.viewSize=new m.Size(fe,fe),m.view.zoom=1,m.view.center=new m.Point(fe/2,fe/2),m.view.update(),M.drawImage(b,0,0,fe,fe),m.view.viewSize=I,m.view.zoom=A,m.view.center=C,m.view.update();var O=document.createElement("a");O.download="stillness-coloring.png",O.href=T.toDataURL("image/png"),O.click(),Je("PNG saved!")},document.getElementById("x-svg").onclick=function(){var T=m.project.exportSVG({asString:!0}),M=new Blob([T],{type:"image/svg+xml"}),A=document.createElement("a");A.download="stillness-coloring.svg",A.href=URL.createObjectURL(M),A.click(),Je("SVG saved!")},document.getElementById("x-save").onclick=function(){try{var T=m.project.exportJSON();localStorage.setItem("stillness-save",T),localStorage.setItem("stillness-pat",pe.pat),Je("Progress saved!")}catch{Je("Save failed")}},document.getElementById("x-load").onclick=function(){try{var T=localStorage.getItem("stillness-save");if(!T){Je("No saved progress");return}m.project.clear(),m.project.importJSON(T),Ge.patLayer=m.project.layers[0]||m.project.activeLayer,Ge.brushLayer=m.project.layers[1]||new m.Layer,Ge.patLayer.activate(),pe.pat=+(localStorage.getItem("stillness-pat")||0),document.querySelectorAll(".pbtn").forEach(function(M,A){M.classList.toggle("active",A===pe.pat)}),nn(),Je("Progress loaded!")}catch{Je("Load failed")}},document.getElementById("save-gallery").onclick=function(){ds(b),ii()}}function ps(b){return new Promise(function(T){var M=document.createElement("canvas");M.width=fe,M.height=fe;var A=M.getContext("2d");A.fillStyle="white",A.fillRect(0,0,fe,fe);var C=m.view.zoom,I=m.view.center.clone(),O=m.view.viewSize.clone();m.view.viewSize=new m.Size(fe,fe),m.view.zoom=1,m.view.center=new m.Point(fe/2,fe/2),m.view.update(),A.drawImage(b,0,0,fe,fe),m.view.viewSize=O,m.view.zoom=C,m.view.center=I,m.view.update(),M.toBlob(function(D){T(D)},"image/png")})}function ms(b){ps(b).then(function(T){var M=new File([T],"stillness-coloring.png",{type:"image/png"});navigator.share&&navigator.canShare&&navigator.canShare({files:[M]})?navigator.share({files:[M],title:"My Stillness Coloring"}).then(function(){Je("Shared!")}).catch(function(){Je("Share cancelled")}):navigator.clipboard&&typeof ClipboardItem<"u"?navigator.clipboard.write([new ClipboardItem({"image/png":T})]).then(function(){Je("Image copied to clipboard!")}).catch(function(){Ri(T)}):Ri(T)})}function Ri(b){var T=document.createElement("a");T.download="stillness-coloring.png",T.href=URL.createObjectURL(b),T.click(),Je("PNG saved!")}function ws(){try{var b=m.project.exportJSON(),T=ji.compressToEncodedURIComponent(b),M=window.location.origin+window.location.pathname+"#art="+T;if(M.length>8e3){Je("Artwork too complex for URL sharing, try image instead");return}navigator.clipboard.writeText(M).then(function(){Je("Link copied to clipboard!")}).catch(function(){Je("Could not copy link")})}catch{Je("Share failed")}}var Bi=null;function Je(b){var T=document.getElementById("toast");T.textContent=b,T.classList.add("show"),clearTimeout(Bi),Bi=setTimeout(function(){T.classList.remove("show")},1500)}function hn(){var b=pe.color.toCSS?pe.color.toCSS(!0):"#e07a5f";document.querySelectorAll(".cs").forEach(function(T){T.classList.toggle("active",T.dataset.c===b)}),document.getElementById("gc1").style.background=pe.gc1.toCSS(!0),document.getElementById("gc2").style.background=pe.gc2.toCSS(!0)}function en(b){pe.tool=b,document.querySelectorAll("[data-tool]").forEach(function(M){M.classList.toggle("active",M.dataset.tool===b)}),document.getElementById("brush-cfg").style.display=b==="brush"?"block":"none",document.getElementById("grad-cfg").style.display=b==="gradient"?"block":"none";var T=document.getElementById("canvas");T.style.cursor="crosshair"}function ti(){var b=+document.getElementById("hsl-h").value,T=+document.getElementById("hsl-s").value,M=+document.getElementById("hsl-l").value;document.getElementById("hh-v").textContent=b,document.getElementById("hs-v").textContent=T,document.getElementById("hl-v").textContent=M;var A="hsl("+b+","+T+"%,"+M+"%)";document.getElementById("hsl-preview").style.background=A,pe.color=new m.Color(A),pe.gcSel===1?pe.gc1=pe.color.clone():pe.gc2=pe.color.clone(),hn()}function Tn(b){m.project.clear(),Ge.patLayer=m.project.activeLayer,Ge.brushLayer=new m.Layer,Ge.patLayer.activate(),ls[b](),pe.pat=b,Vt.length=0,tn.length=0,cn(),nn(),document.querySelectorAll(".pbtn").forEach(function(T,M){T.classList.toggle("active",M===b)})}function Ni(){var b=document.getElementById("col-grid");b.innerHTML="",Lt.forEach(function(T){var M=document.createElement("div");M.className="cs",M.dataset.c=T,M.style.background=T,M.setAttribute("tabindex","0"),M.setAttribute("role","button"),M.setAttribute("aria-label","Color "+T);var A=function(){pe.color=new m.Color(T),pe.gcSel===1?pe.gc1=pe.color.clone():pe.gc2=pe.color.clone(),hn()};M.onclick=A,M.onkeydown=function(C){(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),A())},b.appendChild(M)})}function ys(){var b=document.getElementById("hamburger-btn"),T=document.getElementById("sidebar"),M=document.getElementById("sidebar-overlay");function A(){var D=T.classList.toggle("open");M.classList.toggle("show",D)}b.addEventListener("click",A),M.addEventListener("click",A);var C=document.getElementById("theme-grid");Object.keys(ni).forEach(function(D){var U=document.createElement("button");U.className="sbtn"+(D===pe.theme?" active":""),U.textContent=D,U.onclick=function(){pe.theme=D,Hr(ni[D]),pe.color=new m.Color(Lt[0]),pe.gc1=pe.color.clone(),pe.gc2=new m.Color(Lt[1]||Lt[0]),Ni(),hn(),C.querySelectorAll(".sbtn").forEach(function(L){L.classList.toggle("active",L.textContent===D)}),Je("Theme: "+D)},C.appendChild(U)}),Ni(),["hsl-h","hsl-s","hsl-l"].forEach(function(D){document.getElementById(D).addEventListener("input",ti)}),document.getElementById("hsl-preview").onclick=function(){ti(),Je("Custom color applied")},document.querySelectorAll("[data-tool]").forEach(function(D){D.onclick=function(){en(D.dataset.tool)}}),document.getElementById("b-size").oninput=function(){pe.brushSz=+this.value,document.getElementById("bs-v").textContent=this.value},document.getElementById("b-opa").oninput=function(){pe.brushOp=this.value/100,document.getElementById("bo-v").textContent=this.value},document.querySelectorAll("[data-gt]").forEach(function(D){D.onclick=function(){pe.gradType=D.dataset.gt,document.querySelectorAll("[data-gt]").forEach(function(U){U.classList.toggle("active",U.dataset.gt===pe.gradType)})}}),document.getElementById("gc1").onclick=function(){pe.gcSel=1,document.getElementById("gc1").classList.add("active"),document.getElementById("gc2").classList.remove("active")},document.getElementById("gc2").onclick=function(){pe.gcSel=2,document.getElementById("gc2").classList.add("active"),document.getElementById("gc1").classList.remove("active")};var I=document.getElementById("pat-grid");jr.forEach(function(D,U){var L=document.createElement("button");L.className="pbtn"+(U===0?" active":""),L.textContent=D,L.onclick=function(){Tn(U)},I.appendChild(L)});var O=document.getElementById("snd-grid");qi.forEach(function(D,U){var L=document.createElement("button");L.className="sbtn"+(U===0?" active":""),L.textContent=D,L.onclick=function(){pe.snd=U,document.querySelectorAll(".sbtn").forEach(function(G,j){G.parentElement===O&&G.classList.toggle("active",j===U)}),$t()},O.appendChild(L)}),document.getElementById("vol").oninput=function(){pe.vol=this.value/100,document.getElementById("vol-v").textContent=this.value},ti(),hn(),ii()}function ii(){var b=document.getElementById("gallery-grid");b.innerHTML="",An().forEach(function(T){var M=document.createElement("div");M.className="gallery-item";var A=document.createElement("img");A.className="gallery-thumb",A.src=T.thumbnail,A.title=new Date(T.date).toLocaleDateString(),A.onclick=function(){gs(T.id)};var C=document.createElement("button");C.className="gallery-del",C.textContent="",C.onclick=function(I){I.stopPropagation(),_s(T.id),ii()},M.appendChild(A),M.appendChild(C),b.appendChild(M)})}var bs=window.matchMedia("(prefers-reduced-motion: reduce)");function Cs(b){var T=b.opacity;b.opacity=.3;var M=null,A=300;function C(I){M||(M=I);var O=Math.min((I-M)/A,1);b.opacity=.3+.7*(1-(1-O)*(1-O)),O<1?requestAnimationFrame(C):b.opacity=T}requestAnimationFrame(C)}function Ss(b,T){for(var M=6+Math.floor(Math.random()*3),A=[],C=0;C<M;C++){var I=Math.PI*2*C/M+(Math.random()-.5)*.4,O=(Math.random()-.5)*20,D=T.clone();D.hue+=O;var U=new m.Path.Circle({center:b,radius:3,fillColor:D,opacity:1,insert:!1});Ge.brushLayer.addChild(U),A.push({item:U,angle:I})}var L=null,G=400,j=25;function ie(k){L||(L=k);for(var ue=Math.min((k-L)/G,1),se=0;se<A.length;se++){var ae=A[se],V=j*ue;ae.item.position=b.add(new m.Point(Math.cos(ae.angle)*V,Math.sin(ae.angle)*V)),ae.item.opacity=1-ue,ae.item.scaling=1-ue*.6}if(ue<1)requestAnimationFrame(ie);else for(var Y=0;Y<A.length;Y++)A[Y].item.remove()}requestAnimationFrame(ie)}function Ps(b){var T=new m.Tool;T.minDistance=2,T.onMouseDown=function(M){if(pe.panning){pe.panPt=M.point;return}if(pe.tool==="fill"){var A=Ge.patLayer.hitTest(M.point,{fill:!0,tolerance:0});if(A&&A.item&&A.item.data.fillable){var C=A.item.fillColor?A.item.fillColor.clone():new m.Color("white");A.item.fillColor=pe.color.clone(),ln(new Qn(A.item,C,pe.color.clone())),$t(),bs.matches||(Cs(A.item),Ss(M.point,pe.color.clone()))}}else if(pe.tool==="brush")Ge.brushLayer.activate(),pe.brushPath=new m.Path({strokeColor:pe.color.clone(),strokeWidth:pe.brushSz,strokeCap:"round",strokeJoin:"round",opacity:pe.brushOp}),pe.brushPath.add(M.point),Ge.patLayer.activate();else if(pe.tool==="gradient"){var A=Ge.patLayer.hitTest(M.point,{fill:!0,tolerance:0});A&&A.item&&A.item.data.fillable&&(pe.gradItem=A.item,pe.gradPt=M.point)}else if(pe.tool==="eraser"){var I=Ge.brushLayer.hitTest(M.point,{stroke:!0,tolerance:5});if(I&&I.item){ln(new Li(I.item,Ge.brushLayer)),I.item.remove(),$t();return}var A=Ge.patLayer.hitTest(M.point,{fill:!0,tolerance:0});if(A&&A.item&&A.item.data.fillable){var C=A.item.fillColor?A.item.fillColor.clone():new m.Color("white");A.item.fillColor=new m.Color("white"),ln(new Qn(A.item,C,new m.Color("white"))),$t()}}else if(pe.tool==="eyedropper"){var A=m.project.hitTest(M.point,{fill:!0,stroke:!0,tolerance:2});if(A&&A.item){var O=A.item.fillColor||A.item.strokeColor;O&&O.toCSS&&(pe.color=O.clone(),hn(),Je("Color picked!"))}}},T.onMouseDrag=function(M){if(pe.panning&&pe.panPt){m.view.center=m.view.center.add(pe.panPt.subtract(M.point)),pe.panPt=M.point,qt();return}pe.tool==="brush"&&pe.brushPath&&pe.brushPath.add(M.point)},T.onMouseUp=function(M){if(pe.panning){pe.panPt=null;return}if(pe.tool==="brush"&&pe.brushPath)pe.brushPath.simplify(2.5),ln(new Li(pe.brushPath,Ge.brushLayer)),pe.brushPath=null,$t();else if(pe.tool==="gradient"&&pe.gradItem){var A=pe.gradItem,C=pe.gradPt,I=M.point,O=A.fillColor?A.fillColor.clone():new m.Color("white"),D=pe.gradType==="radial";C.getDistance(I)<5&&(I=D?new m.Point(A.bounds.bottomCenter):new m.Point(A.bounds.bottomCenter),C=D?new m.Point(A.bounds.center):new m.Point(A.bounds.topCenter));var U={gradient:{stops:[pe.gc1.clone(),pe.gc2.clone()],radial:D},origin:C,destination:I};A.fillColor=U,ln(new Qn(A,O,A.fillColor.clone())),$t(),pe.gradItem=null,pe.gradPt=null}},document.addEventListener("keydown",function(M){M.code==="Space"&&!M.repeat&&(pe.panning=!0,b.style.cursor="grab",M.preventDefault()),(M.key==="f"||M.key==="F")&&en("fill"),(M.key==="b"||M.key==="B")&&en("brush"),(M.key==="g"||M.key==="G")&&en("gradient"),(M.key==="e"||M.key==="E")&&en("eraser"),(M.key==="i"||M.key==="I")&&en("eyedropper"),M.key==="0"&&nn(),(M.key==="="||M.key==="+")&&(m.view.zoom=Math.min(12,m.view.zoom*1.2),qt()),M.key==="-"&&(m.view.zoom=Math.max(.2,m.view.zoom/1.2),qt()),(M.metaKey||M.ctrlKey)&&M.shiftKey&&M.key==="z"?(M.preventDefault(),Hi()):(M.metaKey||M.ctrlKey)&&M.key==="z"&&(M.preventDefault(),Ui())}),document.addEventListener("keyup",function(M){M.code==="Space"&&(pe.panning=!1,b.style.cursor="crosshair")})}const Fi="stillness-onboarded",kn=[{html:`
      <span class="onb-hero-emoji"></span>
      <h2>Welcome to Stillness</h2>
      <p class="onb-tagline">A quiet place for your mind</p>
      <p>Unwind with beautiful patterns and colors. Fill, paint, and create  at your own pace, with no pressure.</p>
    `},{html:`
      <h2>How to Color</h2>
      <p>Pick a pattern, choose a color, and click to fill</p>
      <div class="onb-icons">
        <div class="onb-icon-item"><span class="onb-emoji"></span><span>Pick a pattern</span></div>
        <div class="onb-icon-item"><span class="onb-emoji"></span><span>Choose a color</span></div>
        <div class="onb-icon-item"><span class="onb-emoji"></span><span>Click to fill</span></div>
      </div>
    `},{html:`
      <h2>Explore &amp; Create</h2>
      <p>Try different tools, ambient sounds, and export your artwork when you're ready.</p>
      <div class="onb-icons">
        <div class="onb-icon-item"><span class="onb-emoji"></span><span>Brush &amp; gradient</span></div>
        <div class="onb-icon-item"><span class="onb-emoji"></span><span>Ambient sounds</span></div>
        <div class="onb-icon-item"><span class="onb-emoji"></span><span>Export your art</span></div>
      </div>
    `,last:!0}];function xs(){var b=document.createElement("div");b.className="onboarding-overlay";var T=kn.map(function(A,C){return'<div class="onboarding-step'+(C===0?" active":"")+'" data-step="'+C+'">'+A.html+"</div>"}).join(""),M=kn.map(function(A,C){return'<span class="onb-dot'+(C===0?" active":"")+'" data-dot="'+C+'"></span>'}).join("");return b.innerHTML='<div class="onboarding-card">'+T+'<div class="onb-nav"><button class="onb-skip">Skip</button><div class="onb-dots">'+M+'</div><button class="onb-next">Next</button></div></div>',b}function Ms(){if(localStorage.getItem(Fi))return;var b=0,T=xs();document.body.appendChild(T);var M=T.querySelectorAll(".onboarding-step"),A=T.querySelectorAll(".onb-dot"),C=T.querySelector(".onb-next"),I=T.querySelector(".onb-skip");function O(U){M.forEach(function(L){L.classList.remove("active")}),A.forEach(function(L){L.classList.remove("active")}),M[U].classList.add("active"),A[U].classList.add("active"),b=U,C.textContent=kn[U].last?"Start Coloring":"Next"}function D(){localStorage.setItem(Fi,"1"),T.classList.add("fade-out"),T.addEventListener("animationend",function(){T.remove()});var U=window.matchMedia("(prefers-reduced-motion: reduce)").matches;U&&T.remove()}C.addEventListener("click",function(){b<kn.length-1?O(b+1):D()}),I.addEventListener("click",D),T.addEventListener("click",function(U){U.target===T&&D()})}const fn=Zr();Vi();window.addEventListener("resize",Vi);pe.color=new m.Color(Lt[0]);pe.gc1=new m.Color(Lt[0]);pe.gc2=new m.Color(Lt[4]);ys();Ps(fn);Gr(fn);vs(fn);document.getElementById("undo-btn").onclick=Ui;document.getElementById("redo-btn").onclick=Hi;document.getElementById("x-share-img").onclick=function(){ms(fn)};document.getElementById("x-share-url").onclick=ws;fn.style.cursor="crosshair";cn();(function(){var b=window.location.hash;if(b&&b.indexOf("#art=")===0)try{var T=b.slice(5),M=ji.decompressFromEncodedURIComponent(T);M?(m.project.clear(),m.project.importJSON(M),Ge.patLayer=m.project.layers[0]||m.project.activeLayer,Ge.brushLayer=m.project.layers[1]||new m.Layer,Ge.patLayer.activate(),nn(),history.replaceState(null,"",window.location.pathname)):Tn(0)}catch{Tn(0)}else Tn(0)})();Ms();
